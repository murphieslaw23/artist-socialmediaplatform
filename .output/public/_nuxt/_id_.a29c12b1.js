import{i as W,a as L,j as M,H as J,l as R,r as p,a5 as K,o as u,m,p as t,q as b,t as a,e as v,w as T,b as d,v as _,J as U,E as Y,u as I,aB as G,s as E,c as j,F as Q,x as X,K as z,L as O,k as Z,a7 as tt,T as et,U as st}from"./entry.9eddce5d.js";import{u as P,_ as ot}from"./Icon.9f8b52fb.js";import{L as at}from"./Layout.00fab9ac.js";import{S as N}from"./Spinner.700b56ed.js";import{_ as q}from"./_plugin-vue_export-helper.a1a6add7.js";const D=l=>(z("data-v-2c0b2b8b"),l=l(),O(),l),lt={class:"mb-4 text-base font-bold"},it={class:"text-xs italic font-bold href"},nt={class:"alert-success"},rt={class:"italic"},ct={class:"flex flex-row p-2 mb-6 text-white rounded-md button-color"},ut=["onSubmit"],dt={class:"input-block"},pt=["placeholder"],ht={class:"input-block -mt-2"},_t={class:"input-block"},vt={class:"input-block"},mt={class:"mb-4"},ft=["for"],wt=D(()=>t("span",{class:"block w-10 h-6 bg-gray-300 rounded-full shadow-inner"},null,-1)),bt={key:0,class:"block absolute inset-y-0 left-0 mt-1 ml-1 w-4 h-4 bg-white rounded-full shadow transition-transform duration-300 ease-in-out focus-within:shadow-outline"},kt=D(()=>t("input",{id:"unchecked",type:"checkbox",class:"absolute w-0 h-0 opacity-0"},null,-1)),gt=[kt],yt={key:1,class:"block absolute inset-y-0 left-0 mt-1 ml-1 w-4 h-4 rounded-full shadow transition-transform duration-300 ease-in-out transform translate-x-full focus-within:shadow-outline button-color"},xt=D(()=>t("input",{id:"checked",type:"checkbox",class:"absolute w-0 h-0 opacity-0"},null,-1)),$t=[xt],Et={class:"ml-2"},It={class:"flex flex-row p-2 mt-2 text-white bg-red-400 rounded"},Ct={class:"flex flex-row"},Vt={__name:"UpdateForm",props:{id:{type:String,default:""}},setup(l){const f=l,C=W(),{$router:g}=L(),{oApiConfiguration:y,fetchOptions:V}=M(),x=P(y,V()),S=J().public.apiUrl;R(()=>{C.loggedIn||g.push("/"),A()});const i=p(!1),A=async()=>{const[s,o]=await x.getWorkById(f.id);o?i.value=!0:(e.value.title=s.title,e.value.description=s.description.split("<br><br>").join(` 
`).split("<br>").join(""),s.artwork_has_tags.forEach(w=>{r.value.push({key:w.artwork_tags.id,value:w.artwork_tags.tag})}),e.value.isExplicit=!!s.is_explicit)},e=p({title:"",description:"",tags:"",isExplicit:!1}),r=p([]),n=p(!1),h=p(!1),B=p(!1),H=async()=>{const s=[];r.value.forEach(o=>{s.push(o.value)}),n.value=!0,h.value=!1;try{const o=[];r.value.forEach(c=>{o.push(c.value)});const[w,F]=await x.updateInfo({id:f.id,title:e.value.title,description:e.value.description,isExplicit:e.value.isExplicit,tags:o.toString()});F?B.value=!0:(h.value=!0,setTimeout(()=>{g.push(`/a/${f.id}`)},1e3))}catch{B.value=!0}n.value=!1};return(s,o)=>{const w=X,F=K("tags-input");return u(),m("div",null,[t("div",lt,[b(a(s.$t("artworks.update.form.title"))+" ",1),t("span",it,[v(w,{to:"/a/"+l.id},{default:T(()=>[b(" (ID: "+a(l.id)+") ",1)]),_:1},8,["to"])])]),d(t("div",{class:"alert-danger"},a(s.$t("artworks.update.form.fetchFailure")),513),[[_,i.value]]),d(t("div",nt,[b(a(s.$t("artworks.update.form.updated"))+" ",1),t("span",rt,a(s.$t("artworks.update.form.successRedirect")),1)],512),[[_,h.value]]),d(t("div",ct,[v(N,{class:"mr-1"}),b(" "+a(s.$t("saving")),1)],512),[[_,n.value]]),d(t("div",{class:"alert-danger"},a(s.$t("artworks.add.form.uploadFailure")),513),[[_,B.value]]),d(t("form",{enctype:"multipart/form-data",onSubmit:Q(H,["prevent"])},[t("div",dt,[d(t("input",{"onUpdate:modelValue":o[0]||(o[0]=c=>e.value.title=c),type:"text",class:U(["form-input input",{"pointer-events-none cursor-not-allowed":n.value||h.value}]),placeholder:s.$t("title")},null,10,pt),[[Y,e.value.title]])]),t("div",ht,[v(I(G.exports.VueEditor),{modelValue:e.value.description,"onUpdate:modelValue":o[1]||(o[1]=c=>e.value.description=c),editorToolbar:[[{size:["normal","large"]}],["bold","italic","underline","strike"],["link"],[{color:[]},{background:[]}],["clean"]],class:U([{"pointer-events-none cursor-not-allowed":n.value||h.value}]),placeholder:s.$t("description")},null,8,["modelValue","class","placeholder"])]),t("div",_t,[v(F,{modelValue:r.value,"onUpdate:modelValue":o[2]||(o[2]=c=>r.value=c),placeholder:s.$t("tagsInputPlaceholder"),typeahead:!0,"typeahead-style":"dropdown","typeahead-activation-threshold":2,"typeahead-show-on-focus":!0,"typeahead-hide-discard":!0,"typeahead-url":I(S)+"/artworks/tags/search?keyword=:search","add-tags-on-comma":!0},null,8,["modelValue","placeholder","typeahead-url"])]),t("div",vt,[t("div",mt,[t("label",{for:e.value.isExplicit?"unchecked":"checked",class:"inline-flex items-center mt-2"},[t("span",{class:"relative cursor-pointer",onClick:o[3]||(o[3]=c=>e.value.isExplicit=!e.value.isExplicit)},[wt,e.value.isExplicit?E("",!0):(u(),m("span",bt,gt)),e.value.isExplicit?(u(),m("span",yt,$t)):E("",!0)]),t("span",Et,a(s.$t("explicitContent")),1)],8,ft),d(t("div",It,[v(ot,{name:"alert-outline",class:"mr-1 text-white"}),t("span",null,a(s.$t("artworks.add.form.prohibitChildExplicitContent")),1)],512),[[_,e.value.isExplicit]])])]),t("button",{class:U(["float-right primary-button",{"pointer-events-none cursor-not-allowed":n.value||h.value}])},[t("div",Ct,[n.value?(u(),j(N,{key:0,class:"mr-1"})):E("",!0),b(" "+a(n.value?s.$t("saving"):s.$t("save")),1)])],2)],40,ut),[[_,!i.value]])])}}},St=q(Vt,[["__scopeId","data-v-2c0b2b8b"]]);const k=l=>(z("data-v-983292eb"),l=l(),O(),l),At=k(()=>t("h1",{class:"mb-3 text-base font-bold"},"Current Info",-1)),Bt={class:"mt-2"},Ft=k(()=>t("label",{class:"italic font-medium text-color-secondary"},"Title",-1)),Ut={class:"mt-2"},Tt=k(()=>t("label",{class:"italic font-medium text-color-secondary"},"Explicit",-1)),Dt={key:0,class:"mt-2"},Nt=k(()=>t("label",{class:"italic font-medium text-color-secondary"},"Tags",-1)),Wt={class:"tags"},Lt={class:"mt-2"},Mt=k(()=>t("label",{class:"italic font-medium text-color-secondary"},"Publish Date",-1)),Rt={__name:"[id]",setup(l){const f=W(),{oApiConfiguration:C,fetchOptions:g}=M(),y=P(C,g()),{$router:V}=L(),x=Z(),{id:$}=V.currentRoute.value.params;tt(async()=>{await S()}),R(()=>{A()});const S=async()=>{const[e,r]=await y.getWorkById($);(e.user_id!==f.user.id||r)&&x.push({path:"/"})},i=p({}),A=async()=>{try{const[e,r]=await y.getWorkById($);r||(i.value=e)}catch{}};return(e,r)=>(u(),j(at,{"with-footer":!0,"h-screen":!0},{"right-side":T(()=>[At,t("div",Bt,[Ft,t("p",null,a(i.value.title),1)]),t("div",Ut,[Tt,t("p",null,a(i.value.is_explicit?"Yes":"No"),1)]),i.value.artwork_has_tags&&i.value.artwork_has_tags.length?(u(),m("div",Dt,[Nt,t("div",Wt,[(u(!0),m(et,null,st(i.value.artwork_has_tags,n=>(u(),m("span",{key:n.artwork_tags.id,class:"tag"},a(n.artwork_tags.tag),1))),128))])])):E("",!0),t("div",Lt,[Mt,t("p",null,a(e.formatDate(i.value.scheduled_post)),1)])]),default:T(()=>[v(I(St),{id:I($)},null,8,["id"])]),_:1}))}},Ht=q(Rt,[["__scopeId","data-v-983292eb"]]);export{Ht as default};
