import{bR as Ce,j as pe,k as fe,C as ae,I as Se,a as me,Y as ve,m as we,r as w,o as H,p as ie,q as e,t as r,b as c,v as m,u as t,K as b,e as y,s as Q,F as j,U as O,G as D,w as be,h as he,M as ye,N as $e,L as V,H as xe,T as _e,f as Ae,D as Ie,E as Ne,c as oe,x as de,y as Ue}from"./entry.e86746f3.js";import{u as ne,L as Ve}from"./Layout.04566d95.js";import{_ as Ee}from"./nuxt-img.978eb1b8.js";import{v as De}from"./vue3-editor.common.0d385de4.js";import{S as le}from"./Spinner.cfab8439.js";import{u as ge}from"./useUser.ed68435a.js";import{_ as re}from"./_plugin-vue_export-helper.a1a6add7.js";import"./user-counters-api.1e743ca3.js";var ce={exports:{}};(function(F,f){(function(A,v){v(f)})(Ce,function(A){function v(s,a){return function(p){if(Array.isArray(p))return p}(s)||function(p,g){var x=p==null?null:typeof Symbol<"u"&&p[Symbol.iterator]||p["@@iterator"];if(x!=null){var k,h,U=[],T=!0,L=!1;try{for(x=x.call(p);!(T=(k=x.next()).done)&&(U.push(k.value),!g||U.length!==g);T=!0);}catch(q){L=!0,h=q}finally{try{T||x.return==null||x.return()}finally{if(L)throw h}}return U}}(s,a)||function(p,g){if(!!p){if(typeof p=="string")return S(p,g);var x=Object.prototype.toString.call(p).slice(8,-1);if(x==="Object"&&p.constructor&&(x=p.constructor.name),x==="Map"||x==="Set")return Array.from(p);if(x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x))return S(p,g)}}(s,a)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function S(s,a){(a==null||a>s.length)&&(a=s.length);for(var p=0,g=new Array(a);p<a;p++)g[p]=s[p];return g}function C(s,a){var p,g,x,k,h=null,U=typeof a=="number"?a:(p=v(String(a).split(/(ms|s)/i),2),g=p[0],x=p[1],k=x===void 0?"ms":x,Number(g)*{ms:1,s:1e3}[k]),T=function(){for(var L=this,q=arguments.length,P=new Array(q),M=0;M<q;M++)P[M]=arguments[M];var Y=function(){h=null,s.apply(L,P)};clearTimeout(h),(h=setTimeout(Y,U))||s.apply(this,P)};return T.cancel=function(){clearTimeout(h),h=null},T}function I(s){return s.map(function(a){return a.toLowerCase()})}function E(s,a){var p,g=s?s["debounce-events"]:[];return g&&g.length>0?Array.isArray(g)?I(g):I(g.split(",")):I((p=a,Array.isArray(p)?p:p==null?[]:[p]))}function o(s){return s===""}function N(s,a){return s==="Enter"&&(!a.lock||a.unlock)}function d(s,a,p){return o(s)&&p.fireonempty&&(a==="Enter"||a===" ")}function u(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=s.lock,p=a!==void 0&&a,g=s.listenTo,x=g===void 0?"keyup":g,k=s.defaultTime,h=k===void 0?"300ms":k,U=s.fireOnEmpty,T=U!==void 0&&U,L=s.cancelOnEmpty,q=L!==void 0&&L,P=s.trim,M=P!==void 0&&P;return{bind:function(Y,W,J){var se=W.value,X=W.arg,Z=X===void 0?h:X,ee=W.modifiers,K=Object.assign({lock:p,trim:M,fireonempty:T,cancelonempty:q},ee),G=E(J.data.attrs,x),B=C(function($){se($.target.value,$)},Z);function te($){var R=K.trim?$.target.value.trim():$.target.value;o(R)&&K.cancelonempty?B.cancel():N($.key,K)||d(R,$.key,K)?(B.cancel(),se($.target.value,$)):B($)}G.forEach(function($){Y.addEventListener($,te)})}}}var l={install:function(s){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s.directive("debounce",u(a))}};A.debounce=C,A.default=l,A.vue3Debounce=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=s.lock,p=a!==void 0&&a,g=s.listenTo,x=g===void 0?"keyup":g,k=s.defaultTime,h=k===void 0?"300ms":k,U=s.fireOnEmpty,T=U!==void 0&&U,L=s.cancelOnEmpty,q=L!==void 0&&L,P=s.trim,M=P!==void 0&&P;return{created:function(Y,W,J){var se=W.value,X=W.arg,Z=X===void 0?h:X,ee=W.modifiers,K=Object.assign({lock:p,trim:M,fireonempty:T,cancelonempty:q},ee),G=E(J.props,x),B=C(function($){se($.target.value,$)},Z);function te($){var R=K.trim?$.target.value.trim():$.target.value;o(R)&&K.cancelonempty?B.cancel():N($.key,K)||d(R,$.key,K)?(B.cancel(),se($.target.value,$)):B($)}G.forEach(function($){Y.addEventListener($,te)})}}},Object.defineProperty(A,"__esModule",{value:!0})})})(ce,ce.exports);const ue=F=>(ye("data-v-e3cef36a"),F=F(),$e(),F),Pe={class:"flex flex-col w-full"},je={class:"mb-4 w-44"},Fe={class:"font-semibold"},Te={class:"mt-2"},Le=["src"],Me=["src"],Oe={class:"mt-2 w-full text-center text-failure"},Ke=ue(()=>e("br",null,null,-1)),Be=ue(()=>e("div",{class:"mb-4 custom-divider"},null,-1)),Re={class:"mb-4"},ze={class:"font-semibold"},qe={class:"mt-2"},Ye=["src"],Ge=["src"],He={class:"flex flex-row justify-end w-full"},We={class:"mt-2 w-full text-center text-failure"},Je=ue(()=>e("br",null,null,-1)),Qe=ue(()=>e("div",{class:"mb-4 custom-divider"},null,-1)),Xe={class:"input-block"},Ze={class:"font-semibold"},et={class:"field"},tt={class:"input-block"},st={class:"font-semibold"},ot={class:"field"},lt={class:"input-block"},nt={class:"font-semibold"},at={class:"mb-4 field"},it={class:"flex flex-row p-1 w-full rounded-md cursor-pointer md:w-min theme-color"},rt={class:"input-block"},ut={class:"font-semibold"},dt={class:"mb-4 field"},ct={class:"input-block"},pt={class:"font-semibold"},ft={class:"field"},mt={class:"flex flex-row justify-between w-full"},vt={class:"flex flex-row text-success"},gt=ue(()=>e("div",{class:"mb-4 custom-divider"},null,-1)),bt={class:"input-block"},wt=["name"],ht={class:"font-semibold"},_t={class:"field"},yt={__name:"Information",setup(F){const f=pe(),{oApiConfiguration:A,fetchOptions:v}=fe(),S=ge(A,v()),{t:C}=ae(),I=Se(),{$router:E}=me();ve(()=>{f.loggedIn||E.push("/")}),we(()=>{d()});const o=w({name:"",username:"",penName:"",bio:"",gender:"m",location:""}),N=w({username:"",penName:""}),d=async()=>{if(f.loggedIn){const[n,i]=await S.getInfo(f.user.id);i||(o.value.name=n.name,o.value.username=n.username,N.value.username=n.username,o.value.penName=n.pen_name,N.value.penName=n.pen_name,o.value.bio=n.bio,o.value.gender=n.gender,o.value.location=n.location)}},u=w({basic:{loading:!1,success:!1,buttonDisabled:!1,checkingValidity:!1},username:{loading:!1,success:!1,buttonDisabled:!0,checkingValidity:!1}}),l=w(!1),s=async()=>{o.value.penName===""&&(l.value=!1,u.value.basic.buttonDisabled=!0,u.value.basic.checkingValidity=!1),o.value.penName.length>=4&&o.value.penName.length<=12?(u.value.basic.buttonDisabled=!0,u.value.basic.checkingValidity=!0,await ce.exports.debounce(async n=>{if(o.value.penName===N.value.penName)l.value=!1,u.value.basic.buttonDisabled=!1,u.value.basic.checkingValidity=!1;else{const[i,z]=await S.checkPenNameAvailability(o.value.penName);!i&&z&&f.user.pen_name!==o.value.penName?(l.value=!0,u.value.basic.buttonDisabled=!0,u.value.basic.checkingValidity=!1):(l.value=!1,u.value.basic.buttonDisabled=!1,u.value.basic.checkingValidity=!1)}},700)()):l.value=!1},a="basic-information-form",p=async()=>{if(ne().validate(basicInformationformId,C),!l.value){u.value.basic.loading=!0;const[n,i]=await S.updateInfo({userId:f.user.id,name:o.value.name,gender:o.value.gender,bio:o.value.bio,location:o.value.location,penName:o.value.penName});!n&&i?u.value.basic.loading=!1:u.value.basic.success=!0,u.value.basic.loading=!1}},g=w(!1),x=async()=>{o.value.username===""&&(g.value=!1,u.value.username.buttonDisabled=!0,u.value.username.checkingValidity=!1),o.value.username.length>=4&&o.value.username.length<=12?(u.value.username.buttonDisabled=!0,u.value.username.checkingValidity=!0,await ce.exports.debounce(async n=>{if(o.value.username===N.value.username)g.value=!1,u.value.username.buttonDisabled=!1,u.value.username.checkingValidity=!1;else{const[i,z]=await S.checkUsernameAvailability(o.value.username);!i&&z?(g.value=!0,u.value.username.buttonDisabled=!0,u.value.username.checkingValidity=!1):(g.value=!1,u.value.username.buttonDisabled=!1,u.value.username.checkingValidity=!1)}},500)()):g.value=!1},k="change-username-form",h=async()=>{if(ne().validate(changeUsernameformId,C),!g.value){u.value.username.loading=!0;const[n,i]=await S.changeUsername(o.value.username);!n&&i?u.value.username.loading=!1:u.value.username.success=!0,u.value.username.loading=!1}},U=()=>{document.getElementById("inputAvatarFile").click()},T=w(""),L=w(""),q=n=>{const i=n.target.files[0];L.value=URL.createObjectURL(i),T.value=i},P=w(!1),M=w(!1),Y=w(!1),W=w(null),J=w(""),se=async()=>{if(T.value){M.value=!1,P.value=!0,Y.value=!1,J.value="";const n=T.value,i=new FormData;i.append("avatar",n);try{const z=await he.post(I.public.apiUrl+"/user/update/avatar",i,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${f.a4ht0jen}`}});M.value=!0}catch(z){const _=z.response;_.data.error==="File too large"?Y.value=!0:J.value=_.data.message}P.value=!1}},X=()=>{document.getElementById("inputCoverFile").click()},Z=w(""),ee=w(""),K=n=>{const i=n.target.files[0];ee.value=URL.createObjectURL(i),Z.value=i},G=w(!1),B=w(!1),te=w(!1),$=w(null),R=w(""),ke=async()=>{if(Z.value){B.value=!1,G.value=!0,te.value=!1,R.value="";const n=Z.value,i=new FormData;i.append("cover",n);try{const z=await he.post(I.public.apiUrl+"/user/update/cover",i,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${f.a4ht0jen}`}});B.value=!0}catch(z){const _=z.response;_.data.error==="File too large"?te.value=!0:R.value=_.data.message}G.value=!1}};return(n,i)=>{const z=Ee;return H(),ie("div",Pe,[e("div",je,[e("label",Fe,r(n.$t("profile.forms.update.avatar")),1),e("div",Te,[c(e("img",{src:n.avatarCoverUrl(t(f).user.avatar_bucket,t(f).user.avatar_filename),class:"avatar",onError:i[0]||(i[0]=(..._)=>n.imageLoadError&&n.imageLoadError(..._))},null,40,Le),[[m,!t(L)]]),c(e("img",{src:t(L),class:b(["avatar",t(Y)||t(J)?"border-2 border-red-400":"border-none"])},null,10,Me),[[m,t(L)]]),e("input",{id:"inputAvatarFile",ref_key:"selectedNewAvatarRef",ref:W,type:"file",accept:"image/png, image/gif, image/jpeg",class:"hidden",onChange:q},null,544),e("button",{id:"selectNewAvatarButton",class:"mt-2 w-full primary-button",onClick:i[1]||(i[1]=_=>U())},r(n.$t("profile.forms.update.chooseNewAvatar")),1),e("button",{class:b(["flex flex-row mt-2 w-full",[t(T)?"primary-button cursor-pointer":"disabled-button cursor-not-allowed",t(P)?"disabled-button cursor-not-allowed":"primary-button cursor-pointer"]]),onClick:i[2]||(i[2]=_=>U&&!t(P)?se():null)},[c(y(le,{class:"mr-2"},null,512),[[m,t(P)]]),Q(" "+r(t(P)?n.$t("updating"):n.$t("update")),1)],2),c(e("div",Oe,[Q(r(n.$t("profile.forms.update.fileTooLarge"))+" ",1),Ke,Q(" "+r(n.$t("profile.forms.update.avatarMaxAllowedFileSize")),1)],512),[[m,t(Y)]]),c(e("div",{class:"mt-2 w-full text-center text-failure"},r(t(J)),513),[[m,t(J)!=""]]),c(e("div",{class:"mt-2 w-full text-center text-success"},r(n.$t("updated")),513),[[m,t(M)]])])]),Be,e("div",Re,[e("label",ze,r(n.$t("profile.forms.update.cover")),1),e("div",qe,[c(e("img",{src:n.avatarCoverUrl(t(f).user.cover_bucket,t(f).user.cover_filename),class:"object-cover object-top w-full h-28 rounded-md md:h-48 lg:h-64 xl:h-72 unselectable",onError:i[3]||(i[3]=(..._)=>n.defaultCoverImage&&n.defaultCoverImage(..._))},null,40,Ye),[[m,!t(ee)]]),c(e("img",{src:t(ee),class:b(["object-cover object-top w-full h-28 rounded-md md:h-48 lg:h-64 xl:h-72 unselectable",t(te)||t(R)?"border-2 border-red-400":"border-none"])},null,10,Ge),[[m,t(ee)]]),e("input",{id:"inputCoverFile",ref_key:"selectedNewCoverRef",ref:$,type:"file",accept:"image/png, image/gif, image/jpeg",class:"hidden",onChange:K},null,544),e("button",{id:"selectNewCoverButton",class:"mt-2 w-full primary-button",onClick:i[4]||(i[4]=_=>X())},r(n.$t("profile.forms.update.chooseNewCover")),1),e("div",He,[e("button",{class:b(["flex flex-row mt-2 w-full md:w-auto",[t(Z)?"primary-button cursor-pointer":"disabled-button cursor-not-allowed",t(G)?"disabled-button cursor-not-allowed":"primary-button cursor-pointer"]]),onClick:i[5]||(i[5]=_=>X&&!t(G)?ke():null)},[c(y(le,{class:"mr-2"},null,512),[[m,t(G)]]),Q(" "+r(t(G)?n.$t("updating"):n.$t("update")),1)],2)]),c(e("div",We,[Q(r(n.$t("profile.forms.update.fileTooLarge"))+" ",1),Je,Q(" "+r(n.$t("profile.forms.update.coverMaxAllowedFileSize")),1)],512),[[m,t(te)]]),c(e("div",{class:"mt-2 w-full text-center text-failure"},r(t(R)),513),[[m,t(R)!=""]]),c(e("div",{class:"mt-2 w-full text-center text-success"},r(n.$t("updated")),513),[[m,t(B)]])])]),Qe,e("form",{id:a,class:"mb-4",onSubmit:i[14]||(i[14]=D(_=>p(),["prevent"]))},[e("div",Xe,[e("n-validate",null,[e("label",Ze,r(n.$t("profile.forms.update.name")),1),e("div",et,[c(e("input",{"onUpdate:modelValue":i[6]||(i[6]=_=>t(o).name=_),type:"text",class:b(["form-input input",[{"pointer-events-none cursor-not-allowed":t(u).basic.loading}]])},null,2),[[j,t(o).name]])])])]),e("div",tt,[e("n-validate",null,[e("label",st,r(n.$t("profile.forms.update.penName")),1),e("div",ot,[c(e("input",{"onUpdate:modelValue":i[7]||(i[7]=_=>t(o).penName=_),type:"text",maxlength:"12",class:b(["form-input input",{"pointer-events-none cursor-not-allowed":t(u).username.loading}]),onInput:i[8]||(i[8]=_=>s()),onKeydown:i[9]||(i[9]=O(D(()=>{},["prevent"]),["space"]))},null,34),[[j,t(o).penName]]),c(e("div",{class:"input-error"},r(n.$t("profile.forms.update.penNameTaken")),513),[[m,t(l)]])])])]),e("div",lt,[e("label",nt,r(n.$t("profile.forms.update.gender")),1),e("div",at,[e("div",it,[e("div",{class:b(["flex flex-row justify-center py-2 px-3 w-full rounded-md parent-icon",{"button-color text-white":t(o).gender==="m"}]),onClick:i[10]||(i[10]=_=>t(o).gender="m")},r(n.$t("male")),3),e("div",{class:b(["flex flex-row justify-center py-2 px-3 w-full rounded-md parent-icon",{"button-color text-white":t(o).gender==="f"}]),onClick:i[11]||(i[11]=_=>t(o).gender="f")},r(n.$t("female")),3)])])]),e("div",rt,[e("n-validate",null,[e("label",ut,r(n.$t("profile.forms.update.bio")),1),e("div",dt,[y(z,null,{default:be(()=>[y(t(De.exports.VueEditor),{modelValue:t(o).bio,"onUpdate:modelValue":i[12]||(i[12]=_=>t(o).bio=_),editorToolbar:[[{size:["normal","large"]}],["bold","italic","underline","strike"],["link"],[{color:[]},{background:[]}],["clean"]]},null,8,["modelValue"])]),_:1})])])]),e("div",ct,[e("n-validate",null,[e("label",pt,r(n.$t("profile.forms.update.location")),1),e("div",ft,[c(e("input",{"onUpdate:modelValue":i[13]||(i[13]=_=>t(o).location=_),type:"text",class:b(["form-input input",{"pointer-events-none cursor-not-allowed":t(u).basic.loading}])},null,2),[[j,t(o).location]])])])]),e("div",mt,[e("div",null,[c(e("span",vt,[c(y(le,{class:"mr-2"},null,512),[[m,t(u).basic.loading]]),Q(" "+r(t(u).basic.loading?n.$t("updating"):n.$t("updated")),1)],512),[[m,t(u).basic.loading||t(u).basic.success]])]),e("button",{type:"submit",class:b(["flex flex-row w-full md:w-auto",t(u).basic.buttonDisabled?"disabled-button":"primary-button"])},[c(y(le,{class:"mr-2"},null,512),[[m,t(u).basic.loading]]),Q(" "+r(t(u).basic.loading?n.$t("updating"):n.$t("update")),1)],2)])],32),gt,e("form",{id:k,onSubmit:i[18]||(i[18]=D(_=>h(),["prevent"]))},[e("div",bt,[e("n-validate",{for:"=username",name:n.$t("profile.forms.update.username")},[e("label",ht,r(n.$t("profile.forms.update.username")),1),e("div",_t,[c(e("input",{"onUpdate:modelValue":i[15]||(i[15]=_=>t(o).username=_),type:"text",maxlength:"12",class:b(["form-input input",{"pointer-events-none cursor-not-allowed":t(u).username.loading}]),rules:"required|min:5",onInput:i[16]||(i[16]=_=>x()),onKeydown:i[17]||(i[17]=O(D(()=>{},["prevent"]),["space"]))},null,34),[[j,t(o).username]])])],8,wt)]),e("div",{class:b(["flex flex-row justify-between w-full",{"cursor-not-allowed":t(g)}])},[e("div",null,[c(e("span",{class:"text-success"},r(t(u).username.loading?n.$t("profile.forms.update.changingYourUsername"):n.$t("profile.forms.update.usernameChanged")),513),[[m,t(u).username.loading||t(u).username.success]])]),e("button",{type:"submit",class:b(["w-full md:w-auto",t(u).username.buttonDisabled?"disabled-button":"primary-button"])},[c(y(le,{class:"mr-2"},null,512),[[m,t(u).username.loading||t(u).username.checkingValidity]]),c(e("span",null,r(t(u).username.loading?n.$t("profile.forms.update.changingYourUsername"):n.$t("profile.forms.update.changeUsername")),513),[[m,!t(u).username.checkingValidity]]),c(e("span",null,"Checking..",512),[[m,t(u).username.checkingValidity]])],2)],2)],32)])}}},$t=re(yt,[["__scopeId","data-v-e3cef36a"]]);const xt={class:"w-full"},kt={class:"input-block"},Ct={class:"font-semibold"},St={class:"field"},At={class:"flex flex-row"},It=["placeholder"],Nt={class:"input-block"},Ut={class:"font-semibold"},Vt={class:"field"},Et={class:"flex flex-row"},Dt=["placeholder"],Pt={class:"input-block"},jt={class:"font-semibold"},Ft={class:"field"},Tt={class:"flex flex-row"},Lt=["placeholder"],Mt={class:"input-block"},Ot={class:"font-semibold"},Kt={class:"field"},Bt={class:"flex flex-row"},Rt=["placeholder"],zt={class:"input-block"},qt={class:"font-semibold"},Yt={class:"field"},Gt={class:"flex flex-row"},Ht=["placeholder"],Wt={class:"input-block"},Jt={class:"font-semibold"},Qt={class:"field"},Xt={class:"flex flex-row"},Zt=["placeholder"],es={class:"input-block"},ts={class:"font-semibold"},ss={class:"field"},os={class:"flex flex-row"},ls=["placeholder"],ns={class:"input-block"},as={class:"font-semibold"},is={class:"field"},rs={class:"flex flex-row"},us=["placeholder"],ds={class:"input-block"},cs={class:"font-semibold"},ps={class:"field"},fs={class:"flex flex-row"},ms=["placeholder"],vs={class:"input-block"},gs={class:"font-semibold"},bs={class:"field"},ws={class:"flex flex-row"},hs=["placeholder"],_s={class:"flex flex-row justify-between mt-2 w-full"},ys={__name:"Social",setup(F){const f=pe(),{oApiConfiguration:A,fetchOptions:v}=fe(),S=ge(A,v()),{t:C}=ae(),{$router:I}=me();ve(()=>{f.loggedIn||I.push("/")}),we(()=>{E()});const E=async()=>{if(f.loggedIn){const[l,s]=await S.getInfo(f.user.id);s||(d.value.facebook=l.user_socials.facebook,d.value.twitter=l.user_socials.twitter,d.value.instagram=l.user_socials.instagram,d.value.patreon=l.user_socials.patreon,d.value.youtube=l.user_socials.youtube,d.value.twitch=l.user_socials.twitch,d.value.discord=l.user_socials.discord,d.value.picarto=l.user_socials.picarto,d.value.gumroad=l.user_socials.gumroad,d.value.site=l.user_socials.personal_website)}},o=w({socials:{loading:!1,success:!1,buttonDisabled:!1}}),N="update-social-form",d=w({facebook:"",twitter:"",instagram:"",patreon:"",youtube:"",twitch:"",discrod:"",picarto:"",gumroad:"",site:""}),u=async()=>{ne().validate(N,C),o.value.socials.loading=!0;const[l,s]=await S.updateSocials({userId:f.user.id,facebook:d.value.facebook,twitter:d.value.twitter,instagram:d.value.instagram,patreon:d.value.patreon,youtube:d.value.youtube,twitch:d.value.twitch,discord:d.value.discord,picarto:d.value.picarto,gumroad:d.value.gumroad,site:d.value.site});!l&&s?o.value.socials.success=!1:o.value.socials.success=!0,o.value.socials.loading=!1};return(l,s)=>(H(),ie("div",xt,[e("form",{id:N,onSubmit:s[20]||(s[20]=D(a=>u(),["prevent"]))},[e("n-validate",kt,[e("label",Ct,r(l.$t("profile.forms.update.socials.facebook")),1),e("div",St,[e("div",At,[y(V,{name:"i-logos-facebook"}),c(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>t(d).facebook=a),type:"text",class:b(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.facebookPlaceholder"),onKeydown:s[1]||(s[1]=O(D(()=>{},["prevent"]),["space"]))},null,42,It),[[j,t(d).facebook]])])])]),e("n-validate",Nt,[e("label",Ut,r(l.$t("profile.forms.update.socials.twitter")),1),e("div",Vt,[e("div",Et,[y(V,{name:"i-logos-twitter"}),c(e("input",{"onUpdate:modelValue":s[2]||(s[2]=a=>t(d).twitter=a),type:"text",class:b(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.twitterPlaceholder"),onKeydown:s[3]||(s[3]=O(D(()=>{},["prevent"]),["space"]))},null,42,Dt),[[j,t(d).twitter]])])])]),e("n-validate",Pt,[e("label",jt,r(l.$t("profile.forms.update.socials.instagram")),1),e("div",Ft,[e("div",Tt,[y(V,{name:"i-ion-logo-instagram"}),c(e("input",{"onUpdate:modelValue":s[4]||(s[4]=a=>t(d).instagram=a),type:"text",class:b(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.instagramPlaceholder"),onKeydown:s[5]||(s[5]=O(D(()=>{},["prevent"]),["space"]))},null,42,Lt),[[j,t(d).instagram]])])])]),e("n-validate",Mt,[e("label",Ot,r(l.$t("profile.forms.update.socials.patreon")),1),e("div",Kt,[e("div",Bt,[y(V,{name:"i-logos-patreon"}),c(e("input",{"onUpdate:modelValue":s[6]||(s[6]=a=>t(d).patreon=a),type:"text",class:b(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.patreonPlaceholder"),onKeydown:s[7]||(s[7]=O(D(()=>{},["prevent"]),["space"]))},null,42,Rt),[[j,t(d).patreon]])])])]),e("n-validate",zt,[e("label",qt,r(l.$t("profile.forms.update.socials.youtube")),1),e("div",Yt,[e("div",Gt,[y(V,{name:"i-logos-youtube-icon"}),c(e("input",{"onUpdate:modelValue":s[8]||(s[8]=a=>t(d).youtube=a),type:"text",class:b(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.youtubePlaceholder"),onKeydown:s[9]||(s[9]=O(D(()=>{},["prevent"]),["space"]))},null,42,Ht),[[j,t(d).youtube]])])])]),e("n-validate",Wt,[e("label",Jt,r(l.$t("profile.forms.update.socials.twitch")),1),e("div",Qt,[e("div",Xt,[y(V,{name:"i-logos-twitch"}),c(e("input",{"onUpdate:modelValue":s[10]||(s[10]=a=>t(d).twitch=a),type:"text",class:b(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.twitchPlaceholder"),onKeydown:s[11]||(s[11]=O(D(()=>{},["prevent"]),["space"]))},null,42,Zt),[[j,t(d).twitch]])])])]),e("n-validate",es,[e("label",ts,r(l.$t("profile.forms.update.socials.discord")),1),e("div",ss,[e("div",os,[y(V,{name:"i-logos-discord-icon"}),c(e("input",{"onUpdate:modelValue":s[12]||(s[12]=a=>t(d).discord=a),type:"text",class:b(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.discordPlaceholder"),onKeydown:s[13]||(s[13]=O(D(()=>{},["prevent"]),["space"]))},null,42,ls),[[j,t(d).discord]])])])]),e("n-validate",ns,[e("label",as,r(l.$t("profile.forms.update.socials.picarto")),1),e("div",is,[e("div",rs,[y(V,{name:"i-cib-picarto-tv","icon-color":"bg-green-600"}),c(e("input",{"onUpdate:modelValue":s[14]||(s[14]=a=>t(d).picarto=a),type:"text",class:b(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.picartoPlaceholder"),onKeydown:s[15]||(s[15]=O(D(()=>{},["prevent"]),["space"]))},null,42,us),[[j,t(d).picarto]])])])]),e("n-validate",ds,[e("label",cs,r(l.$t("profile.forms.update.socials.gumroad")),1),e("div",ps,[e("div",fs,[y(V,{name:"i-cib-gumroad"}),c(e("input",{"onUpdate:modelValue":s[16]||(s[16]=a=>t(d).gumroad=a),type:"text",class:b(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.gumroadPlaceholder"),onKeydown:s[17]||(s[17]=O(D(()=>{},["prevent"]),["space"]))},null,42,ms),[[j,t(d).gumroad]])])])]),e("n-validate",vs,[e("label",gs,r(l.$t("profile.forms.update.socials.personalWebsite")),1),e("div",bs,[e("div",ws,[y(V,{name:"i-ph-link-simple-break-bold"}),c(e("input",{"onUpdate:modelValue":s[18]||(s[18]=a=>t(d).site=a),type:"text",class:b(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.personalWebsitePlaceholder"),onKeydown:s[19]||(s[19]=O(D(()=>{},["prevent"]),["space"]))},null,42,hs),[[j,t(d).site]])])])]),e("div",_s,[e("div",null,[c(e("span",{class:"text-success"},r(t(o).socials.loading?l.$t("updating"):l.$t("updated")),513),[[m,t(o).socials.loading||t(o).socials.success]])]),e("button",{type:"submit",class:b(["w-full md:w-auto",t(o).socials.buttonDisabled?"secondary-button pointer-events-none cursor-not-allowed":"primary-button cursor-pointer"])},r(t(o).socials.loading?l.$t("updating"):l.$t("update")),3)])],32)]))}},$s=re(ys,[["__scopeId","data-v-c824c21d"]]);const xs=F=>(ye("data-v-0264e2a3"),F=F(),$e(),F),ks={class:"w-full"},Cs={class:"mb-2 input-block"},Ss={class:"font-semibold"},As={class:"field"},Is={for:"small-toggle",class:"inline-flex relative items-center mb-5 cursor-pointer"},Ns=["checked"],Us=xs(()=>e("div",{class:"w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"},null,-1)),Vs={class:"ml-2"},Es={class:"flex flex-row justify-between w-full"},Ds={__name:"Settings",setup(F){const f=pe(),{oApiConfiguration:A,fetchOptions:v}=fe(),S=ge(A,v()),{t:C}=ae(),{$router:I}=me();ve(()=>{f.loggedIn||I.push("/")}),we(()=>{E()});const E=async()=>{if(f.loggedIn){const[l,s]=await S.getInfo(f.user.id);s||(d.value.showExplicit=!!l.user_settings.show_explicit)}},o=w({settings:{loading:!1,success:!1,buttonDisabled:!1}}),N="update-setting-form",d=w({showExplicit:!1}),u=async()=>{ne().validate(N,C),o.value.settings.loading=!0;const[l,s]=await S.updateSettings({userId:f.user.id,showExplicit:d.value.showExplicit});!l&&s?o.value.settings.success=!1:(o.value.settings.success=!0,f.user.user_settings.show_explicit=d.value.showExplicit?1:0),o.value.settings.loading=!1};return(l,s)=>(H(),ie("div",ks,[e("form",{id:N,onSubmit:s[1]||(s[1]=D(a=>u(),["prevent"]))},[e("div",Cs,[e("label",Ss,r(l.$t("explicitContent")),1),e("div",As,[e("label",Is,[e("input",{onClick:s[0]||(s[0]=a=>t(d).showExplicit=!t(d).showExplicit),id:"small-toggle",type:"checkbox",class:"sr-only peer",checked:t(d).showExplicit},null,8,Ns),Us,e("span",Vs,r(l.$t("profile.forms.update.showExplicitContent")),1)])])]),e("div",Es,[e("div",null,[c(e("span",{class:"text-success"},r(t(o).settings.loading?l.$t("updating"):l.$t("updated")),513),[[m,t(o).settings.loading||t(o).settings.success]])]),e("button",{type:"submit",class:b(["w-full md:w-auto",t(o).settings.buttonDisabled?"secondary-button pointer-events-none cursor-not-allowed":"primary-button cursor-pointer"])},r(t(o).settings.loading?l.$t("updating"):l.$t("update")),3)])],32)]))}},Ps=re(Ds,[["__scopeId","data-v-0264e2a3"]]);const js={class:"modal-layer xl:w-3/12 lg:w-2/5"},Fs={class:"flex flex-col justify-center w-full text-center"},Ts={class:"mb-6"},Ls={class:"flex flex-row justify-center mb-4 w-full text-base font-bold text-green-500"},Ms={__name:"SuccessMessageModal",props:{message:{type:String,default:"Success"},autoCloseAfterMs:{type:Number,default:2e3}},setup(F){const f=()=>{xe().closeModal("success-modal")};return(A,v)=>(H(),ie("div",null,[e("div",js,[e("div",Fs,[e("div",Ts,[e("div",Ls,[y(V,{class:"mr-2 font-bold text-green-400",name:"i-mdi-check-all","text-size":"text-xl"}),Q(" "+r(A.$t("success")),1)]),e("p",null,r(F.message),1)]),e("button",{onClick:v[0]||(v[0]=S=>f()),class:"success-button-close"},r(A.$t("close").toUpperCase()),1)])])]))}},Os=re(Ms,[["__scopeId","data-v-d5b7bf9b"]]);const Ks={class:"w-full"},Bs={class:"input-block"},Rs={class:"font-semibold"},zs={class:"field"},qs=["readonly","placeholder"],Ys={class:"flex flex-row justify-end"},Gs={class:"input-block"},Hs={class:"font-semibold"},Ws={class:"field"},Js=["readonly","placeholder"],Qs={class:"flex flex-row justify-between w-full"},Xs={__name:"Password",setup(F){const f=pe(),{oApiConfiguration:A,fetchOptions:v}=fe(),S=ge(A,v()),{t:C}=ae(),{$router:I}=me();ve(()=>{f.loggedIn||I.push("/")});const E=w(""),o=w(""),N=w(!1),d=()=>{E.value="",o.value="",N.value=!1},u=async()=>{N.value=!1,o.value="",a.value="";const[k,h]=await S.checkCurrentPassword({userId:f.user.id,currentPassword:E.value});h?o.value=h:N.value=!0},l=w({settings:{loading:!1,success:!1,buttonDisabled:!1}}),s="update-setting-form",a=w(""),p=w(""),g=()=>{a.value="",p.value=""},x=async()=>{l.value.settings.loading=!0,ne().validate(s,C);const[k,h]=await S.updateCurrentPassword({userId:f.user.id,currentPassword:E.value,newPassword:a.value});h?(l.value.settings.success=!1,p.value=h):(l.value.settings.success=!0,g(),d(),xe().openModal("success-modal")),l.value.settings.loading=!1};return(k,h)=>(H(),ie("div",Ks,[e("form",{onSubmit:h[1]||(h[1]=D(U=>u(),["prevent"]))},[e("div",Bs,[e("label",Rs,r(k.$t("profile.forms.update.password.currentPasswordLabel")),1),e("div",zs,[c(e("input",{"onUpdate:modelValue":h[0]||(h[0]=U=>_e(E)?E.value=U:null),type:"password",rules:"required|min:6|containNumber|containSymbol",class:b(["form-input input",{"cursor-not-allowed pointer-events-none":t(N)}]),readonly:t(N),placeholder:k.$t("profile.forms.update.password.currentPassword")},null,10,qs),[[j,t(E)]]),c(e("div",{class:"error-message"},r(t(o)),513),[[m,t(o)!==""]])])]),c(e("div",Ys,[e("button",{class:b([t(E)===""?"disabled-button pointer-events-none cursor-not-allowed":"primary-button cursor-pointer"])},r(k.$t("next")),3)],512),[[m,!t(N)]])],32),c(e("form",{id:s,onSubmit:h[3]||(h[3]=D(U=>x(),["prevent"]))},[e("div",Gs,[e("label",Hs,r(k.$t("profile.forms.update.password.newPassword")),1),e("div",Ws,[c(e("input",{"onUpdate:modelValue":h[2]||(h[2]=U=>_e(a)?a.value=U:null),type:"password",rules:"required|min:6|containNumber|containSymbol",class:b(["form-input input",{"cursor-not-allowed pointer-events-none":t(l).settings.loading}]),readonly:t(l).settings.loading,placeholder:k.$t("profile.forms.update.password.newPassword")},null,10,Js),[[j,t(a)]]),c(e("div",{class:"error-message"},r(t(p)),513),[[m,t(p)!==""]])])]),e("div",Qs,[e("div",null,[c(e("span",{class:"text-success"},r(t(l).settings.loading?k.$t("updating"):""),513),[[m,t(l).settings.loading||t(l).settings.success]])]),e("button",{type:"submit",class:b(["w-full md:w-auto",t(l).settings.buttonDisabled?"secondary-button pointer-events-none cursor-not-allowed":"primary-button cursor-pointer"])},r(t(l).settings.loading?k.$t("updating"):k.$t("update")),3)])],544),[[m,t(N)]]),y(Os,{id:"success-modal",class:"modal",message:k.$t("profile.forms.update.password.success"),"auto-close-after-ms":1e3},null,8,["message"])]))}},Zs=re(Xs,[["__scopeId","data-v-14c2b9ec"]]),eo={class:"flex flex-row w-full"},to={class:"mr-2 md:mr-4 lg:w-1/5"},so={class:"hidden-lg-flex"},oo={class:"hidden-lg-flex"},lo={class:"hidden-lg-flex"},no={class:"hidden-lg-flex"},ao={class:"hidden-lg-flex"},io={class:"w-full"},bo={__name:"setting",setup(F){const{t:f}=ae(),A=w(f("meta.title.profile.profile"));Ae({title:Ie(()=>A.value)});const v=w({currentState:"profile"});Ne(()=>v.value.currentState,C=>{C==="profile"?A.value=f("meta.title.profile.profile"):C==="social"?A.value=f("meta.title.profile.social"):C==="password"?A.value=f("meta.title.profile.password"):A.value=f("meta.title.profile.settings")});const S=C=>{v.value.currentState=C};return(C,I)=>{const E=Ue;return H(),oe(Ve,{"hide-side":!0,"with-footer":!0,"no-right-side":!0},{default:be(()=>[e("div",eo,[e("div",to,[y(E,{to:"/profile",class:"flex flex-row py-3 px-4 mb-4 font-medium leading-5 text-white rounded ring-offset-2 transition-all duration-200 cursor-pointer left-menu-link parent-icon theme-color hover:button hover:text-white button-color"},{default:be(()=>[y(V,{name:"i-typcn-arrow-back",class:"text-lg text-white lg:mr-2 hover:text-white"}),e("span",so,r(C.$t("settings.backToProfile")),1)]),_:1}),e("div",{class:b(["flex flex-row py-3 px-4 mb-2 font-medium leading-5 rounded ring-offset-2 transition-all duration-200 cursor-pointer left-menu-link parent-icon theme-color hover:button hover:text-white",{"button-color text-white":t(v).currentState==="profile"}]),onClick:I[0]||(I[0]=o=>S("profile"))},[c(y(V,{name:"i-fluent-person-32-regular",class:"text-lg text-white lg:mr-2 hover:text-white"},null,512),[[m,t(v).currentState==="profile"]]),c(y(V,{name:"i-fluent-person-32-regular",class:"text-lg lg:mr-2 hover:text-white"},null,512),[[m,t(v).currentState!=="profile"]]),e("span",oo,r(C.$t("settings.profile")),1)],2),e("div",{class:b(["flex flex-row py-3 px-4 mb-2 font-medium leading-5 rounded ring-offset-2 transition-all duration-200 cursor-pointer left-menu-link parent-icon theme-color hover:button hover:text-white",{"button-color text-white":t(v).currentState==="social"}]),onClick:I[1]||(I[1]=o=>S("social"))},[c(y(V,{name:"i-ion-share-social-outline",class:"text-lg text-white lg:mr-2 hover:text-white"},null,512),[[m,t(v).currentState==="social"]]),c(y(V,{name:"i-ion-share-social-outline",class:"text-lg lg:mr-2 hover:text-white"},null,512),[[m,t(v).currentState!=="social"]]),e("span",lo,r(C.$t("settings.social")),1)],2),e("div",{class:b(["flex flex-row py-3 px-4 mb-2 font-medium leading-5 rounded ring-offset-2 transition-all duration-200 cursor-pointer left-menu-link parent-icon theme-color hover:button hover:text-white",{"button-color text-white":t(v).currentState==="password"}]),onClick:I[2]||(I[2]=o=>S("password"))},[c(y(V,{name:"i-material-symbols-key-outline-rounded",class:"text-lg text-white lg:mr-2 hover:text-white"},null,512),[[m,t(v).currentState==="password"]]),c(y(V,{name:"i-material-symbols-key-outline-rounded",class:"text-lg lg:mr-2 hover:text-white"},null,512),[[m,t(v).currentState!=="password"]]),e("span",no,r(C.$t("settings.password")),1)],2),e("div",{class:b(["flex flex-row py-3 px-4 mb-2 font-medium leading-5 rounded ring-offset-2 transition-all duration-200 cursor-pointer left-menu-link parent-icon theme-color hover:button hover:text-white",{"button-color text-white":t(v).currentState==="settings"}]),onClick:I[3]||(I[3]=o=>S("settings"))},[c(y(V,{name:"i-ph-gear-six",class:"text-lg text-white lg:mr-2 hover:text-white"},null,512),[[m,t(v).currentState==="settings"]]),c(y(V,{name:"i-ph-gear-six",class:"text-lg lg:mr-2 hover:text-white"},null,512),[[m,t(v).currentState!=="settings"]]),e("span",ao,r(C.$t("settings.settings")),1)],2)]),e("div",io,[t(v).currentState==="profile"?(H(),oe($t,{key:0})):de("",!0),t(v).currentState==="social"?(H(),oe($s,{key:1})):de("",!0),t(v).currentState==="settings"?(H(),oe(Ps,{key:2})):de("",!0),t(v).currentState==="password"?(H(),oe(Zs,{key:3})):de("",!0)])])]),_:1})}}};export{bo as default};
