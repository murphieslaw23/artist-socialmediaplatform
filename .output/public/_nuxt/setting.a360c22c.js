import{bN as ke,k as de,j as ce,C as re,I as xe,a as pe,Y as fe,m as be,r as b,o as M,p as se,q as e,t as r,b as c,v,u as t,K as w,e as y,s as te,F as j,U as K,G as D,x as le,w as ge,h as he,L as V,M as Ce,N as Se,H as _e,T as we,f as Ae,D as Ie,E as Ne,c as ae,y as Ue}from"./entry.ed1bfc63.js";import{u as ie,L as Ve}from"./Layout.c894869a.js";import{_ as Ee}from"./ProBadge.dc1cf83d.js";import{v as De,q as Pe}from"./text-editor.47d3431a.js";import{S as ne}from"./Spinner.bfc0b0e5.js";import{u as me}from"./useUser.374c898b.js";import{_ as ve}from"./_plugin-vue_export-helper.a1a6add7.js";import"./user-counters-api.0d36adb4.js";var ue={exports:{}};(function(B,f){(function(A,g){g(f)})(ke,function(A){function g(s,n){return function(p){if(Array.isArray(p))return p}(s)||function(p,m){var k=p==null?null:typeof Symbol<"u"&&p[Symbol.iterator]||p["@@iterator"];if(k!=null){var x,_,U=[],F=!0,T=!1;try{for(k=k.call(p);!(F=(x=k.next()).done)&&(U.push(x.value),!m||U.length!==m);F=!0);}catch(z){T=!0,_=z}finally{try{F||k.return==null||k.return()}finally{if(T)throw _}}return U}}(s,n)||function(p,m){if(!!p){if(typeof p=="string")return S(p,m);var k=Object.prototype.toString.call(p).slice(8,-1);if(k==="Object"&&p.constructor&&(k=p.constructor.name),k==="Map"||k==="Set")return Array.from(p);if(k==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k))return S(p,m)}}(s,n)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function S(s,n){(n==null||n>s.length)&&(n=s.length);for(var p=0,m=new Array(n);p<n;p++)m[p]=s[p];return m}function C(s,n){var p,m,k,x,_=null,U=typeof n=="number"?n:(p=g(String(n).split(/(ms|s)/i),2),m=p[0],k=p[1],x=k===void 0?"ms":k,Number(m)*{ms:1,s:1e3}[x]),F=function(){for(var T=this,z=arguments.length,P=new Array(z),O=0;O<z;O++)P[O]=arguments[O];var Y=function(){_=null,s.apply(T,P)};clearTimeout(_),(_=setTimeout(Y,U))||s.apply(this,P)};return F.cancel=function(){clearTimeout(_),_=null},F}function I(s){return s.map(function(n){return n.toLowerCase()})}function E(s,n){var p,m=s?s["debounce-events"]:[];return m&&m.length>0?Array.isArray(m)?I(m):I(m.split(",")):I((p=n,Array.isArray(p)?p:p==null?[]:[p]))}function o(s){return s===""}function N(s,n){return s==="Enter"&&(!n.lock||n.unlock)}function i(s,n,p){return o(s)&&p.fireonempty&&(n==="Enter"||n===" ")}function u(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=s.lock,p=n!==void 0&&n,m=s.listenTo,k=m===void 0?"keyup":m,x=s.defaultTime,_=x===void 0?"300ms":x,U=s.fireOnEmpty,F=U!==void 0&&U,T=s.cancelOnEmpty,z=T!==void 0&&T,P=s.trim,O=P!==void 0&&P;return{bind:function(Y,W,J){var oe=W.value,Q=W.arg,X=Q===void 0?_:Q,Z=W.modifiers,R=Object.assign({lock:p,trim:O,fireonempty:F,cancelonempty:z},Z),H=E(J.data.attrs,k),G=C(function($){oe($.target.value,$)},X);function ee($){var q=R.trim?$.target.value.trim():$.target.value;o(q)&&R.cancelonempty?G.cancel():N($.key,R)||i(q,$.key,R)?(G.cancel(),oe($.target.value,$)):G($)}H.forEach(function($){Y.addEventListener($,ee)})}}}var l={install:function(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s.directive("debounce",u(n))}};A.debounce=C,A.default=l,A.vue3Debounce=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=s.lock,p=n!==void 0&&n,m=s.listenTo,k=m===void 0?"keyup":m,x=s.defaultTime,_=x===void 0?"300ms":x,U=s.fireOnEmpty,F=U!==void 0&&U,T=s.cancelOnEmpty,z=T!==void 0&&T,P=s.trim,O=P!==void 0&&P;return{created:function(Y,W,J){var oe=W.value,Q=W.arg,X=Q===void 0?_:Q,Z=W.modifiers,R=Object.assign({lock:p,trim:O,fireonempty:F,cancelonempty:z},Z),H=E(J.props,k),G=C(function($){oe($.target.value,$)},X);function ee($){var q=R.trim?$.target.value.trim():$.target.value;o(q)&&R.cancelonempty?G.cancel():N($.key,R)||i(q,$.key,R)?(G.cancel(),oe($.target.value,$)):G($)}H.forEach(function($){Y.addEventListener($,ee)})}}},Object.defineProperty(A,"__esModule",{value:!0})})})(ue,ue.exports);const je={class:"flex flex-col w-full"},Fe={class:"mb-4 w-44"},Te={class:"font-semibold"},Le={class:"mt-2"},Me=["src"],Oe=["src"],Ke={class:"w-full"},Be=e("div",{class:"w-full"},".jpg/.jpeg",-1),Re={class:"mt-2 w-full text-center text-failure"},Ge=e("br",null,null,-1),qe=e("div",{class:"mb-4 custom-divider"},null,-1),ze={class:"mb-4"},Ye={class:"font-semibold"},He={class:"mt-2"},We=["src"],Je=["src"],Qe={class:"flex flex-row justify-end w-full"},Xe={class:"mt-2 w-full text-center text-failure"},Ze=e("br",null,null,-1),et=e("div",{class:"mb-4 custom-divider"},null,-1),tt=["id"],st={class:"input-block"},ot=["name"],lt={class:"font-semibold"},at={class:"field"},nt={class:"input-block"},it={class:"font-semibold"},rt={class:"field"},ut={key:0,class:"input-error"},dt={class:"input-block"},ct={class:"font-semibold"},pt={class:"mb-4 field"},ft={class:"input-block"},mt={class:"font-semibold"},vt={class:"field"},gt={class:"flex flex-row justify-between w-full"},bt={class:"flex flex-row text-success"},ht=e("div",{class:"mb-4 custom-divider"},null,-1),wt={class:"input-block"},_t=["name"],yt={class:"font-semibold"},$t={class:"field"},kt={key:0,class:"input-error"},xt={__name:"Information",setup(B){const f=de(),{oApiConfiguration:A,fetchOptions:g}=ce(),S=me(A,g()),{t:C}=re(),I=xe(),{$router:E}=pe();fe(()=>{f.loggedIn||E.push("/")}),be(()=>{i()});const o=b({name:"",username:"",penName:"",bio:"",location:""}),N=b({username:"",penName:""}),i=async()=>{if(f.loggedIn){const[a,d]=await S.getInfo(f.user.id);d||(o.value.name=a.name,o.value.username=a.username,N.value.username=a.username,o.value.penName=a.pen_name,N.value.penName=a.pen_name,o.value.bio=a.bio,o.value.location=a.location)}},u=b({basic:{loading:!1,success:!1,buttonDisabled:!1,checkingValidity:!1},username:{loading:!1,success:!1,buttonDisabled:!0,checkingValidity:!1}}),l=b(!1),s=async()=>{o.value.penName===""&&(l.value=!1,u.value.basic.checkingValidity=!1,u.value.basic.buttonDisabled=!1);const a=o.value.penName.length>=4&&o.value.penName.length<=12;a?(u.value.basic.checkingValidity=!0,u.value.basic.buttonDisabled=!0,await ue.exports.debounce(async d=>{if(o.value.penName===N.value.penName&&(l.value=!1,u.value.basic.checkingValidity=!1),a){const[L,h]=await S.checkPenNameAvailability(o.value.penName);!L&&h&&f.user.pen_name!==o.value.penName?(l.value=!0,u.value.basic.checkingValidity=!1,u.value.basic.buttonDisabled=!0):(l.value=!1,u.value.basic.checkingValidity=!1,u.value.basic.buttonDisabled=!1)}},700)()):l.value=!1},n=b("basic-information-form"),p=async a=>{if(ie().validate(a,C),!l.value){u.value.basic.loading=!0;const[d,L]=await S.updateInfo({userId:f.user.id,name:o.value.name,bio:o.value.bio,location:o.value.location,penName:o.value.penName});!d&&L?u.value.basic.loading=!1:u.value.basic.success=!0,u.value.basic.loading=!1}},m=b(!1),k=async()=>{o.value.username===""&&(m.value=!1,u.value.username.buttonDisabled=!0,u.value.username.checkingValidity=!1);const a=o.value.username.length>=4&&o.value.username.length<=12;a?(u.value.username.buttonDisabled=!0,u.value.username.checkingValidity=!0,await ue.exports.debounce(async d=>{if(o.value.username==N.value.username)m.value=!1,u.value.username.buttonDisabled=!0,u.value.username.checkingValidity=!1;else if(a){const[L,h]=await S.checkUsernameAvailability(o.value.username);!L&&h?(m.value=!0,u.value.username.buttonDisabled=!0,u.value.username.checkingValidity=!1):(m.value=!1,u.value.username.buttonDisabled=!1,u.value.username.checkingValidity=!1)}},700)()):m.value=!1},x="change-username-form",_=async()=>{if(ie().validate(changeUsernameformId,C),!m.value){u.value.username.loading=!0;const[a,d]=await S.changeUsername(o.value.username);!a&&d?u.value.username.loading=!1:u.value.username.success=!0,u.value.username.loading=!1}},U=()=>{document.getElementById("inputAvatarFile").click()},F=b(""),T=b(""),z=a=>{const d=a.target.files[0];T.value=URL.createObjectURL(d),F.value=d},P=b(!1),O=b(!1),Y=b(!1),W=b(null),J=b(""),oe=async()=>{if(F.value){O.value=!1,P.value=!0,Y.value=!1,J.value="";const a=F.value,d=new FormData;d.append("avatar",a);try{const L=await he.post(I.public.apiUrl+"/user/update/avatar",d,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${f.a4ht0jen}`}});O.value=!0}catch(L){const h=L.response;h.data.error==="File too large"?Y.value=!0:J.value=h.data.message}P.value=!1}},Q=()=>{document.getElementById("inputCoverFile").click()},X=b(""),Z=b(""),R=a=>{const d=a.target.files[0];Z.value=URL.createObjectURL(d),X.value=d},H=b(!1),G=b(!1),ee=b(!1),$=b(null),q=b(""),$e=async()=>{if(X.value){G.value=!1,H.value=!0,ee.value=!1,q.value="";const a=X.value,d=new FormData;d.append("cover",a);try{const L=await he.post(I.public.apiUrl+"/user/update/cover",d,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${f.a4ht0jen}`}});G.value=!0}catch(L){const h=L.response;h.data.error==="File too large"?ee.value=!0:q.value=h.data.message}H.value=!1}};return(a,d)=>{const L=Ee;return M(),se("div",je,[e("div",Fe,[e("label",Te,r(a.$t("profile.forms.update.avatar")),1),e("div",Le,[c(e("img",{src:a.avatarCoverUrl(t(f).user.avatar_bucket,t(f).user.avatar_filename),class:"avatar",onError:d[0]||(d[0]=(...h)=>a.imageLoadError&&a.imageLoadError(...h))},null,40,Me),[[v,!t(T)]]),c(e("img",{src:t(T),class:w(["avatar",t(Y)||t(J)?"border-2 border-red-400":"border-none"])},null,10,Oe),[[v,t(T)]]),e("input",{id:"inputAvatarFile",ref_key:"selectedNewAvatarRef",ref:W,type:"file",accept:"image/jpeg",class:"hidden",onChange:z},null,544),e("button",{id:"selectNewAvatarButton",class:"flex flex-col mt-2 w-full text-center primary-button",onClick:d[1]||(d[1]=h=>U())},[e("div",Ke,r(a.$t("profile.forms.update.chooseNewAvatar")),1),Be]),e("button",{class:w(["flex flex-row mt-2 w-full",[t(F)?"primary-button cursor-pointer":"disabled-button cursor-not-allowed",t(P)?"disabled-button cursor-not-allowed":"primary-button cursor-pointer"]]),onClick:d[2]||(d[2]=h=>U&&!t(P)?oe():null)},[c(y(ne,{class:"mr-2"},null,512),[[v,t(P)]]),te(" "+r(t(P)?a.$t("updating"):a.$t("update")),1)],2),c(e("div",Re,[te(r(a.$t("profile.forms.update.fileTooLarge"))+" ",1),Ge,te(" "+r(a.$t("profile.forms.update.avatarMaxAllowedFileSize")),1)],512),[[v,t(Y)]]),c(e("div",{class:"mt-2 w-full text-center text-failure"},r(t(J)),513),[[v,t(J)!=""]]),c(e("div",{class:"mt-2 w-full text-center text-success"},r(a.$t("updated")),513),[[v,t(O)]])])]),qe,e("div",ze,[e("label",Ye,r(a.$t("profile.forms.update.cover")),1),e("div",He,[c(e("img",{src:a.avatarCoverUrl(t(f).user.cover_bucket,t(f).user.cover_filename),class:"object-cover object-top w-full h-28 rounded-md md:h-48 lg:h-64 xl:h-72 unselectable",onError:d[3]||(d[3]=(...h)=>a.defaultCoverImage&&a.defaultCoverImage(...h))},null,40,We),[[v,!t(Z)]]),c(e("img",{src:t(Z),class:w(["object-cover object-top w-full h-28 rounded-md md:h-48 lg:h-64 xl:h-72 unselectable",t(ee)||t(q)?"border-2 border-red-400":"border-none"])},null,10,Je),[[v,t(Z)]]),e("input",{id:"inputCoverFile",ref_key:"selectedNewCoverRef",ref:$,type:"file",accept:"image/png, image/gif, image/jpeg",class:"hidden",onChange:R},null,544),e("button",{id:"selectNewCoverButton",class:"mt-2 w-full primary-button",onClick:d[4]||(d[4]=h=>Q())},r(a.$t("profile.forms.update.chooseNewCover")),1),e("div",Qe,[e("button",{class:w(["flex flex-row mt-2 w-full md:w-auto",[t(X)?"primary-button cursor-pointer":"disabled-button cursor-not-allowed",t(H)?"disabled-button cursor-not-allowed":"primary-button cursor-pointer"]]),onClick:d[5]||(d[5]=h=>Q&&!t(H)?$e():null)},[c(y(ne,{class:"mr-2"},null,512),[[v,t(H)]]),te(" "+r(t(H)?a.$t("updating"):a.$t("update")),1)],2)]),c(e("div",Xe,[te(r(a.$t("profile.forms.update.fileTooLarge"))+" ",1),Ze,te(" "+r(a.$t("profile.forms.update.coverMaxAllowedFileSize")),1)],512),[[v,t(ee)]]),c(e("div",{class:"mt-2 w-full text-center text-failure"},r(t(q)),513),[[v,t(q)!=""]]),c(e("div",{class:"mt-2 w-full text-center text-success"},r(a.$t("updated")),513),[[v,t(G)]])])]),et,e("form",{id:t(n),class:"mb-4",onSubmit:d[12]||(d[12]=D(h=>p(t(n)),["prevent"]))},[e("div",st,[e("n-validate",{for:"name",name:a.$t("profile.forms.update.name")},[e("label",lt,r(a.$t("profile.forms.update.name")),1),e("div",at,[c(e("input",{"onUpdate:modelValue":d[6]||(d[6]=h=>t(o).name=h),type:"text",rules:"required|min:2",class:w(["form-input input",{"pointer-events-none cursor-not-allowed":t(u).basic.loading}])},null,2),[[j,t(o).name]])])],8,ot)]),e("div",nt,[e("n-validate",null,[e("label",it,r(a.$t("profile.forms.update.penName")),1),e("div",rt,[c(e("input",{"onUpdate:modelValue":d[7]||(d[7]=h=>t(o).penName=h),type:"text",maxlength:"12",class:w(["form-input input",{"pointer-events-none cursor-not-allowed":t(u).username.loading}]),onInput:d[8]||(d[8]=h=>s()),onKeydown:d[9]||(d[9]=K(D(()=>{},["prevent"]),["space"]))},null,34),[[j,t(o).penName]]),t(l)?(M(),se("div",ut,r(a.$t("profile.forms.update.penNameTaken")),1)):le("",!0)])])]),e("div",dt,[e("n-validate",null,[e("label",ct,r(a.$t("profile.forms.update.bio")),1),e("div",pt,[y(L,null,{default:ge(()=>[y(t(De.exports.VueEditor),{modelValue:t(o).bio,"onUpdate:modelValue":d[10]||(d[10]=h=>t(o).bio=h),editorToolbar:t(Pe)},null,8,["modelValue","editorToolbar"])]),_:1})])])]),e("div",ft,[e("n-validate",null,[e("label",mt,r(a.$t("profile.forms.update.location")),1),e("div",vt,[c(e("input",{"onUpdate:modelValue":d[11]||(d[11]=h=>t(o).location=h),type:"text",class:w(["form-input input",{"pointer-events-none cursor-not-allowed":t(u).basic.loading}])},null,2),[[j,t(o).location]])])])]),e("div",gt,[e("div",null,[c(e("span",bt,[c(y(ne,{class:"mr-2"},null,512),[[v,t(u).basic.loading]]),te(" "+r(t(u).basic.loading?a.$t("updating"):a.$t("updated")),1)],512),[[v,t(u).basic.loading||t(u).basic.success]])]),e("button",{type:"submit",class:w(["flex flex-row w-full md:w-auto",t(u).basic.buttonDisabled?"disabled-button":"primary-button"])},[c(y(ne,null,null,512),[[v,t(u).basic.loading||t(u).basic.checkingValidity]]),c(e("span",null,r(t(u).basic.loading?a.$t("updating"):a.$t("update")),513),[[v,!t(u).basic.checkingValidity]])],2)])],40,tt),ht,e("form",{id:x,onSubmit:d[16]||(d[16]=D(h=>_(),["prevent"]))},[e("div",wt,[e("n-validate",{for:"=username",name:a.$t("profile.forms.update.username")},[e("label",yt,r(a.$t("profile.forms.update.username")),1),e("div",$t,[c(e("input",{"onUpdate:modelValue":d[13]||(d[13]=h=>t(o).username=h),type:"text",maxlength:"12",class:w(["form-input input",{"pointer-events-none cursor-not-allowed":t(u).username.loading}]),rules:"required|min:5",onInput:d[14]||(d[14]=h=>k()),onKeydown:d[15]||(d[15]=K(D(()=>{},["prevent"]),["space"]))},null,34),[[j,t(o).username]]),t(m)?(M(),se("div",kt,r(a.$t("profile.forms.update.usernameTaken")),1)):le("",!0)])],8,_t)]),e("div",{class:w(["flex flex-row justify-between w-full",{"cursor-not-allowed":t(m)}])},[e("div",null,[c(e("span",{class:"text-success"},r(t(u).username.loading?a.$t("profile.forms.update.changingYourUsername"):a.$t("profile.forms.update.usernameChanged")),513),[[v,t(u).username.loading||t(u).username.success]])]),e("button",{type:"submit",class:w(["w-full md:w-auto",t(u).username.buttonDisabled?"disabled-button":"primary-button"])},[c(y(ne,null,null,512),[[v,t(u).username.loading||t(u).username.checkingValidity]]),c(e("span",null,r(t(u).username.loading?a.$t("profile.forms.update.changingYourUsername"):a.$t("profile.forms.update.changeUsername")),513),[[v,!t(u).username.checkingValidity]])],2)],2)],32)])}}};const Ct={class:"w-full"},St={class:"input-block"},At={class:"font-semibold"},It={class:"field"},Nt={class:"flex flex-row"},Ut=["placeholder"],Vt={class:"input-block"},Et={class:"font-semibold"},Dt={class:"field"},Pt={class:"flex flex-row"},jt=["placeholder"],Ft={class:"input-block"},Tt={class:"font-semibold"},Lt={class:"field"},Mt={class:"flex flex-row"},Ot=["placeholder"],Kt={class:"input-block"},Bt={class:"font-semibold"},Rt={class:"field"},Gt={class:"flex flex-row"},qt=["placeholder"],zt={class:"input-block"},Yt={class:"font-semibold"},Ht={class:"field"},Wt={class:"flex flex-row"},Jt=["placeholder"],Qt={class:"input-block"},Xt={class:"font-semibold"},Zt={class:"field"},es={class:"flex flex-row"},ts=["placeholder"],ss={class:"input-block"},os={class:"font-semibold"},ls={class:"field"},as={class:"flex flex-row"},ns=["placeholder"],is={class:"input-block"},rs={class:"font-semibold"},us={class:"field"},ds={class:"flex flex-row"},cs=["placeholder"],ps={class:"input-block"},fs={class:"font-semibold"},ms={class:"field"},vs={class:"flex flex-row"},gs=["placeholder"],bs={class:"input-block"},hs={class:"font-semibold"},ws={class:"field"},_s={class:"flex flex-row"},ys=["placeholder"],$s={class:"flex flex-row justify-between mt-2 w-full"},ks={__name:"Social",setup(B){const f=de(),{oApiConfiguration:A,fetchOptions:g}=ce(),S=me(A,g()),{t:C}=re(),{$router:I}=pe();fe(()=>{f.loggedIn||I.push("/")}),be(()=>{E()});const E=async()=>{if(f.loggedIn){const[l,s]=await S.getInfo(f.user.id);s||(i.value.facebook=l.user_socials.facebook,i.value.twitter=l.user_socials.twitter,i.value.instagram=l.user_socials.instagram,i.value.patreon=l.user_socials.patreon,i.value.youtube=l.user_socials.youtube,i.value.twitch=l.user_socials.twitch,i.value.discord=l.user_socials.discord,i.value.picarto=l.user_socials.picarto,i.value.gumroad=l.user_socials.gumroad,i.value.site=l.user_socials.personal_website)}},o=b({socials:{loading:!1,success:!1,buttonDisabled:!1}}),N="update-social-form",i=b({facebook:"",twitter:"",instagram:"",patreon:"",youtube:"",twitch:"",discrod:"",picarto:"",gumroad:"",site:""}),u=async()=>{ie().validate(N,C),o.value.socials.loading=!0;const[l,s]=await S.updateSocials({userId:f.user.id,facebook:i.value.facebook,twitter:i.value.twitter,instagram:i.value.instagram,patreon:i.value.patreon,youtube:i.value.youtube,twitch:i.value.twitch,discord:i.value.discord,picarto:i.value.picarto,gumroad:i.value.gumroad,site:i.value.site});!l&&s?o.value.socials.success=!1:o.value.socials.success=!0,o.value.socials.loading=!1};return(l,s)=>(M(),se("div",Ct,[e("form",{id:N,onSubmit:s[20]||(s[20]=D(n=>u(),["prevent"]))},[e("n-validate",St,[e("label",At,r(l.$t("profile.forms.update.socials.facebook")),1),e("div",It,[e("div",Nt,[y(V,{name:"i-logos-facebook"}),c(e("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>t(i).facebook=n),type:"text",class:w(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.facebookPlaceholder"),onKeydown:s[1]||(s[1]=K(D(()=>{},["prevent"]),["space"]))},null,42,Ut),[[j,t(i).facebook]])])])]),e("n-validate",Vt,[e("label",Et,r(l.$t("profile.forms.update.socials.twitter")),1),e("div",Dt,[e("div",Pt,[y(V,{name:"i-logos-twitter"}),c(e("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>t(i).twitter=n),type:"text",class:w(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.twitterPlaceholder"),onKeydown:s[3]||(s[3]=K(D(()=>{},["prevent"]),["space"]))},null,42,jt),[[j,t(i).twitter]])])])]),e("n-validate",Ft,[e("label",Tt,r(l.$t("profile.forms.update.socials.instagram")),1),e("div",Lt,[e("div",Mt,[y(V,{name:"i-ion-logo-instagram"}),c(e("input",{"onUpdate:modelValue":s[4]||(s[4]=n=>t(i).instagram=n),type:"text",class:w(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.instagramPlaceholder"),onKeydown:s[5]||(s[5]=K(D(()=>{},["prevent"]),["space"]))},null,42,Ot),[[j,t(i).instagram]])])])]),e("n-validate",Kt,[e("label",Bt,r(l.$t("profile.forms.update.socials.patreon")),1),e("div",Rt,[e("div",Gt,[y(V,{name:"i-logos-patreon"}),c(e("input",{"onUpdate:modelValue":s[6]||(s[6]=n=>t(i).patreon=n),type:"text",class:w(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.patreonPlaceholder"),onKeydown:s[7]||(s[7]=K(D(()=>{},["prevent"]),["space"]))},null,42,qt),[[j,t(i).patreon]])])])]),e("n-validate",zt,[e("label",Yt,r(l.$t("profile.forms.update.socials.youtube")),1),e("div",Ht,[e("div",Wt,[y(V,{name:"i-logos-youtube-icon"}),c(e("input",{"onUpdate:modelValue":s[8]||(s[8]=n=>t(i).youtube=n),type:"text",class:w(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.youtubePlaceholder"),onKeydown:s[9]||(s[9]=K(D(()=>{},["prevent"]),["space"]))},null,42,Jt),[[j,t(i).youtube]])])])]),e("n-validate",Qt,[e("label",Xt,r(l.$t("profile.forms.update.socials.twitch")),1),e("div",Zt,[e("div",es,[y(V,{name:"i-logos-twitch"}),c(e("input",{"onUpdate:modelValue":s[10]||(s[10]=n=>t(i).twitch=n),type:"text",class:w(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.twitchPlaceholder"),onKeydown:s[11]||(s[11]=K(D(()=>{},["prevent"]),["space"]))},null,42,ts),[[j,t(i).twitch]])])])]),e("n-validate",ss,[e("label",os,r(l.$t("profile.forms.update.socials.discord")),1),e("div",ls,[e("div",as,[y(V,{name:"i-logos-discord-icon"}),c(e("input",{"onUpdate:modelValue":s[12]||(s[12]=n=>t(i).discord=n),type:"text",class:w(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.discordPlaceholder"),onKeydown:s[13]||(s[13]=K(D(()=>{},["prevent"]),["space"]))},null,42,ns),[[j,t(i).discord]])])])]),e("n-validate",is,[e("label",rs,r(l.$t("profile.forms.update.socials.picarto")),1),e("div",us,[e("div",ds,[y(V,{name:"i-cib-picarto-tv","icon-color":"bg-green-600"}),c(e("input",{"onUpdate:modelValue":s[14]||(s[14]=n=>t(i).picarto=n),type:"text",class:w(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.picartoPlaceholder"),onKeydown:s[15]||(s[15]=K(D(()=>{},["prevent"]),["space"]))},null,42,cs),[[j,t(i).picarto]])])])]),e("n-validate",ps,[e("label",fs,r(l.$t("profile.forms.update.socials.gumroad")),1),e("div",ms,[e("div",vs,[y(V,{name:"i-cib-gumroad"}),c(e("input",{"onUpdate:modelValue":s[16]||(s[16]=n=>t(i).gumroad=n),type:"text",class:w(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.gumroadPlaceholder"),onKeydown:s[17]||(s[17]=K(D(()=>{},["prevent"]),["space"]))},null,42,gs),[[j,t(i).gumroad]])])])]),e("n-validate",bs,[e("label",hs,r(l.$t("profile.forms.update.socials.personalWebsite")),1),e("div",ws,[e("div",_s,[y(V,{name:"i-ph-link-simple-break-bold"}),c(e("input",{"onUpdate:modelValue":s[18]||(s[18]=n=>t(i).site=n),type:"text",class:w(["rounded-l-none form-input input",[{"pointer-events-none cursor-not-allowed":t(o).socials.loading}]]),placeholder:l.$t("profile.forms.update.socials.personalWebsitePlaceholder"),onKeydown:s[19]||(s[19]=K(D(()=>{},["prevent"]),["space"]))},null,42,ys),[[j,t(i).site]])])])]),e("div",$s,[e("div",null,[c(e("span",{class:"text-success"},r(t(o).socials.loading?l.$t("updating"):l.$t("updated")),513),[[v,t(o).socials.loading||t(o).socials.success]])]),e("button",{type:"submit",class:w(["w-full md:w-auto",t(o).socials.buttonDisabled?"secondary-button pointer-events-none cursor-not-allowed":"primary-button cursor-pointer"])},r(t(o).socials.loading?l.$t("updating"):l.$t("update")),3)])],32)]))}},xs=ve(ks,[["__scopeId","data-v-c824c21d"]]);const ye=B=>(Ce("data-v-0123a00d"),B=B(),Se(),B),Cs={class:"w-full"},Ss={class:"mb-2 input-block"},As={class:"font-semibold"},Is={class:"field"},Ns={for:"explicit-toggle",class:"inline-flex relative items-center mb-5 cursor-pointer"},Us=["checked"],Vs=ye(()=>e("div",{class:"w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"},null,-1)),Es={class:"ml-2"},Ds={key:0,class:"mb-2 input-block"},Ps={class:"font-semibold"},js={class:"field"},Fs={for:"gore-toggle",class:"inline-flex relative items-center mb-5 cursor-pointer"},Ts=["checked"],Ls=ye(()=>e("div",{class:"w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"},null,-1)),Ms={class:"ml-2"},Os={class:"flex flex-row justify-between w-full"},Ks={__name:"Settings",setup(B){const f=de(),{oApiConfiguration:A,fetchOptions:g}=ce(),S=me(A,g()),{t:C}=re(),{$router:I}=pe();fe(()=>{f.loggedIn||I.push("/")}),be(()=>{E()});const E=async()=>{if(f.loggedIn){const[l,s]=await S.getInfo(f.user.id);s||(i.value.showExplicit=!!l.user_settings.show_explicit,i.value.showGore=!!l.user_settings.show_gore)}},o=b({settings:{loading:!1,success:!1,buttonDisabled:!1}}),N="update-setting-form",i=b({showExplicit:!1,showGore:!1}),u=async()=>{ie().validate(N,C),o.value.settings.loading=!0;const[l,s]=await S.updateSettings({userId:f.user.id,showExplicit:i.value.showExplicit,showGore:i.value.showGore});!l&&s?o.value.settings.success=!1:(o.value.settings.success=!0,f.user.user_settings.show_explicit=i.value.showExplicit?1:0,f.user.user_settings.show_gore=i.value.showGore?1:0),o.value.settings.loading=!1};return(l,s)=>(M(),se("div",Cs,[e("form",{id:N,onSubmit:s[2]||(s[2]=D(n=>u(),["prevent"]))},[e("div",Ss,[e("label",As,r(l.$t("explicitContent")),1),e("div",Is,[e("label",Ns,[e("input",{onClick:s[0]||(s[0]=n=>t(i).showExplicit=!t(i).showExplicit),id:"explicit-toggle",type:"checkbox",class:"sr-only peer",checked:t(i).showExplicit},null,8,Us),Vs,e("span",Es,r(l.$t("profile.forms.update.showExplicitContent")),1)])])]),t(i).showExplicit?(M(),se("div",Ds,[e("label",Ps,r(l.$t("goreContent")),1),e("div",js,[e("label",Fs,[e("input",{onClick:s[1]||(s[1]=n=>t(i).showGore=!t(i).showGore),id:"gore-toggle",type:"checkbox",class:"sr-only peer",checked:t(i).showGore},null,8,Ts),Ls,e("span",Ms,r(l.$t("profile.forms.update.showGoreContent")),1)])])])):le("",!0),e("div",Os,[e("div",null,[c(e("span",{class:"text-success"},r(t(o).settings.loading?l.$t("updating"):l.$t("updated")),513),[[v,t(o).settings.loading||t(o).settings.success]])]),e("button",{type:"submit",class:w(["w-full md:w-auto",t(o).settings.buttonDisabled?"secondary-button pointer-events-none cursor-not-allowed":"primary-button cursor-pointer"])},r(t(o).settings.loading?l.$t("updating"):l.$t("update")),3)])],32)]))}},Bs=ve(Ks,[["__scopeId","data-v-0123a00d"]]);const Rs={class:"modal-layer xl:w-3/12 lg:w-2/5"},Gs={class:"flex flex-col justify-center w-full text-center"},qs={class:"mb-6"},zs={class:"flex flex-row justify-center mb-4 w-full text-base font-bold text-green-500"},Ys={__name:"SuccessMessageModal",props:{message:{type:String,default:"Success"},autoCloseAfterMs:{type:Number,default:2e3}},setup(B){const f=()=>{_e().closeModal("success-modal")};return(A,g)=>(M(),se("div",null,[e("div",Rs,[e("div",Gs,[e("div",qs,[e("div",zs,[y(V,{class:"mr-2 font-bold text-green-400",name:"i-mdi-check-all","text-size":"text-xl"}),te(" "+r(A.$t("success")),1)]),e("p",null,r(B.message),1)]),e("button",{onClick:g[0]||(g[0]=S=>f()),class:"success-button-close"},r(A.$t("close").toUpperCase()),1)])])]))}},Hs=ve(Ys,[["__scopeId","data-v-9730d986"]]);const Ws={class:"w-full"},Js={class:"input-block"},Qs={class:"font-semibold"},Xs={class:"field"},Zs=["readonly","placeholder"],eo={class:"flex flex-row justify-end"},to={class:"input-block"},so={class:"font-semibold"},oo={class:"field"},lo=["readonly","placeholder"],ao={class:"flex flex-row justify-between w-full"},no={__name:"Password",setup(B){const f=de(),{oApiConfiguration:A,fetchOptions:g}=ce(),S=me(A,g()),{t:C}=re(),{$router:I}=pe();fe(()=>{f.loggedIn||I.push("/")});const E=b(""),o=b(""),N=b(!1),i=()=>{E.value="",o.value="",N.value=!1},u=async()=>{N.value=!1,o.value="",n.value="";const[x,_]=await S.checkCurrentPassword({userId:f.user.id,currentPassword:E.value});_?o.value=_:N.value=!0},l=b({settings:{loading:!1,success:!1,buttonDisabled:!1}}),s="update-setting-form",n=b(""),p=b(""),m=()=>{n.value="",p.value=""},k=async()=>{l.value.settings.loading=!0,ie().validate(s,C);const[x,_]=await S.updateCurrentPassword({userId:f.user.id,currentPassword:E.value,newPassword:n.value});_?(l.value.settings.success=!1,p.value=_):(l.value.settings.success=!0,m(),i(),_e().openModal("success-modal")),l.value.settings.loading=!1};return(x,_)=>(M(),se("div",Ws,[e("form",{onSubmit:_[1]||(_[1]=D(U=>u(),["prevent"]))},[e("div",Js,[e("label",Qs,r(x.$t("profile.forms.update.password.currentPasswordLabel")),1),e("div",Xs,[c(e("input",{"onUpdate:modelValue":_[0]||(_[0]=U=>we(E)?E.value=U:null),type:"password",rules:"required|min:6|containNumber|containSymbol",class:w(["form-input input",{"cursor-not-allowed pointer-events-none":t(N)}]),readonly:t(N),placeholder:x.$t("profile.forms.update.password.currentPassword")},null,10,Zs),[[j,t(E)]]),c(e("div",{class:"error-message"},r(t(o)),513),[[v,t(o)!==""]])])]),c(e("div",eo,[e("button",{class:w([t(E)===""?"disabled-button pointer-events-none cursor-not-allowed":"primary-button cursor-pointer"])},r(x.$t("next")),3)],512),[[v,!t(N)]])],32),c(e("form",{id:s,onSubmit:_[3]||(_[3]=D(U=>k(),["prevent"]))},[e("div",to,[e("label",so,r(x.$t("profile.forms.update.password.newPassword")),1),e("div",oo,[c(e("input",{"onUpdate:modelValue":_[2]||(_[2]=U=>we(n)?n.value=U:null),type:"password",rules:"required|min:6|containNumber|containSymbol",class:w(["form-input input",{"cursor-not-allowed pointer-events-none":t(l).settings.loading}]),readonly:t(l).settings.loading,placeholder:x.$t("profile.forms.update.password.newPassword")},null,10,lo),[[j,t(n)]]),c(e("div",{class:"error-message"},r(t(p)),513),[[v,t(p)!==""]])])]),e("div",ao,[e("div",null,[c(e("span",{class:"text-success"},r(t(l).settings.loading?x.$t("updating"):""),513),[[v,t(l).settings.loading||t(l).settings.success]])]),e("button",{type:"submit",class:w(["w-full md:w-auto",t(l).settings.buttonDisabled?"secondary-button pointer-events-none cursor-not-allowed":"primary-button cursor-pointer"])},r(t(l).settings.loading?x.$t("updating"):x.$t("update")),3)])],544),[[v,t(N)]]),y(Hs,{id:"success-modal",class:"modal",message:x.$t("profile.forms.update.password.success"),"auto-close-after-ms":1e3},null,8,["message"])]))}},io=ve(no,[["__scopeId","data-v-bbc1bc3a"]]),ro={class:"flex flex-row w-full"},uo={class:"mr-2 md:mr-4 lg:w-1/5"},co={class:"hidden-lg-flex"},po={class:"hidden-lg-flex"},fo={class:"hidden-lg-flex"},mo={class:"hidden-lg-flex"},vo={class:"hidden-lg-flex"},go={class:"w-full"},Co={__name:"setting",setup(B){const{t:f}=re(),A=b(f("meta.title.profile.profile"));Ae({title:Ie(()=>A.value)});const g=b({currentState:"profile"});Ne(()=>g.value.currentState,C=>{C==="profile"?A.value=f("meta.title.profile.profile"):C==="social"?A.value=f("meta.title.profile.social"):C==="password"?A.value=f("meta.title.profile.password"):A.value=f("meta.title.profile.settings")});const S=C=>{g.value.currentState=C};return(C,I)=>{const E=Ue;return M(),ae(Ve,{"hide-side":!0,"with-footer":!0,"no-right-side":!0},{default:ge(()=>[e("div",ro,[e("div",uo,[y(E,{to:"/profile",class:"mb-6 w-full light-bordered-button"},{default:ge(()=>[y(V,{name:"i-typcn-arrow-back",class:"text-lg text-white lg:mr-2 hover:text-white"}),e("span",co,r(C.$t("settings.backToProfile")),1)]),_:1}),e("div",{class:w(["flex flex-row py-3 px-4 mb-2 font-medium leading-5 rounded ring-offset-2 transition-all duration-200 cursor-pointer left-menu-link parent-icon theme-color hover:button hover:text-white",{"button-color text-white":t(g).currentState==="profile"}]),onClick:I[0]||(I[0]=o=>S("profile"))},[c(y(V,{name:"i-fluent-person-32-regular",class:"text-lg text-white lg:mr-2 hover:text-white"},null,512),[[v,t(g).currentState==="profile"]]),c(y(V,{name:"i-fluent-person-32-regular",class:"text-lg lg:mr-2 hover:text-white"},null,512),[[v,t(g).currentState!=="profile"]]),e("span",po,r(C.$t("settings.profile")),1)],2),e("div",{class:w(["flex flex-row py-3 px-4 mb-2 font-medium leading-5 rounded ring-offset-2 transition-all duration-200 cursor-pointer left-menu-link parent-icon theme-color hover:button hover:text-white",{"button-color text-white":t(g).currentState==="social"}]),onClick:I[1]||(I[1]=o=>S("social"))},[c(y(V,{name:"i-ion-share-social-outline",class:"text-lg text-white lg:mr-2 hover:text-white"},null,512),[[v,t(g).currentState==="social"]]),c(y(V,{name:"i-ion-share-social-outline",class:"text-lg lg:mr-2 hover:text-white"},null,512),[[v,t(g).currentState!=="social"]]),e("span",fo,r(C.$t("settings.social")),1)],2),e("div",{class:w(["flex flex-row py-3 px-4 mb-2 font-medium leading-5 rounded ring-offset-2 transition-all duration-200 cursor-pointer left-menu-link parent-icon theme-color hover:button hover:text-white",{"button-color text-white":t(g).currentState==="password"}]),onClick:I[2]||(I[2]=o=>S("password"))},[c(y(V,{name:"i-material-symbols-key-outline-rounded",class:"text-lg text-white lg:mr-2 hover:text-white"},null,512),[[v,t(g).currentState==="password"]]),c(y(V,{name:"i-material-symbols-key-outline-rounded",class:"text-lg lg:mr-2 hover:text-white"},null,512),[[v,t(g).currentState!=="password"]]),e("span",mo,r(C.$t("settings.password")),1)],2),e("div",{class:w(["flex flex-row py-3 px-4 mb-2 font-medium leading-5 rounded ring-offset-2 transition-all duration-200 cursor-pointer left-menu-link parent-icon theme-color hover:button hover:text-white",{"button-color text-white":t(g).currentState==="settings"}]),onClick:I[3]||(I[3]=o=>S("settings"))},[c(y(V,{name:"i-ph-gear-six",class:"text-lg text-white lg:mr-2 hover:text-white"},null,512),[[v,t(g).currentState==="settings"]]),c(y(V,{name:"i-ph-gear-six",class:"text-lg lg:mr-2 hover:text-white"},null,512),[[v,t(g).currentState!=="settings"]]),e("span",vo,r(C.$t("settings.settings")),1)],2)]),e("div",go,[t(g).currentState==="profile"?(M(),ae(xt,{key:0})):le("",!0),t(g).currentState==="social"?(M(),ae(xs,{key:1})):le("",!0),t(g).currentState==="settings"?(M(),ae(Bs,{key:2})):le("",!0),t(g).currentState==="password"?(M(),ae(io,{key:3})):le("",!0)])])]),_:1})}}};export{Co as default};
