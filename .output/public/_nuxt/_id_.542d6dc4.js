import{j as M,a as R,k as W,I as G,m as L,r as _,a1 as K,o as u,p as v,q as t,s as g,t as i,e as f,w as N,b as p,v as m,u as e,K as U,F as Q,T as H,x as I,L as J,c as j,G as X,y as Z,M as P,N as z,l as tt,Y as et,P as st,Q as ot}from"./entry.e86746f3.js";import{u as O}from"./nuxt-img.978eb1b8.js";import{L as at}from"./Layout.04566d95.js";import{v as it}from"./vue3-editor.common.0d385de4.js";import{S as D}from"./Spinner.cfab8439.js";import{_ as Y}from"./_plugin-vue_export-helper.a1a6add7.js";const T=n=>(P("data-v-a8627738"),n=n(),z(),n),nt={class:"mb-4 text-base font-bold"},lt={class:"text-xs italic font-bold href"},rt={class:"alert-success"},ct={class:"italic"},dt={class:"flex flex-row p-2 mb-6 text-white rounded-md button-color"},ut=["onSubmit"],pt={class:"input-block"},_t=["placeholder"],ht={class:"input-block -mt-2"},mt={class:"input-block"},ft={class:"input-block"},vt={class:"mb-4"},wt=["for"],kt=T(()=>t("span",{class:"block w-10 h-6 bg-gray-300 rounded-full shadow-inner"},null,-1)),gt={key:0,class:"block absolute inset-y-0 left-0 mt-1 ml-1 w-4 h-4 bg-white rounded-full shadow transition-transform duration-300 ease-in-out focus-within:shadow-outline"},yt=T(()=>t("input",{id:"unchecked",type:"checkbox",class:"absolute w-0 h-0 opacity-0"},null,-1)),bt=[yt],xt={key:1,class:"block absolute inset-y-0 left-0 mt-1 ml-1 w-4 h-4 rounded-full shadow transition-transform duration-300 ease-in-out transform translate-x-full focus-within:shadow-outline button-color"},$t=T(()=>t("input",{id:"checked",type:"checkbox",class:"absolute w-0 h-0 opacity-0"},null,-1)),Et=[$t],It={class:"ml-2"},Ct={class:"flex flex-row p-2 mt-2 text-white bg-red-400 rounded"},Vt={class:"flex flex-row"},St={__name:"UpdateForm",props:{id:{type:String,default:""}},setup(n){const w=n,C=M(),{$router:b}=R(),{oApiConfiguration:x,fetchOptions:V}=W(),$=O(x,V()),S=G().public.apiUrl;L(()=>{C.loggedIn||b.push("/"),A()});const l=_(!1),A=async()=>{const[o,a]=await $.getWorkById(w.id);a?l.value=!0:(s.value.title=o.title,s.value.description=o.description.split("<br><br>").join(` 
`).split("<br>").join(""),o.artwork_has_tags.forEach(k=>{r.value.push({key:k.artwork_tags.id,value:k.artwork_tags.tag})}),s.value.isExplicit=!!o.is_explicit)},s=_({title:"",description:"",tags:"",isExplicit:!1}),r=_([]),c=_(!1),h=_(!1),F=_(!1),q=async()=>{const o=[];r.value.forEach(a=>{o.push(a.value)}),c.value=!0,h.value=!1;try{const a=[];r.value.forEach(d=>{a.push(d.value)});const[k,B]=await $.updateInfo({id:w.id,title:s.value.title,description:s.value.description,isExplicit:s.value.isExplicit,tags:a.toString()});B?F.value=!0:(h.value=!0,setTimeout(()=>{b.push(`/a/${w.id}`)},1e3))}catch{F.value=!0}c.value=!1};return(o,a)=>{const k=Z,B=K("tags-input");return u(),v("div",null,[t("div",nt,[g(i(o.$t("artworks.update.form.title"))+" ",1),t("span",lt,[f(k,{to:"/a/"+n.id},{default:N(()=>[g(" (ID: "+i(n.id)+") ",1)]),_:1},8,["to"])])]),p(t("div",{class:"alert-danger"},i(o.$t("artworks.update.form.fetchFailure")),513),[[m,e(l)]]),p(t("div",rt,[g(i(o.$t("artworks.update.form.updated"))+" ",1),t("span",ct,i(o.$t("artworks.update.form.successRedirect")),1)],512),[[m,e(h)]]),p(t("div",dt,[f(D,{class:"mr-1"}),g(" "+i(o.$t("saving")),1)],512),[[m,e(c)]]),p(t("div",{class:"alert-danger"},i(o.$t("artworks.add.form.uploadFailure")),513),[[m,e(F)]]),p(t("form",{enctype:"multipart/form-data",onSubmit:X(q,["prevent"])},[t("div",pt,[p(t("input",{"onUpdate:modelValue":a[0]||(a[0]=d=>e(s).title=d),type:"text",class:U(["form-input input",{"pointer-events-none cursor-not-allowed":e(c)||e(h)}]),placeholder:o.$t("title")},null,10,_t),[[Q,e(s).title]])]),t("div",ht,[f(e(it.exports.VueEditor),{modelValue:e(s).description,"onUpdate:modelValue":a[1]||(a[1]=d=>e(s).description=d),editorToolbar:[[{size:["normal","large"]}],["bold","italic","underline","strike"],["link"],[{color:[]},{background:[]}],["clean"]],class:U([{"pointer-events-none cursor-not-allowed":e(c)||e(h)}]),placeholder:o.$t("description")},null,8,["modelValue","class","placeholder"])]),t("div",mt,[f(B,{modelValue:e(r),"onUpdate:modelValue":a[2]||(a[2]=d=>H(r)?r.value=d:null),placeholder:o.$t("tagsInputPlaceholder"),typeahead:!0,"typeahead-style":"dropdown","typeahead-activation-threshold":2,"typeahead-show-on-focus":!0,"typeahead-hide-discard":!0,"typeahead-url":e(S)+"/artworks/tags/search?keyword=:search","add-tags-on-comma":!0},null,8,["modelValue","placeholder","typeahead-url"])]),t("div",ft,[t("div",vt,[t("label",{for:e(s).isExplicit?"unchecked":"checked",class:"inline-flex items-center mt-2"},[t("span",{class:"relative cursor-pointer",onClick:a[3]||(a[3]=d=>e(s).isExplicit=!e(s).isExplicit)},[kt,e(s).isExplicit?I("",!0):(u(),v("span",gt,bt)),e(s).isExplicit?(u(),v("span",xt,Et)):I("",!0)]),t("span",It,i(o.$t("explicitContent")),1)],8,wt),p(t("div",Ct,[f(J,{name:"alert-outline",class:"mr-1 text-white"}),t("span",null,i(o.$t("artworks.add.form.prohibitChildExplicitContent")),1)],512),[[m,e(s).isExplicit]])])]),t("button",{class:U(["float-right primary-button",{"pointer-events-none cursor-not-allowed":e(c)||e(h)}])},[t("div",Vt,[e(c)?(u(),j(D,{key:0,class:"mr-1"})):I("",!0),g(" "+i(e(c)?o.$t("saving"):o.$t("save")),1)])],2)],40,ut),[[m,!e(l)]])])}}},At=Y(St,[["__scopeId","data-v-a8627738"]]);const y=n=>(P("data-v-88c4c5cc"),n=n(),z(),n),Ft=y(()=>t("h1",{class:"mb-3 text-base font-bold"},"Current Info",-1)),Bt={class:"mt-2"},Ut=y(()=>t("label",{class:"italic font-medium text-color-secondary"},"Title",-1)),Nt={class:"mt-2"},Tt=y(()=>t("label",{class:"italic font-medium text-color-secondary"},"Explicit",-1)),Dt={key:0,class:"mt-2"},Mt=y(()=>t("label",{class:"italic font-medium text-color-secondary"},"Tags",-1)),Rt={class:"tags"},Wt={class:"mt-2"},Lt=y(()=>t("label",{class:"italic font-medium text-color-secondary"},"Publish Date",-1)),jt={__name:"[id]",setup(n){const w=M(),{oApiConfiguration:C,fetchOptions:b}=W(),x=O(C,b()),{$router:V}=R(),$=tt(),{id:E}=V.currentRoute.value.params;et(async()=>{await S()}),L(()=>{A()});const S=async()=>{const[s,r]=await x.getWorkById(E);(s.user_id!==w.user.id||r)&&$.push({path:"/"})},l=_({}),A=async()=>{try{const[s,r]=await x.getWorkById(E);r||(l.value=s)}catch{}};return(s,r)=>(u(),j(at,{"with-footer":!0,"h-screen":!0},{"right-side":N(()=>[Ft,t("div",Bt,[Ut,t("p",null,i(e(l).title),1)]),t("div",Nt,[Tt,t("p",null,i(e(l).is_explicit?"Yes":"No"),1)]),e(l).artwork_has_tags&&e(l).artwork_has_tags.length?(u(),v("div",Dt,[Mt,t("div",Rt,[(u(!0),v(st,null,ot(e(l).artwork_has_tags,c=>(u(),v("span",{key:c.artwork_tags.id,class:"tag"},i(c.artwork_tags.tag),1))),128))])])):I("",!0),t("div",Wt,[Lt,t("p",null,i(s.formatDate(e(l).scheduled_post)),1)])]),default:N(()=>[f(e(At),{id:e(E)},null,8,["id"])]),_:1}))}},Kt=Y(jt,[["__scopeId","data-v-88c4c5cc"]]);export{Kt as default};
