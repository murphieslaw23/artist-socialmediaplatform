import{z as V,k as W,p as B,m as E,K as O,r as g,H as F,L as I,o as $,q as z,b as s,t as v,u as e,c as k,x as P,f as m,W as N,N as w,I as y,l as q,h as T,a1 as M,w as U,e as p,v as c,Q as x}from"./entry.e59d1677.js";import{a as D,u as H,L as Q}from"./Layout.38bbd337.js";import{A as Y}from"./ArtworkForm.74927cd1.js";import{u as j}from"./useFeed.6f185801.js";import{q as G,v as J}from"./vue3-editor.common.410ae174.js";import{S as X}from"./ProBadge.e613df9a.js";import{P as d}from"./index.6cdba04a.js";import{_ as Z}from"./_plugin-vue_export-helper.a1a6add7.js";import"./useSetting.3e22411d.js";const ee={class:"title"},te=["name"],se={class:"relative"},oe={class:"text-left-counter"},ae={class:"buttons"},ie=V({__name:"FeedForm",setup(K){const{oApiConfiguration:h,fetchOptions:f}=W(),R=j(h,f());B(()=>{var t;(t=document.getElementById(l))==null||t.getElementsByClassName("ql-editor")[0]});const o=E(),{t:_}=O(),l="feed-form",n=g(null),r=g(""),b=2e3,A=g(1),L=F(()=>{if(n)return b-(A.value-1)});I(()=>r.value,(t,a)=>{A.value=n.value.getLength(),n.value.getLength()>b&&n.value.deleteText(b,n.value.getLength())});const i=g({isPosting:!1,isPosted:!1,isError:!1}),C=async()=>{H().validate(l,_),i.value.isPosting=!0;const[t,a,u]=await R.postFeed({text:r.value,visibility:"public",whoCanReply:"public"});if(u)i.value.isError=!0;else{i.value={isPosting:!1,isPosted:!0,isError:!1};const S=a.id;setTimeout(()=>{o.push(`/feed/${S}`)},1e3)}i.value.isPosting=!1};return(t,a)=>($(),z("section",null,[s("h2",ee,v(t.$t("feeds.form.title")),1),s("form",{id:l,onSubmit:a[4]||(a[4]=w(u=>C(),["prevent"]))},[e(i).isPosting|e(i).isError|e(i).isPosted?($(),k(D,{key:0,"is-loading":e(i).isPosting,"loading-message":t.$t("feeds.form.postingYourUpdate"),"is-success":e(i).isPosted,"success-message":`${t.$t("feeds.form.posted")} ${t.$t("feeds.form.successRedirect")}`,"is-error":e(i).isError,"error-message":t.$t("feeds.form.postFailure")},null,8,["is-loading","loading-message","is-success","success-message","is-error","error-message"])):P("",!0),s("n-validate",{for:"text",name:t.$t("feeds.form.feed")},[m(e(J.exports.VueEditor),{modelValue:e(r),"onUpdate:modelValue":a[0]||(a[0]=u=>N(r)?r.value=u:null),"editor-toolbar":e(G),placeholder:t.$t("typeSomething"),onReady:a[1]||(a[1]=u=>n.value=u)},null,8,["modelValue","editor-toolbar","placeholder"])],8,te),s("div",se,[s("div",oe,v(e(L)),1)]),s("div",ae,[s("button",{type:"reset",class:"reset",onClick:a[2]||(a[2]=w(u=>r.value="",["prevent"]))},v(t.$t("reset")),1),s("button",{class:y(["submit",{"!disabled-button":!e(r)}]),onClick:a[3]||(a[3]=w(u=>e(r)!==""?C():null,["prevent"]))},[t.posting?($(),k(X,{key:0})):P("",!0),s("span",null,v(t.posting?t.$t("posting"):t.$t("post").toUpperCase()),1)],2)])],32)]))}});const le={class:"mb-20"},ne={class:"categories"},re={class:"text-sm leading-6"},ue={class:"text-sm leading-6"},de={class:"forms"},me={__name:"index",setup(K){const h=q(),{t:f}=O(),R=E(),o=g(d.ARTWORK);return T({title:o.value===d.ARTWORK?f("meta.title.artwork.post"):f("meta.title.feed.post")}),I(()=>o.value,()=>{T({title:o.value===d.ARTWORK?f("meta.title.artwork.post"):f("meta.title.feed.post")})}),M(()=>{h.loggedIn||R.push("/explore")}),(_,l)=>($(),k(Q,{"with-footer":!0,"hide-side":!1},{default:U(()=>[s("div",le,[s("div",ne,[s("div",{class:y(["category",[e(o)==="feed"?"button":"theme-color"]]),onClick:l[0]||(l[0]=n=>o.value="feed")},[p(m(x,{name:"i-ion-text-outline","text-size":"texl-xl",class:"mr-3 text-2xl"},null,512),[[c,e(o)!="feed"]]),p(m(x,{name:"i-ion-text-outline","text-size":"texl-xl",class:"mr-3 text-2xl text-white"},null,512),[[c,e(o)=="feed"]]),s("span",re,v(_.$t("feed")),1)],2),s("div",{class:y(["category",[e(o)===e(d).ARTWORK?"button":"theme-color"]]),onClick:l[1]||(l[1]=n=>o.value=e(d).ARTWORK)},[p(m(x,{name:"i-ion-images-outline","text-size":"texl-xl",class:"mr-3 text-2xl"},null,512),[[c,e(o)!=e(d).ARTWORK]]),p(m(x,{name:"i-ion-images-outline","text-size":"texl-xl",class:"mr-3 text-2xl text-white"},null,512),[[c,e(o)==e(d).ARTWORK]]),s("span",ue,v(_.$t("artworks.artwork")),1)],2)]),s("div",de,[p(m(ie,null,null,512),[[c,e(o)==="feed"]]),p(m(Y,{class:"artwork"},null,512),[[c,e(o)===e(d).ARTWORK]])])])]),_:1}))}},Re=Z(me,[["__scopeId","data-v-563b4675"]]);export{Re as default};
