import{o as r,p as c,j as se,Z as ie,k as le,f as ae,I as re,l as ne,O as ce,a as de,Y as ue,m as pe,E as _e,r as v,c as H,e as s,w as n,a0 as he,b as x,v as g,u as _,q as t,Q as me,P as ke,L as w,t as a,s as h,H as f,x as d,G as b,K as C,M as ve,N as we,y as fe}from"./entry.e86746f3.js";import{u as xe,J as ge,_ as ye}from"./nuxt-img.978eb1b8.js";import{a as be}from"./useFeed.1ec68f4a.js";import{u as Me}from"./useI18n.e4d2cde3.js";import{S as Ce,M as $e,a as Ie,u as Se,b as Le,c as Ae}from"./ModalView.e487b658.js";import{u as Fe}from"./WorkList.0bfb6f77.js";import{L as Te}from"./Layout.04566d95.js";import{F as Re,I as F}from"./FeedModalView.d23479c0.js";import{_ as j}from"./_plugin-vue_export-helper.a1a6add7.js";import"./useReport.24d86f53.js";import"./LoadingEmptyErrorMessage.30f12734.js";import"./Spinner.cfab8439.js";import"./user-counters-api.1e743ca3.js";const Ee={};function Ve(I,y){return r(),c("div")}const He=j(Ee,[["render",Ve]]);const $=I=>(ve("data-v-d38bc602"),I=I(),we(),I),Be={class:"mx-auto w-full"},Ne={class:"grid grid-cols-1 gap-1 mx-auto md:gap-2 xl:w-10/12"},Oe={class:"flex flex-row rounded-md theme-color"},Pe={class:"w-full"},De={key:0,class:"p-2 md:p-4 user-info"},Ue=["src"],ze={class:"name"},Ge=$(()=>t("br",null,null,-1)),je=$(()=>t("span",{class:"mx-1"},"\xB7",-1)),qe={key:1,class:"px-2 mt-2 md:px-4"},Ke={class:"text-xs font-semibold"},Je=["id","innerHTML"],Qe=["id","onClick"],We=["onClick"],Ye={key:2,class:"px-2 md:px-4"},Ze=["innerHTML","id"],Xe=["id","onClick"],eo={key:1,class:"my-2 w-full rounded-md theme-color-secondary"},oo={key:0,class:"p-2 md:p-4 user-info"},to=["src"],so={class:"name"},io=$(()=>t("br",null,null,-1)),lo=$(()=>t("span",{class:"mx-1"},"\xB7",-1)),ao={class:"px-2 mt-2 md:px-4"},ro={class:"text-xs font-semibold"},no=["id","innerHTML"],co=["id","onClick"],uo=["onClick"],po={key:0,class:"p-2 mx-auto w-full text-center rounded-md opacity-90 theme-color"},_o={class:"mx-auto mt-2 primary-button"},ho={key:0,class:"p-2 mx-auto w-full text-center rounded-md opacity-90 theme-color"},mo={class:"mx-auto mt-2 primary-button"},ko={class:"float-right mx-4 mt-2 interactions"},vo={key:0,class:"reactions"},wo=["onClick"],fo=["onClick"],xo=["onClick"],go={class:"option dropdown"},yo={type:"button","aria-haspopup":"true","aria-expanded":"true","aria-controls":"option-dropdown-items"},bo={class:"option-dropdown dropdown-menu"},Mo={id:"option-dropdown-items",class:"w-52 toggler","aria-labelledby":"option-dropdown-buttons",role:"menu"},Co={class:"menu-wrapper"},$o=$(()=>t("div",{class:"custom-divider"},null,-1)),Io=["onClick"],So={class:"mx-auto text-center"},Lo={class:"mx-auto text-center"},Ao={class:"mx-auto text-center"},Fo=$(()=>t("br",null,null,-1)),To={id:"chronological-modal",class:"modal work-view"},Ro={id:"chronological-feed-modal",class:"z-30 modal work-view"},Eo={__name:"index",props:{changeMode:{type:Function,default:()=>{}}},setup(I){const y=se(),{generateArtworkThumb:q}=ie(),{oApiConfiguration:B,fetchOptions:N}=le(),O=xe(B,N()),T=be(B,N());ae({title:Me().tl("meta.title.feed.feed")});const K=re(),J=ne(),Q=ce();de(),ue(()=>{y.loggedIn||J.push({path:"/explore"})}),pe(()=>{}),_e(()=>Q.query,()=>{ee(),f().closeModal("feed-collection-selection-modal"),f().closeModal("collection-selection-modal"),f().closeModal("album-selection-modal"),f().closeModal("report-modal")});const S=v({explicitMode:void 0,pagination:{page:0,perPage:10}}),R=v([]),W=async({loaded:o})=>{const[l,i]=await T.getChronologicalFeeds({explicitMode:S.value.explicitMode,pagination:{page:S.value.pagination.page,perPage:S.value.pagination.perPage}});S.value.pagination.page+=1;for(let u=0;u<l.feeds.length;u++){const e=l.feeds[u];if(e.liked&&(e.type==="artwork"?k.value.push("a-"+e.id):k.value.push("f-"+e.id)),e.images=[],e.apply_explicit_filter=!1,e.type==="artwork"||e.type==="feed"&&e.artwork_share_info!=null){e.type==="artwork"&&e.saved&&M.value.push(e.id);for(let m=0;m<e.artwork_assets.length;m++)if(m<=3){const p=await q(e.artwork_assets[m].bucket,e.artwork_assets[m].filename,"feed");e.images.push(p)}e.artwork_share_info!=null&&(!y.loggedIn&&e.artwork_share_info.is_explicit||e.artwork_share_info.is_explicit&&!y.user.user_settings.show_explicit)&&(e.apply_explicit_filter=!0)}R.value.push(e)}o(l.feeds.length,S.value.pagination.perPage)},P=v(null),A=(o,l,i)=>{l?R.value[i].apply_explicit_filter=!1:(P.value.view(o),f().openModal("chronological-modal"))},D=v(null),Y=o=>{D.value.view(o),f().openModal("chronological-feed-modal")},E=(o,l,i,u)=>{Le().readMore(o,l,i,u)},U=v(!1);let Z;const X=o=>{const l=v(K.public.appUrl+o),{copy:i}=Fe({source:l});i(),Ae().splash(Z,U,"copy-alert")},M=v([]),k=v([]),z=async(o,l)=>{const i=parseInt(o.split("-")[1]);let u=!1;if(l==="artwork"){const[e,m]=await O.like({workId:i});u=e}else if(l==="feed"){const[e,m]=await T.like({feedId:i});u=e}if(u){k.value.push(o);const e=document.getElementById(`feed-like-button-${l}-${i}`);e.classList.add("animate-bounce"),setInterval(()=>{e.classList.remove("animate-bounce")},2500)}},G=async(o,l)=>{const i=parseInt(o.split("-")[1]);let u=!1;if(l==="artwork"){const[e,m]=await O.unlike({workId:i});u=e}else if(l==="feed"){const[e,m]=await T.unlike({feedId:i});u=e}if(u){const e=k.value.indexOf(o);k.value.splice(e,1)}},ee=()=>{f().closeModal("chronological-modal"),f().closeModal("chronological-feed-modal")},V=v(null),L=v(0),oe=o=>{L.value=o,f().openModal("feed-collection-selection-modal"),V.value.fetchCollection(),V.value.fetchCurrentSaved()},te=o=>{if(o){const l=M.value.indexOf(L.value);M.value.splice(l,1)}else M.value.push(L.value);Se().animate("save-to-collection-button-"+L.value)};return(o,l)=>{const i=fe,u=ye;return r(),H(he,null,[s(Te,{"with-footer":!0,"hide-side":o.isMobile()},{"right-side":n(()=>[s(He)]),default:n(()=>[x(s(Ce,{id:"copy-alert",text:o.$t("linkCopied"),icon:"i-bi-check-all"},null,8,["text"]),[[g,_(U)]]),t("div",Be,[t("div",Ne,[(r(!0),c(ke,null,me(_(R),(e,m)=>(r(),c("div",{key:e.id+e.type,class:"rounded-md lg:mx-6"},[t("div",Oe,[t("div",Pe,[e.users?(r(),c("div",De,[s(i,{to:"/profile/"+e.users.username},{default:n(()=>[t("img",{class:"avatar",src:o.avatarCoverUrl(e.users.avatar_bucket,e.users.avatar_filename),onError:l[0]||(l[0]=(...p)=>o.imageLoadError&&o.imageLoadError(...p))},null,40,Ue)]),_:2},1032,["to"]),t("div",ze,[s(i,{to:"/profile/"+e.users.username,class:"fullname hover:href"},{default:n(()=>[h(a(e.users.name),1)]),_:2},1032,["to"]),Ge,s(i,{to:"/profile/"+e.users.username,class:"hover:underline text-xxs"},{default:n(()=>[h(" @"+a(e.users.username),1)]),_:2},1032,["to"]),je,s(i,{to:(e.type==="artwork"?"/a/":"/feed/")+e.id,class:"hover:underline text-xxs"},{default:n(()=>[h(a(o.formatDate(e.scheduled_post?e.scheduled_post:e.created_at,!0)),1)]),_:2},1032,["to"])])])):d("",!0),e.type==="artwork"?(r(),c("div",qe,[t("span",Ke,a(e.title),1),x(t("p",null,[t("span",{id:"feed-description-"+e.id,innerHTML:e.description.length>300?`${e.description.slice(0,300)}...`:e.description},null,8,Je),e.description.length>300?(r(),c("a",{key:0,id:"feed-read-more-"+e.id,class:"href",onClick:b(p=>E(e.description,e.id,"feed-read-more-","feed-description-"),["prevent"])},a(o.$t("readMore")),9,Qe)):d("",!0)],512),[[g,e.description]])])):d("",!0),t("div",null,[t("div",null,[e.type==="artwork"&&!o.isMobile()?(r(),c("div",{key:0,class:"cursor-pointer",onClick:b(p=>A(e.id),["prevent"])},[s(F,{class:"p-2 md:p-4",work:e},null,8,["work"])],8,We)):d("",!0),e.type==="artwork"&&o.isMobile()?(r(),H(i,{key:1,to:"/a/"+e.id,class:"cursor-pointer"},{default:n(()=>[s(F,{class:"p-2",work:e},null,8,["work"])]),_:2},1032,["to"])):d("",!0)])]),e.type==="feed"?(r(),c("div",Ye,[x(t("p",{innerHTML:e.text.split("<br>").length>3&&e.text.length>300?`${e.text.slice(0,300)}...`:e.text,id:"feed-text-"+e.id,class:C(["mt-2",{"mb-2":!e.artwork_share_info}])},null,10,Ze),[[g,e.text]]),e.text.split("<br>").length>3&&e.text.length>300?(r(),c("a",{key:0,id:"feed-read-more-"+e.id,class:"href",onClick:b(p=>E(e.text,e.id,"feed-read-more-","feed-text-"),["prevent"])},a(o.$t("readMore")),9,Xe)):d("",!0),e.artwork_share_info?(r(),c("div",eo,[e.artwork_share_info.user?(r(),c("div",oo,[s(i,{to:"/profile/"+e.artwork_share_info.user.username},{default:n(()=>[t("img",{class:"avatar",src:o.avatarCoverUrl(e.artwork_share_info.user.avatar_bucket,e.artwork_share_info.user.avatar_filename),onError:l[1]||(l[1]=(...p)=>o.imageLoadError&&o.imageLoadError(...p))},null,40,to)]),_:2},1032,["to"]),t("div",so,[s(i,{to:"/profile/"+e.artwork_share_info.user.username,class:"fullname hover:href"},{default:n(()=>[h(a(e.artwork_share_info.user.name),1)]),_:2},1032,["to"]),io,s(i,{to:"/profile/"+e.artwork_share_info.user.username,class:"hover:underline text-xxs"},{default:n(()=>[h(" @"+a(e.artwork_share_info.user.username),1)]),_:2},1032,["to"]),lo,s(i,{to:"/a/"+e.artwork_share_info.id,class:"hover:underline text-xxs"},{default:n(()=>[h(a(o.formatDate(e.artwork_share_info.scheduled_post?e.artwork_share_info.scheduled_post:e.artwork_share_info.created_at,!0)),1)]),_:2},1032,["to"])])])):d("",!0),t("div",ao,[t("span",ro,a(e.artwork_share_info.title),1),x(t("p",null,[t("span",{id:"feed-description-"+e.artwork_share_info.id,innerHTML:e.artwork_share_info.description.length>300?`${e.artwork_share_info.description.slice(0,300)}...`:e.artwork_share_info.description},null,8,no),e.artwork_share_info.description.length>300?(r(),c("a",{key:0,id:"feed-read-more-"+e.artwork_share_info.id,class:"href",onClick:b(p=>E(e.artwork_share_info.description,e.artwork_share_info.id,"feed-read-more-","feed-description-"),["prevent"])},a(o.$t("readMore")),9,co)):d("",!0)],512),[[g,e.artwork_share_info.description]])]),t("div",null,[o.isMobile()?d("",!0):(r(),c("div",{key:0,class:C(["p-2",{"cursor-pointer":!e.apply_explicit_filter}]),onClick:b(p=>A(e.artwork_share_info.id,e.apply_explicit_filter,m),["prevent"])},[t("div",{class:C(["overflow-hidden relative p-2 rounded-md",{"md:mx-2":e.apply_explicit_filter}])},[s(F,{class:C([{"blur-3xl unclickable":e.apply_explicit_filter},e.apply_explicit_filter?"brightness-50":"brightness-100"]),work:e},null,8,["class","work"]),e.apply_explicit_filter?(r(),c("div",po,[t("div",null,a(_(y).loggedIn?o.$t("explicitContentAlert"):o.$t("explicitContentAlertForGuest")),1),t("button",_o,a(o.$t("explicitShowMeThisContent")),1)])):d("",!0)],2)],10,uo)),o.isMobile()?(r(),H(i,{key:1,to:e.apply_explicit_filter?null:"/a/"+e.artwork_share_info.id,onClick:b(p=>A(e.artwork_share_info.id,e.apply_explicit_filter,m),["prevent"]),class:"cursor-pointer"},{default:n(()=>[t("div",{class:C(["overflow-hidden relative p-2 rounded-md",{"m-2":e.apply_explicit_filter}])},[s(F,{class:C([{"blur-3xl unclickable":e.apply_explicit_filter},e.apply_explicit_filter?"brightness-50":"brightness-100"]),work:e},null,8,["class","work"]),e.apply_explicit_filter?(r(),c("div",ho,[t("div",null,a(_(y).loggedIn?o.$t("explicitContentAlert"):o.$t("explicitContentAlertForGuest")),1),t("button",mo,a(o.$t("explicitShowMeThisContent")),1)])):d("",!0)],2)]),_:2},1032,["to","onClick"])):d("",!0)])])):d("",!0)])):d("",!0),t("div",ko,[_(y).loggedIn?(r(),c("div",vo,[t("span",{onClick:p=>e.type==="artwork"?_(k).includes("a-"+e.id)?G("a-"+e.id,e.type):z("a-"+e.id,e.type):_(k).includes("f-"+e.id)?G("f-"+e.id,e.type):z("f-"+e.id,e.type)},[x(s(w,{id:"feed-like-button-"+e.type+"-"+e.id,name:"i-ion-heart",class:"mr-1 text-red-500 hover:text-red-500"},null,8,["id"]),[[g,e.type==="artwork"?_(k).includes("a-"+e.id):_(k).includes("f-"+e.id)]]),x(s(w,{name:"i-ri-heart-3-line",class:"mr-1 icon-color hover:text-red-500"},null,512),[[g,e.type==="artwork"?!_(k).includes("a-"+e.id):!_(k).includes("f-"+e.id)]]),h(" "+a(o.thousand(e._count.likes)),1)],8,wo),t("span",{onClick:b(p=>e.type==="artwork"?A(e.id):Y(e.id),["prevent"])},[s(w,{name:"i-mdi-comment-multiple-outline",class:"mr-1 icon-color hover:text-blue-500"}),h(" "+a(o.thousand(e._count.comments)),1)],8,fo),e.type==="artwork"?(r(),c("span",{key:0,onClick:p=>oe(e.id)},[x(s(w,{id:"save-to-collection-button-"+e.id,name:"i-ion-bookmark",class:"text-blue-500 hover:text-blue-500"},null,8,["id"]),[[g,_(M).includes(e.id)]]),x(s(w,{name:"i-majesticons-bookmark-line",class:"icon-color hover:text-blue-500"},null,512),[[g,!_(M).includes(e.id)]])],8,xo)):d("",!0),t("div",go,[t("button",yo,[t("span",null,[s(w,{name:"i-uit-ellipsis-v",class:"align-middle icon icon-color"})])]),t("div",bo,[t("div",Mo,[t("div",Co,[s(i,{to:e.type==="artwork"?"/a/"+e.id:"/feed/"+e.id,class:"flex py-2 px-3 w-full rounded-md transition-all duration-150 hover:button-color parent-icon hover:text-white"},{default:n(()=>[s(w,{name:"i-fluent-arrow-enter-20-filled",class:"mr-2 text-base"}),h(" "+a(o.$t("open")),1)]),_:2},1032,["to"]),s(i,{to:e.type==="artwork"?"/a/"+e.id:"/feed/"+e.id,target:"_blank",class:"flex z-20 py-2 px-3 w-full rounded-md transition-all duration-150 hover:button-color parent-icon hover:text-white"},{default:n(()=>[s(w,{name:"i-ci-external-link",class:"mr-2 text-base"}),h(" "+a(o.$t("openInNewTab")),1)]),_:2},1032,["to"]),$o,t("a",{class:"flex py-2 px-3 w-full leading-4 rounded-md transition-all duration-150 cursor-pointer hover:button-color parent-icon hover:text-white",onClick:p=>X(e.type==="artwork"?"/a/"+e.id:"/feed/"+e.id)},[s(w,{name:"i-icon-park-outline-copy",class:"mr-2 text-base"}),h(" "+a(o.$t("copySharableLink")),1)],8,Io)])])])])])):d("",!0)])])])]))),128)),s(u,null,{default:n(()=>[s(_(ge),{class:"mt-6",load:W},{loading:n(()=>[t("div",So,[s(w,{name:"i-line-md-loading-twotone-loop",class:"text-3xl"})])]),"no-results":n(()=>[t("div",Lo,a(o.$t("feeds.nothingToShow")),1)]),"no-more":n(()=>[t("div",Ao,[h(a(o.$t("youHaveReachedTheEnd"))+" ",1),Fo,h(" "+a(o.$t("feeds.followMorePeople")),1)])]),_:1})]),_:1}),t("div",To,[s($e,{ref_key:"chronologicalModalViewRef",ref:P,section:"chronological"},null,512)]),t("div",Ro,[s(Re,{ref_key:"chronologicalFeedModalViewRef",ref:D,section:"chronological-feed"},null,512)]),s(Ie,{id:"feed-collection-selection-modal","modal-id":"feed-collection-selection-modal",ref_key:"collectionSelectionModalRef",ref:V,"work-id":_(L),class:"modal",onSave:te},null,8,["work-id"])])])]),_:1},8,["hide-side"])],1024)}}},Jo=j(Eo,[["__scopeId","data-v-d38bc602"]]);export{Jo as default};
