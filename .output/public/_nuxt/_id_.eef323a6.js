import{k as N,j as T,a as W,I as z,m as D,r as g,a1 as K,o as i,p as x,q as o,s as $,t as r,e as S,w as j,b as m,v as C,u as t,K as p,F as P,T as H,G as k,c as n,L as c,x as I,y as J,M as Q,N as X,l as Z,Y as ee}from"./entry.ed1bfc63.js";import{u as q}from"./ProBadge.dc1cf83d.js";import{L as te}from"./Layout.c894869a.js";import{q as oe,v as se}from"./text-editor.47d3431a.js";import{S as U}from"./Spinner.bfc0b0e5.js";import{_ as ae}from"./_plugin-vue_export-helper.a1a6add7.js";const re=d=>(Q("data-v-26819de6"),d=d(),X(),d),ie={class:"mb-4 text-base font-bold"},le={class:"text-xs italic font-bold href"},ne={class:"alert-success"},ce={class:"italic"},de={class:"flex flex-row p-2 mb-6 text-white rounded-md button-color"},ue=["onSubmit"],pe={class:"input-block"},ge=["placeholder"],_e={class:"-mt-2 input-block"},ve={class:"input-block"},he={class:"grid grid-cols-1 gap-2 input-block md:grid-cols-3"},fe={class:"toggler-box__icons"},me={class:"toggler-box__description"},ke={class:"toggler-box__icons"},we={class:"toggler-box__description"},ye=re(()=>o("b",null,"Contain Gore",-1)),be={class:"grid grid-cols-1 gap-2 md:grid-cols-3 input-block"},xe={class:"toggler-box__icons"},$e={class:"toggler-box__description"},Ce={class:"toggler-box__icons"},Ie={class:"toggler-box__description"},Se={class:"toggler-box__icons"},Ee={class:"toggler-box__description"},Me={class:"flex flex-row"},Re={__name:"UpdateForm",props:{id:{type:String,default:""}},setup(d){const w=d,V=N(),{oApiConfiguration:O,fetchOptions:E}=T(),M=q(O,E()),{$router:R}=W(),G=z().public.apiUrl;D(()=>{V.loggedIn||R.push("/"),_()});const y=g(!1),v=g({}),_=async()=>{const[s,a]=await M.getWorkById(w.id);a?y.value=!0:(v.value=s,e.value.title=s.title,e.value.description=s.description.split("<br><br>").join(` 
`).split("<br>").join(""),e.value.isExplicit=!!s.is_explicit,e.value.isGore=!!s.is_gore,e.value.isOriginalCharacter=!!s.is_original_character,e.value.isAllowRedraw=!!s.allow_redraw,e.value.isRedrawInMyStyle=!!s.redraw_in_your_style,s.artwork_has_tags.forEach(b=>{h.value.push({key:b.artwork_tags.id,value:b.artwork_tags.tag})}))},e=g({title:"",description:"",tags:"",isExplicit:!1,isGore:!1,isOriginalCharacter:!1,isAllowRedraw:!1,isRedrawInMyStyle:!1}),h=g([]),u=g(!1),f=g(!1),B=g(!1),L=async()=>{const s=[];h.value.forEach(a=>{s.push(a.value)}),u.value=!0,f.value=!1;try{const a=[];h.value.forEach(l=>{a.push(l.value)});const[b,F]=await M.updateInfo({id:w.id,title:e.value.title,description:e.value.description,isExplicit:e.value.isExplicit,isGore:e.value.isGore,tags:a.toString(),isOriginalCharacter:e.value.isOriginalCharacter,allowRedraw:e.value.isAllowRedraw,redrawInYourStyle:e.value.isRedrawInMyStyle});F?B.value=!0:(f.value=!0,setTimeout(()=>{R.push(`/a/${w.id}`)},1e3))}catch{B.value=!0}u.value=!1},Y=()=>{e.value.isExplicit=!e.value.isExplicit,e.value.isGore=!1};return(s,a)=>{const b=J,F=K("tags-input");return i(),x("div",null,[o("div",ie,[$(r(s.$t("artworks.update.form.title"))+" ",1),o("span",le,[S(b,{to:"/a/"+d.id},{default:j(()=>[$(" (ID: "+r(d.id)+") ",1)]),_:1},8,["to"])])]),m(o("div",{class:"alert-danger"},r(s.$t("artworks.update.form.fetchFailure")),513),[[C,t(y)]]),m(o("div",ne,[$(r(s.$t("artworks.update.form.updated"))+" ",1),o("span",ce,r(s.$t("artworks.update.form.successRedirect")),1)],512),[[C,t(f)]]),m(o("div",de,[S(U,{class:"mr-1"}),$(" "+r(s.$t("saving")),1)],512),[[C,t(u)]]),m(o("div",{class:"alert-danger"},r(s.$t("artworks.add.form.uploadFailure")),513),[[C,t(B)]]),m(o("form",{enctype:"multipart/form-data",onSubmit:k(L,["prevent"])},[o("div",pe,[m(o("input",{"onUpdate:modelValue":a[0]||(a[0]=l=>t(e).title=l),type:"text",class:p(["form-input input",{"pointer-events-none cursor-not-allowed":t(u)||t(f)}]),placeholder:s.$t("title")},null,10,ge),[[P,t(e).title]])]),o("div",_e,[S(t(se.exports.VueEditor),{modelValue:t(e).description,"onUpdate:modelValue":a[1]||(a[1]=l=>t(e).description=l),editorToolbar:t(oe),class:p([{"pointer-events-none cursor-not-allowed":t(u)||t(f)}]),placeholder:s.$t("description")},null,8,["modelValue","editorToolbar","class","placeholder"])]),o("div",ve,[S(F,{modelValue:t(h),"onUpdate:modelValue":a[2]||(a[2]=l=>H(h)?h.value=l:null),placeholder:s.$t("tagsInputPlaceholder"),typeahead:!0,"typeahead-style":"dropdown","typeahead-activation-threshold":2,"typeahead-show-on-focus":!0,"typeahead-hide-discard":!0,"typeahead-url":t(G)+"/artworks/tags/search?keyword=:search","add-tags-on-comma":!0},null,8,["modelValue","placeholder","typeahead-url"])]),o("div",he,[o("div",{onClick:a[3]||(a[3]=k(l=>Y(),["prevent"])),class:p(["toggler-box",{"toggler-box__active":t(e).isExplicit}])},[o("div",fe,[t(e).isExplicit?(i(),n(c,{key:1,name:"i-ic-outline-check",class:"text-green-500"})):(i(),n(c,{key:0,name:"i-fluent-checkbox-unchecked-20-regular"}))]),o("div",me,[o("b",null,r(s.$t("explicitContent")),1),o("span",null,r(s.$t("artworks.form.options.explicitMark")),1)])],2),t(e).isExplicit?(i(),x("div",{key:0,onClick:a[4]||(a[4]=k(l=>t(e).isGore=!t(e).isGore,["prevent"])),class:p(["toggler-box",{"toggler-box__active":t(e).isGore}])},[o("div",ke,[t(e).isGore?(i(),n(c,{key:1,name:"i-ic-outline-check",class:"text-green-500"})):(i(),n(c,{key:0,name:"i-fluent-checkbox-unchecked-20-regular"}))]),o("div",we,[ye,o("span",null,r(s.$t("artworks.form.options.goreMark")),1)])],2)):I("",!0)]),o("div",be,[t(v).redraw_of?I("",!0):(i(),x("div",{key:0,onClick:a[5]||(a[5]=k(l=>t(e).isOriginalCharacter=!t(e).isOriginalCharacter,["prevent"])),class:p(["toggler-box",{"toggler-box__active":t(e).isOriginalCharacter}])},[o("div",xe,[t(e).isOriginalCharacter?(i(),n(c,{key:1,name:"i-ic-outline-check",class:"text-green-500"})):(i(),n(c,{key:0,name:"i-fluent-checkbox-unchecked-20-regular"}))]),o("div",$e,[o("b",null,r(s.$t("artworks.originalCharacter")),1),o("span",null,r(s.$t("artworks.form.options.originalCharacterMark")),1)])],2)),t(v).redraw_of?I("",!0):(i(),x("div",{key:1,onClick:a[6]||(a[6]=k(l=>t(e).isAllowRedraw=!t(e).isAllowRedraw,["prevent"])),class:p(["toggler-box",{"toggler-box__active":t(e).isAllowRedraw}])},[o("div",Ce,[t(e).isAllowRedraw?(i(),n(c,{key:1,name:"i-ic-outline-check",class:"text-green-500"})):(i(),n(c,{key:0,name:"i-fluent-checkbox-unchecked-20-regular"}))]),o("div",Ie,[o("b",null,r(s.$t("artworks.add.form.allowRedraw")),1),o("span",null,r(s.$t("artworks.form.options.allowRedrawMark")),1)])],2)),t(v).redraw_of?(i(),x("div",{key:2,onClick:a[7]||(a[7]=k(l=>t(e).isredrawInMyStyle=!t(e).isredrawInMyStyle,["prevent"])),class:p(["toggler-box",{"toggler-box__active":t(e).isredrawInMyStyle}])},[o("div",Se,[t(e).isredrawInMyStyle?(i(),n(c,{key:1,name:"i-ic-outline-check",class:"text-green-500"})):(i(),n(c,{key:0,name:"i-fluent-checkbox-unchecked-20-regular"}))]),o("div",Ee,[o("b",null,r(s.$t("artworks.add.form.redrawInMyStyle")),1),o("span",null,r(s.$t("artworks.form.options.redrawOwnStyleMark")),1)])],2)):I("",!0)]),o("button",{class:p(["float-right primary-button",{"pointer-events-none cursor-not-allowed":t(u)||t(f)}])},[o("div",Me,[t(u)?(i(),n(U,{key:0,class:"mr-1"})):I("",!0),$(" "+r(t(u)?s.$t("saving"):s.$t("save")),1)])],2)],40,ue),[[C,!t(y)]])])}}},Ae=ae(Re,[["__scopeId","data-v-26819de6"]]),Ne={__name:"[id]",setup(d){const w=N(),{oApiConfiguration:V,fetchOptions:O}=T(),E=q(V,O()),{$router:M}=W(),R=Z(),{id:A}=M.currentRoute.value.params;ee(async()=>{await G()}),D(()=>{v()});const G=async()=>{const[_,e]=await E.getWorkById(A);(_.user_id!==w.user.id||e)&&R.push({path:"/"})},y=g({}),v=async()=>{try{const[_,e]=await E.getWorkById(A);e||(y.value=_)}catch{}};return(_,e)=>(i(),n(te,{"with-footer":!0,"h-screen":!0},{default:j(()=>[S(t(Ae),{id:t(A)},null,8,["id"])]),_:1}))}};export{Ne as default};
