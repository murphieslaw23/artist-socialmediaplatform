import{o as c,q as g,b as s,t as u,U as le,V as ie,c as V,w as S,f as i,Q as h,s as R,u as o,x as b,y as ne,N as ae,l as ee,a3 as ve,k as re,h as ke,A as ye,m as de,a as be,a1 as ce,p as ue,L as Z,O as x,r as d,I as H,e as L,v as K,W as $e,S as Re,T as Me,H as xe}from"./entry.e59d1677.js";import{u as Se}from"./useUser.6aeea3ba.js";import{L as Ae}from"./Layout.38bbd337.js";import{U as _e}from"./UserList.e8e4c916.js";import{_ as q}from"./_plugin-vue_export-helper.a1a6add7.js";import{d as Fe,u as Te,J as Ie,a as Ue,b as Oe,c as Ce}from"./ProBadge.e613df9a.js";import{u as We}from"./useFeed.6f185801.js";import{u as Le}from"./useI18n.afc07abc.js";import{M as Ke,a as Ve,u as De,b as Pe}from"./ModalView.7f38a5de.js";import{P as f}from"./index.6cdba04a.js";import{A as Ee,I as Ne,a as Be,_ as ze,F as je}from"./FeedModalView.71b18fe6.js";import"./user-counters-api.efc5c534.js";import"./useReport.1b995e30.js";import"./MiniArtworkPreview.23fe0d3b.js";import"./WorkList.15e244e9.js";import"./LoadingEmptyErrorMessage.81ae6689.js";import"./useSetting.3e22411d.js";const He=[{icon:"i-fluent-person-32-regular",title:"feeds.newUser.welcomingMenus.setupYourAccount",href:"/profile/setting"},{icon:"i-ion-add",title:"feeds.newUser.welcomingMenus.uploadYourArtwork",href:"/post"},{icon:"i-ph-user-plus",title:"feeds.newUser.welcomingMenus.followSomeone",href:"/search?t=users"},{icon:"i-ion-search",title:"feeds.newUser.welcomingMenus.exploreArtworks",href:"/artworks/browse"}];const Ye={id:"welcome",class:"middle__welcome"},qe={class:"middle__welcome__title"},Je={class:"middle__welcome__menus"},Qe={key:0,class:"middle__welcome__follow-suggestions"},Ge={class:"title"},Xe={__name:"WelcomeSection",props:{suggestedUsersToFollow:{type:Array,default:()=>[]}},setup(a){return(m,k)=>{const w=ne;return c(),g("section",Ye,[s("div",null,[s("h1",qe,u(m.$t("feeds.newUser.welcome")),1),s("div",Je,[(c(!0),g(le,null,ie(o(He),r=>(c(),V(w,{key:r.href,to:r.href},{default:S(()=>[i(h,{name:r.icon,"text-size":"text-2xl"},null,8,["name"]),R(" "+u(m.$t(r.title)),1)]),_:2},1032,["to"]))),128))])]),a.suggestedUsersToFollow&&a.suggestedUsersToFollow.length?(c(),g("div",Qe,[s("div",Ge,u(m.$t("feeds.newUser.suggestedUsers")),1),i(_e,{users:a.suggestedUsersToFollow,"column-type":2,class:"mt-4"},null,8,["users"])])):b("",!0)])}}},Ze=q(Xe,[["__scopeId","data-v-83515581"]]);const et={id:"artwork-feed",class:"feed"},tt={id:"redraw",class:"feed__redraw"},ot={key:0,class:"feed__redraw__mini-preview"},st=["href"],lt={class:"text-xs"},it={class:"feed__redraw__mini-preview__image"},nt={class:"preview-title"},at={class:"feed__image-list"},rt={__name:"ArtworkDetail",props:{feed:{type:Object,default:()=>{}},readMore:{type:Function,default:()=>({})}},emits:["view"],setup(a){return(m,k)=>{const w=Fe;return c(),g("section",et,[i(Ee,{feed:a.feed,onReadMore:a.readMore},null,8,["feed","onReadMore"]),s("section",tt,[a.feed.redraw_of&&a.feed.redrawed_artwork_info?(c(),g("div",ot,[s("a",{href:"/a/"+a.feed.redraw_of,target:"_blank"},[s("i",lt,u(m.$t("artworks.redrawed")),1),s("div",it,[i(w,{preload:"",loading:"lazy",src:m.artworkThumb(a.feed.redrawed_artwork_info.artwork_assets.bucket,a.feed.redrawed_artwork_info.artwork_assets.filename,"thumbnail",!1),onError:m.imageLoadError},null,8,["src","onError"]),s("span",nt,u(a.feed.redrawed_artwork_info.title),1)])],8,st)])):b("",!0),s("div",at,[a.feed.type===o(f).ARTWORK?(c(),g("div",{key:0,class:"cursor-pointer",onClick:k[0]||(k[0]=ae(r=>m.$emit("view",a.feed.id),["prevent"]))},[i(Ne,{class:"image-list",work:a.feed},null,8,["work"])])):b("",!0)])])])}}},dt=q(rt,[["__scopeId","data-v-220558e0"]]);const J=a=>(Re("data-v-21de7e3e"),a=a(),Me(),a),ct={id:"feeds",class:"feeds"},ut={key:0,class:"feeds__global-following-switch"},_t={id:"interaction-button-section",class:"interactions !px-4"},ft=J(()=>s("div",null,null,-1)),pt={class:"interactions__items"},mt=["onClick"],ht=["onClick"],gt=["onClick"],wt={class:"ellipsis-menus dropdown"},vt={type:"button","aria-haspopup":"true","aria-expanded":"true","aria-controls":"ellipsis-menus"},kt={class:"ellipsis-menus__content dropdown-menu"},yt={id:"ellipsis-menus",class:"ellipsis-menus__content__wrapper","aria-labelledby":"headlessui-menu-button-1",role:"menu"},bt=J(()=>s("div",{class:"custom-divider"},null,-1)),$t=["onClick"],Rt={class:"loading-empty-error-message"},Mt=J(()=>s("div",{class:"justify-center mt-2 text-tiny hidden-md-flex"}," Currently making magic.. ",-1)),xt={class:"mx-auto text-center"},St={class:"mx-auto mt-4 text-center"},At=J(()=>s("br",null,null,-1)),Ft={id:"chronological-modal",class:"modal work-view"},Tt={id:"chronological-feed-modal",class:"z-30 modal work-view"},It={__name:"FeedSection",props:{fetchMode:{type:String,default:"feed"},changeMode:{type:Function,default:()=>{}}},emits:["updateFeedLength","updateShowSuggestedUsers","noData"],setup(a,{expose:m,emit:k}){const w=a,r=ee(),{generateArtworkThumb:T}=ve(),{oApiConfiguration:D,fetchOptions:P}=re(),M=Te(D,P()),E=We(D,P());ke({title:Le().tl("meta.title.feed.feed")});const N=ye(),O=de(),Q=be();ce(()=>{r.loggedIn||O.push({path:"/explore"})}),ue(()=>{}),Z(()=>Q.query,()=>{setTimeout(()=>{me(),x().closeModal("feed-collection-selection-modal"),x().closeModal("collection-selection-modal"),x().closeModal("album-selection-modal"),x().closeModal("report-modal")},10)});const A=d({explicitMode:void 0,pagination:{page:0,perPage:10}}),$=d(!1);Z(()=>$.value,()=>{Y()});const F=d(!1),I=d([]),U=async({loaded:l})=>{const[n,p]=await E.getChronologicalFeeds({fetchMode:w.fetchMode,explicitMode:A.value.explicitMode,showAllTextPost:$.value,pagination:{page:A.value.pagination.page,perPage:A.value.pagination.perPage}});if(n.feeds.length||F.value&&k("noData"),A.value.pagination.page+=1,n.feeds.length)for(let e=0;e<n.feeds.length;e++){const t=n.feeds[e];if(t.liked&&(t.type===f.ARTWORK?y.value.push("a-"+t.id):y.value.push("f-"+t.id)),t.images=[],t.apply_explicit_filter=!1,t.apply_gore_filter=!1,t.type===f.ARTWORK||t.type==="feed"&&t.artwork_share_info!=null){t.type===f.ARTWORK&&t.saved&&W.value.push(t.id);for(let v=0;v<t.artwork_assets.length;v++)if(v<=3){const we=await T(t.artwork_assets[v].bucket,t.artwork_assets[v].filename,"feed");t.images.push(we)}t.artwork_share_info!=null&&(!r.loggedIn&&t.artwork_share_info.is_explicit||t.artwork_share_info.is_explicit&&!r.user.user_settings.show_explicit)&&(t.apply_explicit_filter=!0),t.artwork_share_info!=null&&(!r.loggedIn&&t.artwork_share_info.is_gore||t.artwork_share_info.is_gore&&!r.user.user_settings.show_gore)&&(t.apply_gore_filter=!0)}I.value.push(t),k("updateFeedLength",n.feeds.length)}l(n.feeds.length,A.value.pagination.perPage)},Y=()=>{A.value.pagination.page=0,I.value=[],F.value=!0},C=d(null),B=(l,n,p)=>{n?(I.value[p].apply_explicit_filter=!1,I.value[p].apply_gore_filter=!1):(C.value.view(l),x().openModal("chronological-modal"))},_=d(null),z=l=>{_.value.viewFeed(l),x().openModal("chronological-feed-modal")},G=(l,n,p,e)=>{De().readMore(l,n,p,e)},te=d(!1);let fe;const pe=l=>{const n=d(N.public.appUrl+l),{copy:p}=Oe({source:n});p(),Ce().splash(fe,te,"copy-alert")},W=d([]),y=d([]),oe=async(l,n)=>{const p=parseInt(l.split("-")[1]);let e=!1;if(n===f.ARTWORK){const[t,v]=await M.like({workId:p});e=t}else if(n==="feed"){const[t,v]=await E.like({feedId:p});e=t}if(e){y.value.push(l);const t=document.getElementById(`feed-like-button-${n}-${p}`);t.classList.add("animate-bounce"),setInterval(()=>{t.classList.remove("animate-bounce")},2500)}},se=async(l,n)=>{const p=parseInt(l.split("-")[1]);let e=!1;if(n===f.ARTWORK){const[t,v]=await M.unlike({workId:p});e=t}else if(n==="feed"){const[t,v]=await E.unlike({feedId:p});e=t}if(e){const t=y.value.indexOf(l);y.value.splice(t,1)}},me=()=>{x().closeModal("chronological-modal"),x().closeModal("chronological-feed-modal")},X=d(null),j=d(0),he=l=>{j.value=l,x().openModal("feed-collection-selection-modal"),X.value.fetchCollection(),X.value.fetchCurrentSaved()},ge=l=>{if(l){const n=W.value.indexOf(j.value);W.value.splice(n,1)}else W.value.push(j.value);Pe().animate("save-to-collection-button-"+j.value)};return m({refetch:Y}),(l,n)=>{const p=ne;return c(),g("section",ct,[a.fetchMode=="text"?(c(),g("nav",ut,[s("button",{class:H(o($)==!1?"primary-button":"light-button"),onClick:n[0]||(n[0]=e=>$.value=!1)},[i(h,{name:"i-fluent-people-checkmark-24-regular"}),R(" "+u(l.$t("followings.followingOnly")),1)],2),s("button",{class:H(o($)==!0?"primary-button":"light-button"),onClick:n[1]||(n[1]=e=>$.value=!0)},[i(h,{name:"i-heroicons-globe-asia-australia"}),R(" "+u(l.$t("followings.global")),1)],2)])):b("",!0),(c(!0),g(le,null,ie(o(I),(e,t)=>(c(),g("section",{id:"feed-list",key:e.id+e.type,class:"feeds__list"},[i(Be,{feed:e},null,8,["feed"]),e.type===o(f).ARTWORK?(c(),V(dt,{key:0,feed:e,"feed-idx":t,"read-more":G,onView:B},null,8,["feed","feed-idx"])):b("",!0),e.type===o(f).FEED?(c(),V(ze,{key:1,feed:e,"feed-idx":t,"read-more":G,"view-artwork":B,onReadMore:G},null,8,["feed","feed-idx"])):b("",!0),s("section",_t,[ft,s("div",pt,[s("div",{class:"interactions__item",onClick:v=>e.type===o(f).ARTWORK?o(y).includes("a-"+e.id)?se("a-"+e.id,e.type):oe("a-"+e.id,e.type):o(y).includes("f-"+e.id)?se("f-"+e.id,e.type):oe("f-"+e.id,e.type)},[L(i(h,{id:"feed-like-button-"+e.type+"-"+e.id,name:"i-ion-heart",class:"text-red-500 hover:text-red-500"},null,8,["id"]),[[K,e.type===o(f).ARTWORK?o(y).includes("a-"+e.id):o(y).includes("f-"+e.id)]]),L(i(h,{name:"i-ri-heart-3-line",class:"icon-color hover:text-red-500"},null,512),[[K,e.type===o(f).ARTWORK?!o(y).includes("a-"+e.id):!o(y).includes("f-"+e.id)]]),R(" "+u(l.thousand(e._count.likes)),1)],8,mt),s("div",{class:"interactions__item",onClick:ae(v=>e.type===o(f).ARTWORK?B(e.id):z(e.id),["prevent"])},[i(h,{name:"i-mdi-comment-multiple-outline",class:"icon-color hover:text-blue-500"}),R(" "+u(l.thousand(e._count.comments)),1)],8,ht),e.type===o(f).ARTWORK?(c(),g("div",{key:0,class:"interactions__item",onClick:v=>he(e.id)},[L(i(h,{id:"save-to-collection-button-"+e.id,name:"i-ion-bookmark",class:"text-blue-500 hover:text-blue-500"},null,8,["id"]),[[K,o(W).includes(e.id)]]),L(i(h,{name:"i-majesticons-bookmark-line",class:"icon-color hover:text-blue-500"},null,512),[[K,!o(W).includes(e.id)]])],8,gt)):b("",!0),s("div",wt,[s("button",vt,[i(h,{name:"i-uit-ellipsis-v"})]),s("div",kt,[s("div",yt,[i(p,{to:e.type===o(f).ARTWORK?"/a/"+e.id:"/feed/"+e.id},{default:S(()=>[i(h,{name:"i-fluent-arrow-enter-20-filled"}),R(" "+u(l.$t("open")),1)]),_:2},1032,["to"]),i(p,{to:e.type===o(f).ARTWORK?"/a/"+e.id:"/feed/"+e.id,target:"_blank"},{default:S(()=>[i(h,{name:"i-ci-external-link"}),R(" "+u(l.$t("openInNewTab")),1)]),_:2},1032,["to"]),bt,s("div",null,[s("a",{onClick:v=>pe(e.type===o(f).ARTWORK?"/a/"+e.id:"/feed/"+e.id)},[i(h,{name:"i-icon-park-outline-copy"}),R(" "+u(l.$t("copySharableLink")),1)],8,$t)])])])])])])]))),128)),i(o(Ie),{"is-initial":o(F),"onUpdate:is-initial":n[2]||(n[2]=e=>$e(F)?F.value=e:null),load:U},{loading:S(()=>[s("div",Rt,[i(h,{name:"i-line-md-loading-twotone-loop","text-size":"text-3xl"}),Mt])]),"no-results":S(()=>[s("div",xt,u(l.$t("feeds.nothingToShow")),1)]),"no-more":S(()=>[s("div",St,[R(u(l.$t("youHaveReachedTheEnd"))+" ",1),At,R(" "+u(l.$t("feeds.followMorePeople")),1)])]),_:1},8,["is-initial"]),s("div",Ft,[i(Ke,{ref_key:"chronologicalModalViewRef",ref:C,section:"chronological"},null,512)]),s("div",Tt,[i(je,{ref_key:"chronologicalFeedModalViewRef",ref:_,section:"chronological-feed","is-modal":!0},null,512)]),i(Ve,{id:"feed-collection-selection-modal",ref_key:"collectionSelectionModalRef",ref:X,"modal-id":"feed-collection-selection-modal","work-id":o(j),class:"modal",onSave:ge},null,8,["work-id"]),L(i(Ue,{id:"copy-alert",text:l.$t("linkCopied"),icon:"i-bi-check-all"},null,8,["text"]),[[K,o(te)]])])}}},Ut=q(It,[["__scopeId","data-v-21de7e3e"]]);const Ot={class:"feed__left-buttons"},Ct={class:"hidden ml-3 lg:block"},Wt={class:"hidden ml-3 lg:block"},Lt={class:"hidden ml-3 lg:block"},Kt={__name:"FeedLeftSide",props:{currentView:{type:String,default:"feed"}},emits:["refetch"],setup(a,{emit:m}){ee();const k=w=>{m("refetch",w)};return(w,r)=>(c(),g("div",Ot,[s("button",{class:H(["left-button",a.currentView=="feed"?"theme-colored":"theme-color"]),onClick:r[0]||(r[0]=T=>k("feed"))},[i(h,{name:"i-akar-icons-home"}),s("span",Ct,u(w.$t("feeds.all")),1)],2),s("button",{class:H(["left-button",a.currentView=="text"?"theme-colored":"theme-color"]),onClick:r[1]||(r[1]=T=>k("text"))},[i(h,{name:"i-ion-text-sharp"}),s("span",Wt,u(w.$t("feeds.textOnly")),1)],2),s("button",{class:H(["left-button",a.currentView==o(f).ARTWORK?"theme-colored":"theme-color"]),onClick:r[2]||(r[2]=T=>k(o(f).ARTWORK))},[i(h,{name:"i-gg-image"}),s("span",Lt,u(w.$t("feeds.artworkOnly")),1)],2)]))}},Vt=q(Kt,[["__scopeId","data-v-cdbb7d0f"]]),Dt={id:"middle"},Pt={key:0},Et=s("div",null,null,-1),Nt={key:0},Bt={class:"title"},ao={__name:"index",setup(a){const m=ee(),{oApiConfiguration:k,fetchOptions:w}=re(),r=Se(k,w()),T=de();ce(()=>{m.loggedIn||T.push("/explore")}),ue(async()=>{m.loggedIn?(await Q(),await E()):T.push("/explore")});const D=xe(()=>M.value?N.value:!M.value),P=d(!0),M=d(!1),E=async()=>{M.value=!1;const[_,z]=await r.countFollowings(m.user.id);z?M.value=!1:M.value=_>0,P.value=!1},N=d(!1),O=d([]),Q=async()=>{const[_,z]=await r.getSuggestedUsersToFollow();_.length&&(O.value=_)},A=_=>{N.value=_},$=d("feed"),F=d(null),I=_=>{$.value=_,F.value.refetch(),C.value=!1},U=d(0),Y=_=>{U.value=_};Z(()=>U.value,()=>{U.value||(N.value=!0)});const C=d(!1),B=()=>{C.value=!0};return(_,z)=>(c(),V(Ae,{"with-footer":!0,"hide-side":o(D)&&_.isMobile()?!0:_.isMobileDevice(),"no-right-side":_.isMobile(),"is-no-data":o(C)},{"left-side":S(()=>[o(U)?(c(),V(Vt,{key:0,"current-view":o($),onRefetch:I},null,8,["current-view"])):b("",!0)]),"right-side":S(()=>[Et,o(U)&&o(O).length?(c(),g("div",Nt,[s("div",Bt,u(_.$t("feeds.suggestedUsers")),1),i(_e,{users:o(O),"column-type":1,class:"mt-4"},null,8,["users"])])):b("",!0)]),default:S(()=>[s("section",Dt,[o(P)?b("",!0):(c(),g("div",Pt,[o(D)?(c(),V(Ze,{key:0,"suggested-users-to-follow":o(O)},null,8,["suggested-users-to-follow"])):b("",!0),L(i(Ut,{ref_key:"feedRef",ref:F,"fetch-mode":o($),onUpdateFeedLength:Y,onUpdateShowSuggestedUsers:A,onNoData:B},null,8,["fetch-mode"]),[[K,o(M)]])]))])]),_:1},8,["hide-side","no-right-side","is-no-data"]))}};export{ao as default};
