import{k as ve,j as ge,f as fe,O as we,E as q,m as ye,r as a,H as E,J as be,c as J,w as ke,o as h,q as s,t as i,K as l,u as o,b as f,v as w,e as r,L as c,s as y,p as P,x as C,aa as he,M as $e,N as xe}from"./entry.ed1bfc63.js";import{u as _e}from"./ProBadge.dc1cf83d.js";import{u as Ce}from"./useI18n.33ad3225.js";import{L as Me}from"./Layout.c894869a.js";import{W as Oe}from"./WorkList.c9cb3145.js";import{M as Pe}from"./ModalView.76afae2b.js";import{_ as Ie}from"./LoadingEmptyErrorMessage.caee9811.js";import{_ as Se}from"./TagFilterSelection.23f17a9a.js";import{_ as Le}from"./_plugin-vue_export-helper.a1a6add7.js";import"./useReport.8d0e33e2.js";import"./Spinner.bfc0b0e5.js";import"./user-counters-api.0d36adb4.js";import"./useSetting.56e2c71f.js";import"./useFeed.bd601146.js";const ee=I=>($e("data-v-e1a316c8"),I=I(),xe(),I),Ve={id:"lists"},Ee={class:"navigations"},Ne={class:"title"},Ae={class:"buttons"},Be={class:"filter-buttons"},Fe={class:"filter-buttons"},Re={class:"filter-buttons"},qe={key:0,class:"filter-buttons"},Te=ee(()=>s("div",{class:"hidden md:flex"},null,-1)),je={class:"buttons"},Ke={class:"filter-buttons"},We={class:"filter-buttons"},ze={class:"inline-block w-full group md:w-52"},De={class:"flex-1 pr-1"},He=ee(()=>s("span",null,[s("svg",{class:"w-4 h-4 transition duration-150 ease-in-out transform fill-current group-hover:-rotate-180",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[s("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})])],-1)),Ge={id:"popular-order-options",class:"absolute z-10 mt-1 w-full text-center rounded-md transition duration-150 ease-in-out transform origin-top scale-0 md:w-52 theme-color group-hover:scale-100"},Qe={key:0,class:"art-list-view-paging-control"},Ue={id:"browse-modal",class:"modal work-view"},Xe={__name:"index",setup(I){const m=ve(),{oApiConfiguration:te,fetchOptions:oe}=ge(),N=_e(te,oe());fe({title:Ce().tl("meta.title.browse")});const M=we(),{tags:T}=M.query;q(()=>M.query,()=>{se()}),q(()=>M.query.tags,e=>{e&&(O.value=e,z(e)),u()}),ye(()=>{T&&z(),u()});const se=()=>{E().closeModal("browse-modal")},j=a(!1),le=()=>{j.value=!j.value},ne=()=>{document.getElementById("popular-order-options").classList.add("scale-0")},v=a("recent"),K=async e=>{v.value=e,await u()},b=a(void 0),A=async e=>{b.value=e,d.page=0,await u()},$=a("daily"),S=async e=>{$.value=e,d.page=0,await u()},k=a(!1),ae=async()=>{k.value=!k.value,d.page=0,await u()},W=a(!1),z=async e=>{W.value=!0;const t=e!=null?e:T,[n,me]=await N.getTagKeys(t);if(!me){const R=[];n.tags.forEach(Z=>{R.push({key:Z.id,value:Z.tag})}),L.value=R,await G(R,t)}W.value=!1},D=a(null),ie=()=>{D.value.init(he(L.value)),E().openModal("tag-filter-selection-modal")},O=a(""),H=a(""),L=a(),B=a(0),G=async(e,t)=>{L.value=e,O.value=t,H.value=t,B.value=t!==""?t.split(",").length:0,d.page=0,E().closeModal("tag-filter-selection-modal"),await u()};q(async()=>L.value,e=>{u()});const Q=a([]),x=a({pagination:{enablePrev:!0,enableNext:!0}}),u=async()=>{const e=await re(),t=e.works,n=e.pagination;!t.length&&n.record_total===0?ue():(Q.value=t,n.next_previous.next_page===null?x.value.pagination.enableNext=!1:x.value.pagination.enableNext=!0,n.next_previous.prev_page===null?x.value.pagination.enablePrev=!1:x.value.pagination.enablePrev=!0)},g=a(!0),d=be({perPage:30,page:a(0)}),re=async()=>{M.query.tags&&!H.value&&(O.value=M.query.tags),d.page===0&&(g.value=!0,_.value=!1);let[e,t]=[];if(v.value==="recent"?[e,t]=await N.getLatest({pagination:{perPage:d.perPage,page:d.page},explicitMode:b.value,tags:O.value,followingOnly:k.value}):[e,t]=await N.getMostPopular({pagination:{perPage:d.perPage,page:d.page},range:$.value,rangeMode:p.value,explicitMode:b.value,tags:O.value,followingOnly:k.value}),t)de();else return pe(),e},U=async e=>{e==="prev"?d.page-=1:d.page+=1,await u(),window.scrollTo(0,0)},_=a(!1),ue=()=>{_.value=!0},V=a(!1),de=()=>{g.value=!1,V.value=!0},pe=()=>{g.value=!1,_.value=!1,V.value=!1},X=a(null),ce=(e,t=!1)=>{X.value.view(e,t),E().openModal("browse-modal")},p=a("views"),Y=a(""),F=async(e,t)=>{p.value=e,Y.value=t,ne(),await u()};return(e,t)=>(h(),J(Me,{"with-footer":!0,"hide-side":!0,"no-right-side":!0,fullscreen:!0},{default:ke(()=>[s("div",Ve,[s("div",Ee,[s("div",Ne,i(e.$t("browse")),1),s("div",Ae,[s("div",Be,[s("button",{class:l(["px-3 rounded-md button-item",o(B)?"button":"theme-color"]),onClick:ie},i(o(B))+" "+i(e.$t("tagsApplied")),3)]),f(s("div",Fe,[s("button",{class:l(["px-3 rounded-md button-item",o(k)?"button":"theme-color"]),onClick:t[0]||(t[0]=n=>ae())},[f(r(c,{name:"i-fluent-people-checkmark-24-regular",class:"text-white"},null,512),[[w,o(k)]]),f(r(c,{name:"i-fluent-people-checkmark-24-regular"},null,512),[[w,!o(k)]]),y(" "+i(e.$t("followingOnly")),1)],2)],512),[[w,o(m).loggedIn]]),s("div",Re,[s("p",{class:l(["rounded-l-md button-item",[o(v)==="recent"?"button":"theme-color"]]),onClick:t[1]||(t[1]=n=>K("recent"))},i(e.$t("artworks.newest")),3),s("p",{class:l(["rounded-r-md button-item",[o(v)==="popularity"?"button":"theme-color"]]),onClick:t[2]||(t[2]=n=>K("popularity"))},[r(c,{name:"i-icon-park-outline-oval-love-two",class:l([{"text-white":o(v)==="popularity"}])},null,8,["class"]),y(" "+i(e.$t("artworks.mostPopular")),1)],2)]),o(m).loggedIn&&o(m).user.user_settings.show_explicit?(h(),P("div",qe,[s("p",{class:l(["rounded-l-md button-item",[o(b)===void 0?"button":"theme-color"]]),onClick:t[3]||(t[3]=n=>A(void 0))},i(e.$t("default")),3),s("p",{class:l(["button-item",[o(b)==="safe"?"button":"theme-color"]]),onClick:t[4]||(t[4]=n=>A("safe"))},i(e.$t("safe")),3),s("p",{class:l(["rounded-r-md button-item",[o(b)==="explicit"?"button":"theme-color"]]),onClick:t[5]||(t[5]=n=>A("explicit"))},[r(c,{name:"i-material-symbols-explicit-outline",class:l({"text-white":o(b)==="explicit"})},null,8,["class"]),y(" "+i(e.$t("explicit")),1)],2)])):C("",!0)])]),s("div",{class:l(["navigations",o(v)==="popularity"?"-mt-2":"-mt-4"])},[Te,s("div",je,[f(s("div",Ke,[s("p",{class:l(["rounded-l-md button-item",[o($)==="daily"?"button":"theme-color"]]),onClick:t[6]||(t[6]=n=>S("daily"))},i(e.$t("daily")),3),s("p",{class:l(["button-item",[o($)==="weekly"?"button":"theme-color"]]),onClick:t[7]||(t[7]=n=>S("weekly"))},i(e.$t("weekly")),3),s("p",{class:l(["button-item",o($)==="monthly"?"button":"theme-color",{"rounded-r-md":!o(m).loggedIn}]),onClick:t[8]||(t[8]=n=>S("monthly"))},i(e.$t("monthly")),3),o(m).loggedIn?(h(),P("p",{key:0,class:l(["rounded-r-md button-item",o($)==="all"?"button":"theme-color"]),onClick:t[9]||(t[9]=n=>S("all"))},i(e.$t("allTime")),3)):C("",!0)],512),[[w,o(v)==="popularity"]]),f(s("div",We,[s("div",ze,[s("button",{class:"flex items-center py-2 w-full rounded-md border-2 border-transparent outline-none md:w-52 theme-color hover:button",onClick:t[10]||(t[10]=n=>le())},[s("span",De,i(o(p)==="views"?e.$t("mostViewed"):o(Y)),1),He]),s("ul",Ge,[s("li",{class:l(["flex flex-row justify-between py-2 px-3 cursor-pointer hover:button icon-hover-parent",{button:o(p)==="views"},{"rounded-b-md":!o(m).loggedIn}]),onClick:t[11]||(t[11]=n=>F("views",e.$t("mostViewed")))},[r(c,{name:"i-mi-eye",class:l({"text-white":o(p)==="views"})},null,8,["class"]),y(" "+i(e.$t("mostViewed")),1)],2),o(m).loggedIn?(h(),P("li",{key:0,class:l(["flex flex-row justify-between py-2 px-3 cursor-pointer hover:button icon-hover-parent",{button:o(p)==="likes"}]),onClick:t[12]||(t[12]=n=>F("likes",e.$t("mostLiked")))},[r(c,{name:"i-ri-heart-3-line",class:l({"text-white":o(p)==="likes"})},null,8,["class"]),y(" "+i(e.$t("mostLiked")),1)],2)):C("",!0),o(m).loggedIn?(h(),P("li",{key:1,class:l(["flex flex-row justify-between py-2 px-3 rounded-b-md cursor-pointer hover:button icon-hover-parent",{button:o(p)==="comments"}]),onClick:t[13]||(t[13]=n=>F("comments",e.$t("mostCommented")))},[r(c,{name:"i-mdi-comment-multiple-outline",class:l({"text-white":o(p)==="comments"})},null,8,["class"]),y(" "+i(e.$t("mostCommented")),1)],2)):C("",!0)])])],512),[[w,o(v)==="popularity"]])])],2),r(Ie,{loading:o(g),empty:o(_),error:o(V),fetch:u},null,8,["loading","empty","error"]),f(s("div",null,[f(r(Oe,{"section-class":"work-grid",works:o(Q),view:ce},null,8,["works"]),[[w,!o(_)]])],512),[[w,!o(g)]]),!o(g)&&!o(_)&&!o(V)?(h(),P("div",Qe,[s("button",{class:l([o(x).pagination.enablePrev?"primary-button":"disabled-button"]),onClick:t[14]||(t[14]=n=>U("prev"))},[r(c,{name:"i-ion-chevron-back-outline"}),y(" "+i(e.$t("pagination.previous")),1)],2),s("button",{class:l([o(x).pagination.enableNext?"primary-button":"disabled-button"]),onClick:t[15]||(t[15]=n=>U("next"))},[y(i(e.$t("pagination.next"))+" ",1),r(c,{name:"i-ion-chevron-forward-outline",class:"md:ml-2",style:{"margin-right":"0 !important"}})],2)])):C("",!0),s("div",Ue,[f(r(Pe,{ref_key:"popularModalViewRef",ref:X,section:"browse"},null,512),[[w,!o(g)]])]),o(g)?C("",!0):(h(),J(Se,{key:1,id:"tag-filter-selection-modal",ref_key:"tagFilterSelectionModalRef",ref:D,class:"modal",onApply:G},null,512))])]),_:1}))}},pt=Le(Xe,[["__scopeId","data-v-e1a316c8"]]);export{pt as default};
