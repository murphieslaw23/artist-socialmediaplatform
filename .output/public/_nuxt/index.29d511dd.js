import{z as M,l as B,k as N,m as U,K as V,a1 as D,r as m,c as p,w as W,o as n,b as o,N as w,f as y,u as e,e as q,M as z,q as x,t as l,I as v,x as d,s as F,a2 as L}from"./entry.e59d1677.js";import{u as R,S as j}from"./ProBadge.e613df9a.js";import{u as K}from"./useArtTrade.ec2051ba.js";import{L as O,u as P}from"./Layout.38bbd337.js";import{A as G}from"./ArtworkForm.74927cd1.js";import{A as H,_ as J}from"./MiniArtworkPreview.23fe0d3b.js";import{_ as Q}from"./_plugin-vue_export-helper.a1a6add7.js";import"./useSetting.3e22411d.js";import"./vue3-editor.common.410ae174.js";import"./WorkList.15e244e9.js";import"./LoadingEmptyErrorMessage.81ae6689.js";const X={class:"mx-2"},Y=["name"],Z=["placeholder"],ee={key:0,id:"artwork",class:"mt-4"},te={class:"title-tiny"},re={class:"flex flex-col p-4 rounded-md theme-color-secondary"},oe={class:"flex flex-row gap-2 justify-between mb-4 w-full"},se={key:1,class:"p-4 my-2 rounded-md theme-color"},ae={class:"mb-2 title"},ie={class:"buttons"},ne={class:"flex flex-row"},le=M({__name:"index",setup(de){const k=B(),{oApiConfiguration:h,fetchOptions:b}=N(),I=R(h,b()),S=K(h,b()),g=U(),{t:T}=V();D(()=>{k.loggedIn||g.push("/")});const t=m({isError:!1,isEmpty:!1,currentActiveArtworkSelector:"new",submitting:!1,submitted:!1}),i=m({title:"",workId:0}),_="art-trade-form",$=async()=>{P().validate(_,T),t.value.submitting=!0,t.value.submitted=!1,i.value.workId=u.value;const[r,s,f]=await S.host({title:i.value.title,workId:i.value.workId});f?t.value.isError=!0:(t.value.submitting=!1,t.value.submitted=!0,setTimeout(()=>{g.push("/art-trade/view/"+s.id)},1e3)),t.value.submitting=!1},u=m(0),C=async r=>{u.value=r,await A()},a=m({show:!1,data:{},isError:!1}),A=async()=>{a.value.show=!1,a.value.isError=!1;const[r,s]=await I.getWorkById(u.value);a.value.show=!0,s?a.value.isError=!0:a.value.data=r},E=async r=>{u.value=r,await A()};return(r,s)=>{const f=L("ErrorMessage");return n(),p(O,{"with-footer":!0,"hide-side":!1},{default:W(()=>[o("div",X,[o("form",{id:_,onSubmit:s[3]||(s[3]=w(c=>$(),["prevent"]))},[y(f,{"is-error":e(t).isError,"error-message":e(t).message},null,8,["is-error","error-message"]),o("n-validate",{for:"title",name:r.$t("artTrades.form.title")},[q(o("input",{"onUpdate:modelValue":s[0]||(s[0]=c=>e(i).title=c),type:"text",rules:"required|min:5|max:100",placeholder:r.$t("artTrades.form.title")},null,8,Z),[[z,e(i).title]])],8,Y),e(a).show?d("",!0):(n(),x("section",ee,[o("h2",te,l(r.$t("artTrades.form.artwork.title")),1),o("div",re,[o("div",oe,[o("button",{class:v(["py-4 w-full rounded-md theme-color hover:theme-colored cursor-pointer text-center font-semibold text-xs",{"theme-colored":e(t).currentActiveArtworkSelector==="new"}]),onClick:s[1]||(s[1]=w(c=>e(t).currentActiveArtworkSelector="new",["prevent"]))},l(r.$t("artTrades.form.artwork.new")),3),o("button",{class:v(["py-4 w-full rounded-md theme-color hover:theme-colored cursor-pointer text-center font-semibold text-xs",{"theme-colored":e(t).currentActiveArtworkSelector==="existing"}]),onClick:s[2]||(s[2]=w(c=>e(t).currentActiveArtworkSelector="existing",["prevent"]))},l(r.$t("artTrades.form.artwork.existing")),3)]),o("section",null,[e(t).currentActiveArtworkSelector==="existing"?(n(),p(H,{key:0,"with-title":!1,"artwork-detail":{users:{id:e(k).user.id}},"pagination-per-page":r.isMobile()?3:4,"is-picker-mode":!0,onPickerModeChangeSelected:E},null,8,["artwork-detail","pagination-per-page"])):d("",!0),e(t).currentActiveArtworkSelector==="new"&&!r.selectedArtwork?(n(),p(G,{key:1,"is-art-trade":!0,onSendUploadedWorkId:C})):d("",!0)])])])),e(a).show?(n(),x("div",se,[o("h2",ae,l(r.$t("artTrades.form.selectedWork")),1),y(J,{data:e(a).data},null,8,["data"])])):d("",!0),o("div",ie,[o("button",{class:v(["submit",{"pointer-events-none cursor-not-allowed":e(t).submitting||e(t).submitted},{"!disabled-button":!e(i).title&&!e(i).workId||e(t).submitting},{"!success-button":e(t).submitted}])},[o("div",ne,[e(t).submitting?(n(),p(j,{key:0,class:"mr-2"})):d("",!0),F(" "+l(e(t).submitted?r.$("artTrades.form.submitted"):e(t).submitting?r.$t("artTrades.form.hosting").toUpperCase():r.$t("artTrades.form.host").toUpperCase()),1)])],2)])],32)])]),_:1})}}});const _e=Q(le,[["__scopeId","data-v-8b77e731"]]);export{_e as default};
