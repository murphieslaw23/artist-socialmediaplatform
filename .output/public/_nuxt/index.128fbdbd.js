import{l as oe,k as se,a as N,L as D,r as a,p as H,H as ne,o as T,q as V,b as t,t as r,e as f,v as w,u as e,I as n,f as c,Q as x,s as O,x as Z,O as me,S as ae,T as le,K as ve,m as fe,h as ee,c as te,w as he,M as we,W as ye,Y as ge}from"./entry.e59d1677.js";import{P as E}from"./index.6cdba04a.js";import{L as be}from"./Layout.38bbd337.js";import{u as _e}from"./ProBadge.e613df9a.js";import{W as ke}from"./WorkList.15e244e9.js";import{_ as re}from"./LoadingEmptyErrorMessage.81ae6689.js";import{M as $e}from"./ModalView.7f38a5de.js";import{_ as Y}from"./_plugin-vue_export-helper.a1a6add7.js";import{U as xe}from"./UserList.e8e4c916.js";import{u as Ce}from"./useUser.6aeea3ba.js";import{L as Me}from"./LoginMessage.e806b183.js";import"./useReport.1b995e30.js";import"./MiniArtworkPreview.23fe0d3b.js";import"./user-counters-api.efc5c534.js";import"./useSetting.3e22411d.js";import"./useFeed.6f185801.js";const ie=b=>(ae("data-v-6f0e9e52"),b=b(),le(),b),qe={id:"options",class:"md:z-10 md:sticky md:top-0"},Re={class:"navigations"},Ae={class:"title"},Oe={class:"buttons"},Se={class:"filter-buttons"},Le={class:"filter-buttons"},Te={key:0,class:"filter-buttons"},Be={key:0,class:"navigations"},Ee=ie(()=>t("div",null,null,-1)),Ie={class:"buttons"},Pe={class:"filter-buttons"},Ue={class:"filter-buttons"},Ve={class:"inline-block w-full md:w-52 group"},We={class:"flex items-center py-2 px-3 w-full rounded-md border-2 border-transparent outline-none md:w-52 theme-color hover:button focus:outline-none"},Fe={class:"flex-1 pr-1"},Ke=ie(()=>t("span",null,[t("svg",{class:"w-4 h-4 transition duration-150 ease-in-out transform fill-current group-hover:-rotate-180",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[t("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})])],-1)),je={class:"absolute z-10 mt-1 w-full text-center rounded-md transition duration-150 ease-in-out transform origin-top scale-0 md:w-52 theme-color group-hover:scale-100"},ze={class:"mt-4"},Ne={id:"popular-modal",class:"modal work-view"},De={__name:"Artworks",emits:["countArtworks"],setup(b,{emit:I}){const C=oe(),{oApiConfiguration:P,fetchOptions:_}=se(),m=_e(P,_()),p=N(),{q:S}=p.query;D(()=>p.query.q,(o,s)=>{o!==s&&(k.value=o,o&&o!==""&&A())});const k=a(S);H(()=>{A(),M()});const M=()=>{var o=document.createElement("div");o.classList.add("myObserver");var s=document.querySelector("#options");d(o,s);function d(K,X){X.parentNode.insertBefore(K,X)}var pe=new IntersectionObserver(function(K){K[0].intersectionRatio===0?document.querySelector("#options").classList.add("md:pt-4","md:pb-1","md:theme-color-secondary","md:rounded-b-md","md:px-6","md:mt-2","md:border-color-button-color","md:border-2","md:border-t-0"):K[0].intersectionRatio===1&&document.querySelector("#options").classList.remove("md:pt-4","md:pb-1","md:theme-color-secondary","md:rounded-b-md","md:px-6","md:mt-2","md:border-color-button-color","md:border-2","md:border-t-0")},{threshold:[0,1]});pe.observe(document.querySelector(".myObserver"))},v=a("recent"),$=async o=>{v.value=o,await A()},h=a(void 0),u=async o=>{h.value=o,await A()},l=a("views"),y=a(""),L=async(o,s)=>{l.value=o,y.value=s,await A()},q=a("daily"),B=async o=>{q.value=o,await A()},i=a(!1),g=async()=>{i.value=!i.value,await A()},R=a([]),A=async()=>{de();const{works:o,pagination:s}=await G();o.length&&s.record_total&&(R.value=o),I("countArtworks",s.record_total)},U=a(!0),W=a(!1),Q=ne(()=>!W.value&&!R.value.length),j=a(!0),F=a({perPage:24,page:0}),G=async()=>{var d;const[o,s]=await m.getSearch({recentMode:v.value==="recent",range:q.value,rangeMode:l.value,explicitMode:h.value,keyword:(d=k.value)!=null?d:"",followingOnly:i.value===!1?void 0:i.value,pagination:{perPage:F.value.perPage,page:F.value.page}});if(U.value=!1,o.pagination.next_previous.next_page||(j.value=!1),s)W.value=!0;else return F.value.page+=1,o},z=a({delay:!1}),ue=async()=>{z.value.delay=!0;const{works:o}=await G();o.forEach(s=>{R.value.push(s)}),z.value.delay=!1},de=()=>{R.value=[],j.value=!0,F.value.page=0,U.value=!0,W.value=!1},J=a(null),ce=(o,s=!1)=>{J.value.view(o,s),me().openModal("popular-modal")};return(o,s)=>(T(),V("div",null,[t("div",qe,[t("div",Re,[t("div",Ae,r(o.$t("artworks.artworks")),1),t("div",Oe,[f(t("div",Se,[t("button",{class:n(["px-3 rounded-md button-item",e(i)?"button":"theme-color"]),onClick:s[0]||(s[0]=d=>g())},[f(c(x,{name:"i-fluent-people-checkmark-24-regular",class:"text-white"},null,512),[[w,e(i)]]),f(c(x,{name:"i-fluent-people-checkmark-24-regular"},null,512),[[w,!e(i)]]),O(" "+r(o.$t("followingOnly")),1)],2)],512),[[w,e(C).loggedIn]]),t("div",Le,[t("p",{class:n(["rounded-l-md button-item",[e(v)==="recent"?"button":"theme-color"]]),onClick:s[1]||(s[1]=d=>$("recent"))},r(o.$t("artworks.newest")),3),t("p",{class:n(["rounded-r-md button-item",[e(v)==="popularity"?"button":"theme-color"]]),onClick:s[2]||(s[2]=d=>$("popularity"))},[c(x,{name:"i-icon-park-outline-oval-love-two",class:n([{"text-white":e(v)==="popularity"}])},null,8,["class"]),O(" "+r(o.$t("artworks.mostPopular")),1)],2)]),e(C).loggedIn&&e(C).user.user_settings.show_explicit?(T(),V("div",Te,[t("p",{class:n(["rounded-l-md button-item",[e(h)===void 0?"button":"theme-color"]]),onClick:s[3]||(s[3]=d=>u(void 0))},r(o.$t("default")),3),t("p",{class:n(["button-item",[e(h)==="safe"?"button":"theme-color"]]),onClick:s[4]||(s[4]=d=>u("safe"))},r(o.$t("safe")),3),t("p",{class:n(["rounded-r-md button-item",[e(h)==="explicit"?"button":"theme-color"]]),onClick:s[5]||(s[5]=d=>u("explicit"))},[c(x,{name:"i-material-symbols-explicit-outline",class:n({"text-white":e(h)==="explicit"})},null,8,["class"]),O(" "+r(o.$t("explicit")),1)],2)])):Z("",!0)])]),e(v)==="popularity"?(T(),V("div",Be,[Ee,t("div",Ie,[t("div",Pe,[t("p",{class:n(["rounded-l-md button-item",[e(q)==="daily"?"button":"theme-color"]]),onClick:s[6]||(s[6]=d=>B("daily"))},r(o.$t("daily")),3),t("p",{class:n(["button-item",[e(q)==="weekly"?"button":"theme-color"]]),onClick:s[7]||(s[7]=d=>B("weekly"))},r(o.$t("weekly")),3),t("p",{class:n(["button-item",[e(q)==="monthly"?"button":"theme-color"]]),onClick:s[8]||(s[8]=d=>B("monthly"))},r(o.$t("monthly")),3),t("p",{class:n(["rounded-r-md button-item",[e(q)==="all"?"button":"theme-color"]]),onClick:s[9]||(s[9]=d=>B("all"))},r(o.$t("allTime")),3)]),t("div",Ue,[t("div",Ve,[t("button",We,[t("span",Fe,r(e(l)==="views"?o.$t("mostViewed"):e(y)),1),Ke]),t("ul",je,[t("li",{class:n(["flex flex-row justify-between py-2 px-3 cursor-pointer hover:button icon-hover-parent",{button:e(l)==="views"}]),onClick:s[10]||(s[10]=d=>L("views",o.$t("mostViewed")))},[c(x,{name:"i-mi-eye",class:n({"text-white":e(l)==="views"})},null,8,["class"]),O(" "+r(o.$t("mostViewed")),1)],2),t("li",{class:n(["flex flex-row justify-between py-2 px-3 cursor-pointer hover:button icon-hover-parent",{button:e(l)==="likes"}]),onClick:s[11]||(s[11]=d=>L("likes",o.$t("mostLiked")))},[c(x,{name:"i-ri-heart-3-line",class:n({"text-white":e(l)==="likes"})},null,8,["class"]),O(" "+r(o.$t("mostLiked")),1)],2),t("li",{class:n(["flex flex-row justify-between py-2 px-3 rounded-b-md cursor-pointer hover:button icon-hover-parent",{button:e(l)==="comments"}]),onClick:s[12]||(s[12]=d=>L("comments",o.$t("mostCommented")))},[c(x,{name:"i-mdi-comment-multiple-outline",class:n({"text-white":e(l)==="comments"})},null,8,["class"]),O(" "+r(o.$t("mostCommented")),1)],2)])])])])])):Z("",!0)]),c(re,{loading:e(U),empty:e(Q),error:e(W),fetch:A},null,8,["loading","empty","error"]),f(t("div",ze,[f(c(ke,{"section-class":"work-grid-6",works:e(R),view:ce},null,8,["works"]),[[w,!e(Q)]]),f(t("div",{class:n(["w-full primary-button",e(z).delay?"animate-pulse":""]),onClick:ue},r(o.$t("loadMore")),3),[[w,e(j)]])],512),[[w,!e(U)]]),t("div",Ne,[f(c($e,{ref_key:"popularModalViewRef",ref:J,section:"popular"},null,512),[[w,!e(U)]])])]))}},He=Y(De,[["__scopeId","data-v-6f0e9e52"]]);const Ye=b=>(ae("data-v-aeb34405"),b=b(),le(),b),Qe={class:"navigations"},Ge={class:"title"},Je=Ye(()=>t("div",{class:"buttons"},null,-1)),Xe={__name:"Users",emits:["countUsers"],setup(b,{emit:I}){const{oApiConfiguration:C,fetchOptions:P}=se(),_=Ce(C,P()),m=N(),{q:p}=m.query;D(()=>m.query.q,(i,g)=>{i!==g&&(S.value=i,M())});const S=a(p);H(()=>{setTimeout(()=>{M()},1e3)});const k=a([]),M=async()=>{B();const{users:i,pagination:g}=await y();i.length&&g.record_total&&(k.value=i),I("countUsers",g.record_total)},v=a(!0),$=a(!1),h=ne(()=>!$.value&&!k.value.length),u=a(!0),l=a({perPage:16,page:a(0)}),y=async()=>{var R;const[i,g]=await _.searchUsers({keyword:(R=S.value)!=null?R:"",pagination:{page:l.value.page,perPage:l.value.perPage}});if(v.value=!1,i.pagination.next_previous.next_page||(u.value=!1),g)$.value=!0;else return l.value.page+=1,i},L=a({delay:!1,showDiscoveryButton:!1}),q=async()=>{L.value.delay=!0,(await y()).users.forEach(g=>{k.value.push(g)}),L.value.delay=!1},B=()=>{k.value=[],u.value=!0,l.value.page=0,v.value=!0,$.value=!1};return(i,g)=>(T(),V("div",null,[t("div",Qe,[t("div",Ge,r(i.$t("users.users")),1),Je]),c(re,{loading:e(v),empty:e(h),error:e($),fetch:M},null,8,["loading","empty","error"]),f(t("div",null,[f(c(xe,{users:e(k)},null,8,["users"]),[[w,!e(h)]]),f(t("div",{class:n(["w-full primary-button",e(L).delay?"animate-pulse":""]),onClick:q},r(i.$t("loadMore")),3),[[w,e(u)]])],512),[[w,!e(v)]])]))}},Ze=Y(Xe,[["__scopeId","data-v-aeb34405"]]);const et={class:"mx-2"},tt={key:1,id:"lists"},ot={class:"search"},st=["placeholder"],nt={class:"flex flex-row gap-2 mb-6 w-full"},at={__name:"index",setup(b){var h;const I=oe(),{t:C}=ve(),P=fe(),_=N();ee({title:C("search.search")+(_.query.q?` "${_.query.q}"`:"")});const m=a("");H(()=>{m.value=_.query.q});const p=a((h=_.query.t)!=null?h:E.ARTWORK),S=a(0),k=u=>{S.value=u},M=a(0),v=u=>{M.value=u};D(()=>_.query,({q:u})=>{m.value=u,ee({title:C("search.search")+(m.value?` "${m.value}"`:_.query.q)})});const $=()=>{P.push({path:"/search",query:{q:m.value},replace:!0,force:!0})};return(u,l)=>(T(),te(be,{"with-footer":!0,"hide-side":!0,"no-right-side":!0},{default:he(()=>[t("div",et,[e(I).loggedIn?(T(),V("div",tt,[t("span",ot,[f(t("input",{"onUpdate:modelValue":l[0]||(l[0]=y=>ye(m)?m.value=y:null),type:"text",name:"search",placeholder:u.$t("search.search"),onKeyup:l[1]||(l[1]=ge(y=>$(),["enter"]))},null,40,st),[[we,e(m)]]),t("span",{class:"search-button",onClick:l[2]||(l[2]=y=>$())},[c(x,{name:"i-ion-search"})])]),t("div",nt,[t("div",{class:n(["px-2 rounded-lg",e(p)===e(E).ARTWORK?"primary-button":"light-bordered-button"]),onClick:l[3]||(l[3]=y=>p.value=e(E).ARTWORK)},[c(x,{name:"i-majesticons-image",class:n(["mr-2",{"text-white":e(p)===e(E).ARTWORK}])},null,8,["class"]),O(" "+r(u.$t("artworks.artworks"))+" ",1),t("span",{class:n(["px-1 ml-2 rounded",e(p)===e(E).ARTWORK?"theme-color":"bg-gray-600 text-white"])},r(e(S)),3)],2),t("div",{class:n(["px-2 rounded-lg",e(p)==="users"?"primary-button":"light-bordered-button"]),onClick:l[4]||(l[4]=y=>p.value="users")},[c(x,{name:"i-fluent-person-32-regular",class:n(["mr-2",{"text-white":e(p)==="users"}])},null,8,["class"]),O(" "+r(u.$t("users.users"))+" ",1),t("span",{class:n(["px-1 ml-2 rounded",e(p)==="users"?"theme-color":"bg-gray-600 text-white"])},r(e(M)),3)],2)]),f(t("div",null,[c(He,{onCountArtworks:k})],512),[[w,e(p)===e(E).ARTWORK]]),f(t("div",null,[c(Ze,{onCountUsers:v})],512),[[w,e(p)==="users"]])])):(T(),te(Me,{key:0}))])]),_:1}))}},kt=Y(at,[["__scopeId","data-v-7e9b730d"]]);export{kt as default};
