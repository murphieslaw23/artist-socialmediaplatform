import{i as pe,j as ve,S as ce,D as F,l as me,r as s,G as S,I as ge,o as I,c as fe,w as we,p as o,t as l,J as n,b as u,v as d,u as N,e as v,q as R,m as U,s as X,aG as be,K as ye,L as ke}from"./entry.86078af1.js";import{u as he,_ as O}from"./Icon.5b9a3c46.js";import{L as $e}from"./Layout.46731ff7.js";import{W as Ce,M as Me}from"./ModalView.7fd3b0ae.js";import{_ as _e}from"./LoadingEmptyErrorMessage.5e671d0e.js";import{T as Pe}from"./TagFilterSelection.3a2dc849.js";import{_ as Se}from"./_plugin-vue_export-helper.a1a6add7.js";import"./Spinner.cdd2eb1e.js";import"./user-counters-api.6c0f4602.js";import"./useFeed.9a25a969.js";const Y=h=>(ye("data-v-83ae6dbd"),h=h(),ke(),h),Oe={id:"lists"},xe={class:"navigations"},Le={class:"title"},Ve={class:"buttons"},Ae={class:"filter-buttons"},Be={class:"filter-buttons"},Ee={class:"filter-buttons"},Fe={key:0,class:"filter-buttons"},Ie={class:"navigations"},Ne=Y(()=>o("div",{class:"hidden md:flex"},null,-1)),Re={class:"buttons"},qe={class:"filter-buttons"},Te={class:"filter-buttons"},De={class:"inline-block w-full group md:w-40"},Ke={class:"flex-1 pr-1"},We=Y(()=>o("span",null,[o("svg",{class:"w-4 h-4 transition duration-150 ease-in-out transform fill-current group-hover:-rotate-180",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[o("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})])],-1)),ze={id:"popular-order-options",class:"absolute z-10 mt-1 w-full text-center rounded-md transition duration-150 ease-in-out transform origin-top scale-0 md:w-40 theme-color group-hover:scale-100"},Ge={class:"mt-4"},je={key:0,class:"art-list-view-paging-control"},He={id:"browse-modal",class:"modal work-view"},Qe={__name:"index",setup(h){const x=pe(),{oApiConfiguration:Z,fetchOptions:J}=ve(),L=he(Z,J()),$=ce(),{tags:V}=$.query;F(()=>$.query,()=>{ee()}),F(()=>$.query.tags,e=>{e&&(k.value=e,D(e)),i()}),me(()=>{V&&D(),i()});const ee=()=>{S().closeModal("browse-modal")},q=s(!1),te=()=>{q.value=!q.value},oe=()=>{document.getElementById("popular-order-options").classList.add("scale-0")},g=s("recent"),T=async e=>{g.value=e,await i()},f=s(void 0),A=async e=>{f.value=e,r.page=0,await i()},w=s("daily"),C=async e=>{w.value=e,r.page=0,await i()},c=s(!1),ae=async()=>{c.value=!c.value,r.page=0,await i()},D=async e=>{const t=e!=null?e:V;console.log(t);const[a,de]=await L.getTagKeys(t);if(!de){const E=[];a.tags.forEach(Q=>{E.push({key:Q.id,value:Q.tag})}),M.value=E,await W(E,t)}},K=s(null),le=()=>{K.value.init(be(M.value)),S().openModal("tag-filter-selection-modal")},k=s(""),M=s(),B=s(0),W=async(e,t)=>{M.value=e,k.value=t,B.value=t!==""?t.split(",").length:0,r.page=0,S().closeModal("tag-filter-selection-modal"),await i()};F(async()=>M.value,e=>{i()});const z=s([]),b=s({pagination:{enablePrev:!0,enableNext:!0}}),i=async()=>{const e=await se(),t=e.works,a=e.pagination;!t.length&&a.record_total===0?ne():(z.value=t,a.next_previous.next_page===null?b.value.pagination.enableNext=!1:b.value.pagination.enableNext=!0,a.next_previous.prev_page===null?b.value.pagination.enablePrev=!1:b.value.pagination.enablePrev=!0)},p=s(!0),r=ge({perPage:18,page:s(0)}),se=async()=>{!$.query.tags&&!V&&(k.value=""),r.page===0&&(p.value=!0,y.value=!1);let[e,t]=[];if(g.value==="recent"?[e,t]=await L.getLatest({pagination:{perPage:r.perPage,page:r.page},explicitMode:f.value,tags:k.value,followingOnly:c.value}):[e,t]=await L.getMostPopular({pagination:{perPage:r.perPage,page:r.page},range:w.value,rangeMode:m.value,explicitMode:f.value,tags:k.value,followingOnly:c.value}),t)ie();else return re(),e},G=async e=>{e==="prev"?r.page-=1:r.page+=1,await i()},y=s(!1),ne=()=>{y.value=!0},_=s(!1),ie=()=>{p.value=!1,_.value=!0},re=()=>{p.value=!1,y.value=!1,_.value=!1},j=s(null),ue=(e,t=!1)=>{j.value.view(e,t),S().openModal("browse-modal")},m=s("none"),H=s(""),P=async(e,t)=>{m.value=e,H.value=t,oe(),await i()};return(e,t)=>(I(),fe($e,{"with-footer":!0,"hide-side":!0,"no-right-side":!0},{default:we(()=>[o("div",Oe,[o("div",xe,[o("div",Le,l(e.$t("browse")),1),o("div",Ve,[o("div",Ae,[o("button",{class:n(["px-3 rounded-md button-item",B.value?"button":"theme-color"]),onClick:le},l(B.value)+" "+l(e.$t("tagsApplied")),3)]),u(o("div",Be,[o("button",{class:n(["px-3 rounded-md button-item",c.value?"button":"theme-color"]),onClick:t[0]||(t[0]=a=>ae())},[u(v(O,{name:"i-fluent-people-checkmark-24-regular",class:"text-white"},null,512),[[d,c.value]]),u(v(O,{name:"i-fluent-people-checkmark-24-regular"},null,512),[[d,!c.value]]),R(" "+l(e.$t("following")),1)],2)],512),[[d,N(x).loggedIn]]),o("div",Ee,[o("p",{class:n(["rounded-l-md button-item",[g.value==="recent"?"button":"theme-color"]]),onClick:t[1]||(t[1]=a=>T("recent"))},l(e.$t("artworks.recent")),3),o("p",{class:n(["rounded-r-md button-item",[g.value==="popularity"?"button":"theme-color"]]),onClick:t[2]||(t[2]=a=>T("popularity"))},l(e.$t("artworks.mostPopular")),3)]),N(x).loggedIn&&N(x).user.user_settings.show_explicit?(I(),U("div",Fe,[o("p",{class:n(["rounded-l-md button-item",[f.value===void 0?"button":"theme-color"]]),onClick:t[3]||(t[3]=a=>A(void 0))},l(e.$t("default")),3),o("p",{class:n(["button-item",[f.value==="safe"?"button":"theme-color"]]),onClick:t[4]||(t[4]=a=>A("safe"))},l(e.$t("safe")),3),o("p",{class:n(["rounded-r-md button-item",[f.value==="explicit"?"button":"theme-color"]]),onClick:t[5]||(t[5]=a=>A("explicit"))},l(e.$t("explicit")),3)])):X("",!0)])]),o("div",Ie,[Ne,o("div",Re,[u(o("div",qe,[o("p",{class:n(["rounded-l-md button-item",[w.value==="daily"?"button":"theme-color"]]),onClick:t[6]||(t[6]=a=>C("daily"))},l(e.$t("daily")),3),o("p",{class:n(["button-item",[w.value==="weekly"?"button":"theme-color"]]),onClick:t[7]||(t[7]=a=>C("weekly"))},l(e.$t("weekly")),3),o("p",{class:n(["button-item",[w.value==="monthly"?"button":"theme-color"]]),onClick:t[8]||(t[8]=a=>C("monthly"))},l(e.$t("monthly")),3),o("p",{class:n(["rounded-r-md button-item",[w.value==="all"?"button":"theme-color"]]),onClick:t[9]||(t[9]=a=>C("all"))},l(e.$t("allTime")),3)],512),[[d,g.value==="popularity"]]),u(o("div",Te,[o("div",De,[o("button",{class:"flex items-center py-2 w-full rounded-md outline-none md:w-40 theme-color hover:button",onClick:t[10]||(t[10]=a=>te())},[o("span",Ke,l(m.value==="none"?e.$t("default"):H.value),1),We]),o("ul",ze,[o("li",{class:n(["py-2 rounded-t-md cursor-pointer hover:button",{button:m.value==="none"}]),onClick:t[11]||(t[11]=a=>P("none",e.$t("default")))},l(e.$t("default")),3),o("li",{class:n(["py-2 cursor-pointer hover:button",{button:m.value==="views"}]),onClick:t[12]||(t[12]=a=>P("views",e.$t("mostViewed")))},l(e.$t("mostViewed")),3),o("li",{class:n(["py-2 cursor-pointer hover:button",{button:m.value==="likes"}]),onClick:t[13]||(t[13]=a=>P("likes",e.$t("mostLiked")))},l(e.$t("mostLiked")),3),o("li",{class:n(["py-2 rounded-b-md cursor-pointer hover:button",{button:m.value==="comments"}]),onClick:t[14]||(t[14]=a=>P("comments",e.$t("mostCommented")))},l(e.$t("mostCommented")),3)])])],512),[[d,g.value==="popularity"]])])]),v(_e,{loading:p.value,empty:y.value,error:_.value,fetch:i},null,8,["loading","empty","error"]),u(o("div",Ge,[u(v(Ce,{"section-class":"work-grid",works:z.value,view:ue},null,8,["works"]),[[d,!y.value]])],512),[[d,!p.value]]),!p.value&&!y.value&&!_.value?(I(),U("div",je,[o("button",{class:n([b.value.pagination.enablePrev?"primary-button":"disabled-button"]),onClick:t[15]||(t[15]=a=>G("prev"))},[v(O,{name:"i-ion-chevron-back-outline"}),R(" "+l(e.$t("pagination.previous")),1)],2),o("button",{class:n([b.value.pagination.enableNext?"primary-button":"disabled-button"]),onClick:t[16]||(t[16]=a=>G("next"))},[R(l(e.$t("pagination.next"))+" ",1),v(O,{name:"i-ion-chevron-forward-outline",class:"md:ml-2",style:{"margin-right":"0 !important"}})],2)])):X("",!0),o("div",He,[u(v(Me,{ref_key:"popularModalViewRef",ref:j,section:"browse"},null,512),[[d,!p.value]])]),u(v(Pe,{id:"tag-filter-selection-modal",ref_key:"tagFilterSelectionModalRef",ref:K,class:"modal",onApply:W},null,512),[[d,!p.value]])])]),_:1}))}},st=Se(Qe,[["__scopeId","data-v-83ae6dbd"]]);export{st as default};
