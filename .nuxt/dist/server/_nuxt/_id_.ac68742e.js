import{c as W,u as L,d as M,j as H,_ as J,e as K}from"../server.mjs";import{_ as j,u as O,a as Q}from"./Icon.66eb61eb.js";import{onMounted as P,ref as d,resolveComponent as X,openBlock as u,createElementBlock as m,createElementVNode as t,createTextVNode as b,toDisplayString as a,createVNode as y,withCtx as F,withDirectives as c,vShow as f,withModifiers as Z,normalizeClass as D,vModelText as T,unref as U,createCommentVNode as I,createBlock as z,pushScopeId as Y,popScopeId as q,Fragment as tt,renderList as et}from"vue";import"vue-router";import{L as st}from"./Layout.294e92ff.js";import{S as R}from"./Spinner.8f56f1de.js";import"#internal/nitro";const N=l=>(Y("data-v-93aff21e"),l=l(),q(),l),ot={class:"mb-4 text-base font-bold"},at={class:"text-xs italic font-bold href"},lt={class:"alert-success"},it={class:"italic"},nt={class:"flex flex-row p-2 mb-6 text-white rounded-md button-color"},rt=["onSubmit"],ct={class:"input-block"},ut=["placeholder"],dt={class:"input-block"},pt=["placeholder"],ht={class:"input-block"},_t={class:"input-block"},ft={class:"mb-3"},mt=["for"],vt=N(()=>t("span",{class:"block w-10 h-6 bg-gray-300 rounded-full shadow-inner"},null,-1)),wt={key:0,class:"block absolute inset-y-0 left-0 mt-1 ml-1 w-4 h-4 bg-white rounded-full shadow transition-transform duration-300 ease-in-out focus-within:shadow-outline"},gt=N(()=>t("input",{id:"unchecked",type:"checkbox",class:"absolute w-0 h-0 opacity-0"},null,-1)),kt=[gt],bt={key:1,class:"block absolute inset-y-0 left-0 mt-1 ml-1 w-4 h-4 rounded-full shadow transition-transform duration-300 ease-in-out transform translate-x-full focus-within:shadow-outline button-color"},yt=N(()=>t("input",{id:"checked",type:"checkbox",class:"absolute w-0 h-0 opacity-0"},null,-1)),xt=[yt],$t={class:"ml-2"},Et={class:"flex flex-row p-2 mt-2 text-white bg-red-400 rounded"},It={class:"flex flex-row"},Ct={__name:"UpdateForm",props:{id:{type:String,default:""}},setup(l){const w=l,C=W(),{$router:x}=L(),{oApiConfiguration:S,fetchOptions:$}=M(),i=O(S,$()),p=H().public.apiUrl;P(()=>{C.loggedIn||x.push("/"),E()});const h=d(!1),E=async()=>{const[e,o]=await i.getWorkById(w.id);o?h.value=!0:(s.value.title=e.title,s.value.description=e.description,e.artwork_has_tags.forEach(k=>{g.value.push({key:k.artwork_tags.id,value:k.artwork_tags.tag})}),s.value.isExplicit=!!e.is_explicit)},s=d({title:"",description:"",tags:"",isExplicit:!1}),g=d([]),n=d(!1),_=d(!1),V=d(!1),G=async()=>{const e=[];g.value.forEach(o=>{e.push(o.value)}),n.value=!0,_.value=!1;try{const o=[];g.value.forEach(r=>{o.push(r.value)});const[k,A]=await i.updateInfo({id:w.id,title:s.value.title,description:s.value.description,isExplicit:s.value.isExplicit,tags:o.toString()});A?V.value=!0:(_.value=!0,setTimeout(()=>{x.push(`/a/${w.id}`)},1e3))}catch{V.value=!0}n.value=!1};return(e,o)=>{const k=J,A=X("tags-input");return u(),m("div",null,[t("div",ot,[b(a(e.$t("artworks.update.form.title"))+" ",1),t("span",at,[y(k,{to:"/a/"+l.id},{default:F(()=>[b(" (ID: "+a(l.id)+") ",1)]),_:1},8,["to"])])]),c(t("div",{class:"alert-danger"},a(e.$t("artworks.update.form.fetchFailure")),513),[[f,h.value]]),c(t("div",lt,[b(a(e.$t("artworks.update.form.updated"))+" ",1),t("span",it,a(e.$t("artworks.update.form.successRedirect")),1)],512),[[f,_.value]]),c(t("div",nt,[y(R,{class:"mr-1"}),b(" "+a(e.$t("saving")),1)],512),[[f,n.value]]),c(t("div",{class:"alert-danger"},a(e.$t("artworks.add.form.uploadFailure")),513),[[f,V.value]]),c(t("form",{enctype:"multipart/form-data",onSubmit:Z(G,["prevent"])},[t("div",ct,[c(t("input",{"onUpdate:modelValue":o[0]||(o[0]=r=>s.value.title=r),type:"text",class:D(["form-input input",{"pointer-events-none cursor-not-allowed":n.value||_.value}]),placeholder:e.$t("title")},null,10,ut),[[T,s.value.title]])]),t("div",dt,[c(t("textarea",{"onUpdate:modelValue":o[1]||(o[1]=r=>s.value.description=r),class:D(["form-input input",{"pointer-events-none cursor-not-allowed":n.value||_.value}]),rows:"8",cols:"0",placeholder:e.$t("description"),"data-gramm":"false"},null,10,pt),[[T,s.value.description]])]),t("div",ht,[y(A,{modelValue:g.value,"onUpdate:modelValue":o[2]||(o[2]=r=>g.value=r),placeholder:e.$t("tagsInputPlaceholder"),typeahead:!0,"typeahead-style":"dropdown","typeahead-activation-threshold":2,"typeahead-show-on-focus":!0,"typeahead-hide-discard":!0,"typeahead-url":U(p)+"/artworks/tags/search?keyword=:search","add-tags-on-comma":!0},null,8,["modelValue","placeholder","typeahead-url"])]),t("div",_t,[t("div",ft,[t("label",{for:s.value.isExplicit?"unchecked":"checked",class:"inline-flex items-center mt-2"},[t("span",{class:"relative cursor-pointer",onClick:o[3]||(o[3]=r=>s.value.isExplicit=!s.value.isExplicit)},[vt,s.value.isExplicit?I("",!0):(u(),m("span",wt,kt)),s.value.isExplicit?(u(),m("span",bt,xt)):I("",!0)]),t("span",$t,a(e.$t("explicitContent")),1)],8,mt),c(t("div",Et,[y(Q,{name:"alert-outline",class:"mr-1 text-white"}),t("span",null,a(e.$t("artworks.add.form.prohibitChildExplicitContent")),1)],512),[[f,s.value.isExplicit]])])]),t("button",{class:D(["float-right primary-button",{"pointer-events-none cursor-not-allowed":n.value||_.value}])},[t("div",It,[n.value?(u(),z(R,{key:0,class:"mr-1"})):I("",!0),b(" "+a(n.value?e.$t("saving"):e.$t("save")),1)])],2)],40,rt),[[f,!h.value]])])}}},St=j(Ct,[["__scopeId","data-v-93aff21e"]]);const v=l=>(Y("data-v-28b6857b"),l=l(),q(),l),Vt=v(()=>t("h1",{class:"font-bold text-base mb-3"},"Current Info",-1)),At={class:"mt-2"},Dt=v(()=>t("label",{class:"text-color-secondary font-medium italic"},"Title",-1)),Ft={class:"mt-2"},Ut=v(()=>t("label",{class:"text-color-secondary font-medium italic"},"Description",-1)),Nt={class:"text-justify"},Bt={class:"mt-2"},Tt=v(()=>t("label",{class:"text-color-secondary font-medium italic"},"Explicit",-1)),Rt={key:0,class:"mt-2"},Wt=v(()=>t("label",{class:"text-color-secondary font-medium italic"},"Tags",-1)),Lt={class:"tags"},Mt={class:"mt-2"},jt=v(()=>t("label",{class:"text-color-secondary font-medium italic"},"Publish Date",-1)),Ot={__name:"[id]",setup(l){W();const{oApiConfiguration:w,fetchOptions:C}=M(),x=O(w,C()),{$router:S}=L();K();const{id:$}=S.currentRoute.value.params;P(()=>{B()});const i=d({}),B=async()=>{try{const[p,h]=await x.getWorkById($);h||(i.value=p)}catch{}};return(p,h)=>(u(),z(st,{"with-footer":!0,"h-screen":!0},{"right-side":F(()=>[Vt,t("div",At,[Dt,t("p",null,a(i.value.title),1)]),t("div",Ft,[Ut,t("p",Nt,a(i.value.description),1)]),t("div",Bt,[Tt,t("p",null,a(i.value.is_explicit?"Yes":"No"),1)]),i.value.artwork_has_tags&&i.value.artwork_has_tags.length?(u(),m("div",Rt,[Wt,t("div",Lt,[(u(!0),m(tt,null,et(i.value.artwork_has_tags,E=>(u(),m("span",{key:E.artwork_tags.id,class:"tag"},a(E.artwork_tags.tag),1))),128))])])):I("",!0),t("div",Mt,[jt,t("p",null,a(p.formatDate(i.value.scheduled_post)),1)])]),default:F(()=>[y(U(St),{id:U($)},null,8,["id"])]),_:1}))}},Kt=j(Ot,[["__scopeId","data-v-28b6857b"]]);export{Kt as default};
//# sourceMappingURL=_id_.ac68742e.js.map
