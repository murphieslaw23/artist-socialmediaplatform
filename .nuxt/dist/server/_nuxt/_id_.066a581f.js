import{c as R,u as W,d as j,j as G,P as H,_ as J,e as K}from"../server.mjs";import{_ as L,u as M,a as Q}from"./Icon.4343fb38.js";import{onMounted as P,ref as d,resolveComponent as X,openBlock as c,createElementBlock as f,createElementVNode as t,createTextVNode as k,toDisplayString as a,createVNode as v,withCtx as D,withDirectives as u,vShow as m,withModifiers as Z,normalizeClass as U,vModelText as tt,unref as C,createCommentVNode as I,createBlock as z,pushScopeId as O,popScopeId as Y,Fragment as et,renderList as ot}from"vue";import"vue-router";import{L as st}from"./Layout.d005bae5.js";import{S as B}from"./Spinner.9a28c320.js";import"#internal/nitro";const N=l=>(O("data-v-2c0b2b8b"),l=l(),Y(),l),at={class:"mb-4 text-base font-bold"},lt={class:"text-xs italic font-bold href"},it={class:"alert-success"},nt={class:"italic"},rt={class:"flex flex-row p-2 mb-6 text-white rounded-md button-color"},ct=["onSubmit"],ut={class:"input-block"},dt=["placeholder"],pt={class:"input-block -mt-2"},ht={class:"input-block"},_t={class:"input-block"},mt={class:"mb-4"},vt=["for"],ft=N(()=>t("span",{class:"block w-10 h-6 bg-gray-300 rounded-full shadow-inner"},null,-1)),bt={key:0,class:"block absolute inset-y-0 left-0 mt-1 ml-1 w-4 h-4 bg-white rounded-full shadow transition-transform duration-300 ease-in-out focus-within:shadow-outline"},wt=N(()=>t("input",{id:"unchecked",type:"checkbox",class:"absolute w-0 h-0 opacity-0"},null,-1)),gt=[wt],kt={key:1,class:"block absolute inset-y-0 left-0 mt-1 ml-1 w-4 h-4 rounded-full shadow transition-transform duration-300 ease-in-out transform translate-x-full focus-within:shadow-outline button-color"},yt=N(()=>t("input",{id:"checked",type:"checkbox",class:"absolute w-0 h-0 opacity-0"},null,-1)),xt=[yt],$t={class:"ml-2"},Et={class:"flex flex-row p-2 mt-2 text-white bg-red-400 rounded"},It={class:"flex flex-row"},Ct={__name:"UpdateForm",props:{id:{type:String,default:""}},setup(l){const b=l,V=R(),{$router:x}=W(),{oApiConfiguration:S,fetchOptions:$}=j(),i=M(S,$()),p=G().public.apiUrl;P(()=>{V.loggedIn||x.push("/"),E()});const h=d(!1),E=async()=>{const[e,s]=await i.getWorkById(b.id);s?h.value=!0:(o.value.title=e.title,o.value.description=e.description.split("<br><br>").join(` 
`).split("<br>").join(""),e.artwork_has_tags.forEach(g=>{w.value.push({key:g.artwork_tags.id,value:g.artwork_tags.tag})}),o.value.isExplicit=!!e.is_explicit)},o=d({title:"",description:"",tags:"",isExplicit:!1}),w=d([]),n=d(!1),_=d(!1),A=d(!1),q=async()=>{const e=[];w.value.forEach(s=>{e.push(s.value)}),n.value=!0,_.value=!1;try{const s=[];w.value.forEach(r=>{s.push(r.value)});const[g,F]=await i.updateInfo({id:b.id,title:o.value.title,description:o.value.description,isExplicit:o.value.isExplicit,tags:s.toString()});F?A.value=!0:(_.value=!0,setTimeout(()=>{x.push(`/a/${b.id}`)},1e3))}catch{A.value=!0}n.value=!1};return(e,s)=>{const g=J,F=X("tags-input");return c(),f("div",null,[t("div",at,[k(a(e.$t("artworks.update.form.title"))+" ",1),t("span",lt,[v(g,{to:"/a/"+l.id},{default:D(()=>[k(" (ID: "+a(l.id)+") ",1)]),_:1},8,["to"])])]),u(t("div",{class:"alert-danger"},a(e.$t("artworks.update.form.fetchFailure")),513),[[m,h.value]]),u(t("div",it,[k(a(e.$t("artworks.update.form.updated"))+" ",1),t("span",nt,a(e.$t("artworks.update.form.successRedirect")),1)],512),[[m,_.value]]),u(t("div",rt,[v(B,{class:"mr-1"}),k(" "+a(e.$t("saving")),1)],512),[[m,n.value]]),u(t("div",{class:"alert-danger"},a(e.$t("artworks.add.form.uploadFailure")),513),[[m,A.value]]),u(t("form",{enctype:"multipart/form-data",onSubmit:Z(q,["prevent"])},[t("div",ut,[u(t("input",{"onUpdate:modelValue":s[0]||(s[0]=r=>o.value.title=r),type:"text",class:U(["form-input input",{"pointer-events-none cursor-not-allowed":n.value||_.value}]),placeholder:e.$t("title")},null,10,dt),[[tt,o.value.title]])]),t("div",pt,[v(C(H.exports.VueEditor),{modelValue:o.value.description,"onUpdate:modelValue":s[1]||(s[1]=r=>o.value.description=r),editorToolbar:[[{size:["normal","large"]}],["bold","italic","underline","strike"],["link"],[{color:[]},{background:[]}],["clean"]],class:U([{"pointer-events-none cursor-not-allowed":n.value||_.value}]),placeholder:e.$t("description")},null,8,["modelValue","class","placeholder"])]),t("div",ht,[v(F,{modelValue:w.value,"onUpdate:modelValue":s[2]||(s[2]=r=>w.value=r),placeholder:e.$t("tagsInputPlaceholder"),typeahead:!0,"typeahead-style":"dropdown","typeahead-activation-threshold":2,"typeahead-show-on-focus":!0,"typeahead-hide-discard":!0,"typeahead-url":C(p)+"/artworks/tags/search?keyword=:search","add-tags-on-comma":!0},null,8,["modelValue","placeholder","typeahead-url"])]),t("div",_t,[t("div",mt,[t("label",{for:o.value.isExplicit?"unchecked":"checked",class:"inline-flex items-center mt-2"},[t("span",{class:"relative cursor-pointer",onClick:s[3]||(s[3]=r=>o.value.isExplicit=!o.value.isExplicit)},[ft,o.value.isExplicit?I("",!0):(c(),f("span",bt,gt)),o.value.isExplicit?(c(),f("span",kt,xt)):I("",!0)]),t("span",$t,a(e.$t("explicitContent")),1)],8,vt),u(t("div",Et,[v(Q,{name:"alert-outline",class:"mr-1 text-white"}),t("span",null,a(e.$t("artworks.add.form.prohibitChildExplicitContent")),1)],512),[[m,o.value.isExplicit]])])]),t("button",{class:U(["float-right primary-button",{"pointer-events-none cursor-not-allowed":n.value||_.value}])},[t("div",It,[n.value?(c(),z(B,{key:0,class:"mr-1"})):I("",!0),k(" "+a(n.value?e.$t("saving"):e.$t("save")),1)])],2)],40,ct),[[m,!h.value]])])}}},Vt=L(Ct,[["__scopeId","data-v-2c0b2b8b"]]);const y=l=>(O("data-v-983292eb"),l=l(),Y(),l),St=y(()=>t("h1",{class:"mb-3 text-base font-bold"},"Current Info",-1)),At={class:"mt-2"},Ft=y(()=>t("label",{class:"italic font-medium text-color-secondary"},"Title",-1)),Ut={class:"mt-2"},Dt=y(()=>t("label",{class:"italic font-medium text-color-secondary"},"Explicit",-1)),Nt={key:0,class:"mt-2"},Tt=y(()=>t("label",{class:"italic font-medium text-color-secondary"},"Tags",-1)),Bt={class:"tags"},Rt={class:"mt-2"},Wt=y(()=>t("label",{class:"italic font-medium text-color-secondary"},"Publish Date",-1)),jt={__name:"[id]",setup(l){R();const{oApiConfiguration:b,fetchOptions:V}=j(),x=M(b,V()),{$router:S}=W();K();const{id:$}=S.currentRoute.value.params;P(()=>{T()});const i=d({}),T=async()=>{try{const[p,h]=await x.getWorkById($);h||(i.value=p)}catch{}};return(p,h)=>(c(),z(st,{"with-footer":!0,"h-screen":!0},{"right-side":D(()=>[St,t("div",At,[Ft,t("p",null,a(i.value.title),1)]),t("div",Ut,[Dt,t("p",null,a(i.value.is_explicit?"Yes":"No"),1)]),i.value.artwork_has_tags&&i.value.artwork_has_tags.length?(c(),f("div",Nt,[Tt,t("div",Bt,[(c(!0),f(et,null,ot(i.value.artwork_has_tags,E=>(c(),f("span",{key:E.artwork_tags.id,class:"tag"},a(E.artwork_tags.tag),1))),128))])])):I("",!0),t("div",Rt,[Wt,t("p",null,a(p.formatDate(i.value.scheduled_post)),1)])]),default:D(()=>[v(C(Vt),{id:C($)},null,8,["id"])]),_:1}))}},Gt=L(jt,[["__scopeId","data-v-983292eb"]]);export{Gt as default};
//# sourceMappingURL=_id_.066a581f.js.map
