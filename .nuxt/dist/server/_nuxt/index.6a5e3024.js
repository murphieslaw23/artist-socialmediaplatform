const x={validate(t){return t.toString("ascii",0,2)==="BM"},calculate(t){return{height:Math.abs(t.readInt32LE(22)),width:t.readUInt32LE(18)}}},N=1,F=2+2+2,R=1+1+1+1+2+2+4+4;function I(t,e){const n=t.readUInt8(e);return n===0?256:n}function p(t,e){const n=F+e*R;return{height:I(t,n+1),width:I(t,n)}}const v={validate(t){return t.readUInt16LE(0)!==0?!1:t.readUInt16LE(2)===N},calculate(t){const e=t.readUInt16LE(4),n=p(t,0);if(e===1)return n;const i=[n];for(let c=1;c<e;c+=1)i.push(p(t,c));return{height:n.height,images:i,width:n.width}}},C=2,k={validate(t){return t.readUInt16LE(0)!==0?!1:t.readUInt16LE(2)===C},calculate(t){return v.calculate(t)}},G={validate(t){return t.readUInt32LE(0)===542327876},calculate(t){return{height:t.readUInt32LE(12),width:t.readUInt32LE(16)}}},A=/^GIF8[79]a/,M={validate(t){const e=t.toString("ascii",0,6);return A.test(e)},calculate(t){return{height:t.readUInt16LE(8),width:t.readUInt16LE(6)}}},O=4+4,H=4,D=4,Y={ICON:32,"ICN#":32,"icm#":16,icm4:16,icm8:16,"ics#":16,ics4:16,ics8:16,is32:16,s8mk:16,icp4:16,icl4:32,icl8:32,il32:32,l8mk:32,icp5:32,ic11:32,ich4:48,ich8:48,ih32:48,h8mk:48,icp6:64,ic12:32,it32:128,t8mk:128,ic07:128,ic08:256,ic13:256,ic09:512,ic14:512,ic10:1024};function w(t,e){const n=e+D;return[t.toString("ascii",e,n),t.readUInt32BE(n)]}function m(t){const e=Y[t];return{width:e,height:e,type:t}}const f={validate(t){return t.toString("ascii",0,4)==="icns"},calculate(t){const e=t.length,n=t.readUInt32BE(H);let i=O,r=w(t,i),c=m(r[0]);if(i+=r[1],i===n)return c;const s={height:c.height,images:[c],width:c.width};for(;i<n&&i<e;)r=w(t,i),c=m(r[0]),i+=r[1],s.images.push(c);return s}},z={validate(t){return t.toString("hex",0,4)==="ff4fff51"},calculate(t){return{height:t.readUInt32BE(12),width:t.readUInt32BE(8)}}},d={ftyp:"66747970",ihdr:"69686472",jp2h:"6a703268",jp__:"6a502020",rreq:"72726571",xml_:"786d6c20"},j=t=>{const e=t.readUInt8(0);let n=1+2*e;const r=t.readUInt16BE(n)*(2+e);n=n+2+r;const s=t.readUInt16BE(n)*(16+e);return n+2+s},S=t=>({height:t.readUInt32BE(4),width:t.readUInt32BE(8)}),V={validate(t){const e=t.toString("hex",4,8),n=t.readUInt32BE(0);if(e!==d.jp__||n<1)return!1;const i=n+4,r=t.readUInt32BE(n);return t.slice(i,i+r).toString("hex",0,4)===d.ftyp},calculate(t){const e=t.readUInt32BE(0),n=t.readUInt16BE(e+2);let i=e+4+n;switch(t.toString("hex",i,i+4)){case d.rreq:return i=i+4+4+j(t.slice(i+4)),S(t.slice(i+8,i+24));case d.jp2h:return S(t.slice(i+8,i+24));default:throw new TypeError("Unsupported header found: "+t.toString("ascii",i,i+4))}}};function o(t,e,n,i){n=n||0;const r=i?"BE":"LE",c="readUInt"+e+r;return t[c].call(t,n)}const J="45786966",X=2,E=6,Z=2,W="4d4d",K="4949",B=12,$=2;function q(t){return t.toString("hex",2,6)===J}function Q(t,e){return{height:t.readUInt16BE(e),width:t.readUInt16BE(e+2)}}function b(t,e){const i=E+8,r=o(t,16,i,e);for(let c=0;c<r;c++){const s=i+$+c*B,P=s+B;if(s>t.length)return;const h=t.slice(s,P);if(o(h,16,0,e)===274)return o(h,16,2,e)!==3||o(h,32,4,e)!==1?void 0:o(h,16,8,e)}}function tt(t,e){const n=t.slice(X,e),i=n.toString("hex",E,E+Z),r=i===W;if(r||i===K)return b(n,r)}function et(t,e){if(e>t.length)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(t[e]!==255)throw new TypeError("Invalid JPG, marker table corrupted")}const nt={validate(t){return t.toString("hex",0,2)==="ffd8"},calculate(t){t=t.slice(4);let e,n;for(;t.length;){const i=t.readUInt16BE(0);if(q(t)&&(e=tt(t,i)),et(t,i),n=t[i+1],n===192||n===193||n===194){const r=Q(t,i+5);return e?{height:r.height,orientation:e,width:r.width}:r}t=t.slice(i+2)}throw new TypeError("Invalid JPG, no size found")}},it="KTX 11",rt={validate(t){return it===t.toString("ascii",1,7)},calculate(t){return{height:t.readUInt32LE(40),width:t.readUInt32LE(36)}}},ct=`PNG\r

`,st="IHDR",U="CgBI",at={validate(t){if(ct===t.toString("ascii",1,8)){let e=t.toString("ascii",12,16);if(e===U&&(e=t.toString("ascii",28,32)),e!==st)throw new TypeError("Invalid PNG");return!0}return!1},calculate(t){return t.toString("ascii",12,16)===U?{height:t.readUInt32BE(36),width:t.readUInt32BE(32)}:{height:t.readUInt32BE(20),width:t.readUInt32BE(16)}}},y={P1:"pbm/ascii",P2:"pgm/ascii",P3:"ppm/ascii",P4:"pbm",P5:"pgm",P6:"ppm",P7:"pam",PF:"pfm"},ot=Object.keys(y),L={default:t=>{let e=[];for(;t.length>0;){const n=t.shift();if(n[0]!=="#"){e=n.split(" ");break}}if(e.length===2)return{height:parseInt(e[1],10),width:parseInt(e[0],10)};throw new TypeError("Invalid PNM")},pam:t=>{const e={};for(;t.length>0;){const n=t.shift();if(n.length>16||n.charCodeAt(0)>128)continue;const[i,r]=n.split(" ");if(i&&r&&(e[i.toLowerCase()]=parseInt(r,10)),e.height&&e.width)break}if(e.height&&e.width)return{height:e.height,width:e.width};throw new TypeError("Invalid PAM")}},ht={validate(t){const e=t.toString("ascii",0,2);return ot.includes(e)},calculate(t){const e=t.toString("ascii",0,2),n=y[e],i=t.toString("ascii",3).split(/[\r\n]+/);return(L[n]||L.default)(i)}},dt={validate(t){return t.toString("ascii",0,4)==="8BPS"},calculate(t){return{height:t.readUInt32BE(14),width:t.readUInt32BE(18)}}},_=/<svg\s([^>"']|"[^"]*"|'[^']*')*>/,l={height:/\sheight=(['"])([^%]+?)\1/,root:_,viewbox:/\sviewBox=(['"])(.+?)\1/,width:/\swidth=(['"])([^%]+?)\1/},u=2.54,lt={cm:96/u,em:16,ex:8,m:96/u*100,mm:96/u/10,pc:96/72/12,pt:96/72};function g(t){const e=/([0-9.]+)([a-z]*)/.exec(t);if(!!e)return Math.round(parseFloat(e[1])*(lt[e[2]]||1))}function gt(t){const e=t.split(" ");return{height:g(e[3]),width:g(e[2])}}function ut(t){const e=t.match(l.width),n=t.match(l.height),i=t.match(l.viewbox);return{height:n&&g(n[2]),viewbox:i&&gt(i[2]),width:e&&g(e[2])}}function Et(t){return{height:t.height,width:t.width}}function It(t,e){const n=e.width/e.height;return t.width?{height:Math.floor(t.width/n),width:t.width}:t.height?{height:t.height,width:Math.floor(t.height*n)}:{height:e.height,width:e.width}}const pt={validate(t){const e=String(t);return _.test(e)},calculate(t){const e=t.toString("utf8").match(l.root);if(e){const n=ut(e[0]);if(n.width&&n.height)return Et(n);if(n.viewbox)return It(n,n.viewbox)}throw new TypeError("Invalid SVG")}};function wt(t){return{height:1+t.readUIntLE(7,3),width:1+t.readUIntLE(4,3)}}function mt(t){return{height:1+((t[4]&15)<<10|t[3]<<2|(t[2]&192)>>6),width:1+((t[2]&63)<<8|t[1])}}function St(t){return{height:t.readInt16LE(8)&16383,width:t.readInt16LE(6)&16383}}const Bt={validate(t){const e=t.toString("ascii",0,4)==="RIFF",n=t.toString("ascii",8,12)==="WEBP",i=t.toString("ascii",12,15)==="VP8";return e&&n&&i},calculate(t){const e=t.toString("ascii",12,16);if(t=t.slice(20,30),e==="VP8X"){const i=t[0],r=(i&192)===0,c=(i&1)===0;if(r&&c)return wt(t);throw new TypeError("Invalid WebP")}if(e==="VP8 "&&t[0]!==47)return St(t);const n=t.toString("hex",3,6);if(e==="VP8L"&&n!=="9d012a")return mt(t);throw new TypeError("Invalid WebP")}},a={bmp:x,cur:k,dds:G,gif:M,icns:f,ico:v,j2c:z,jp2:V,jpg:nt,ktx:rt,png:at,pnm:ht,psd:dt,svg:pt,webp:Bt},Ut=t=>t==="svg"?"image/svg+xml":`image/${t}`,Lt=Object.keys(a),T={56:"psd",66:"bmp",68:"dds",71:"gif",73:"tiff",77:"tiff",82:"webp",105:"icns",137:"png",255:"jpg"};function Tt(t){const e=t[0];if(e in T){const i=T[e];if(a[i].validate(t))return i}const n=i=>a[i].validate(t);return Lt.find(n)}function vt(t,e){const n=Tt(t);if(n&&n in a){const i=a[n].calculate(t,e);if(i!==void 0)return i.type=n,i.mimeType=Ut(n),i}throw new TypeError("unsupported file type: "+n+" (file: "+e+")")}function xt(t){if(Buffer.isBuffer(t))return vt(t);throw new Error("Input should be buffer!")}const Nt=Object.keys(a);export{xt as imageMeta,Nt as types};
//# sourceMappingURL=index.6a5e3024.js.map
